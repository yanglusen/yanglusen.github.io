<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æµ…æAngularä¸­çš„æ–‡ä»¶ä¸Šä¼ è¿›åº¦ç›‘æ§</title>
    <link href="/posts/e42f4a99/"/>
    <url>/posts/e42f4a99/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘è€æ˜¯è·Ÿæ–‡ä»¶ä¸Šä¼ æ‰“äº¤é“ï¼Œè¶ç€æå®Œéœ€æ±‚çš„é—´éš™ï¼Œæ•´ç†ä¸€ä¸‹æ‹–äº†å¥½ä¹…çš„æ–‡ç« ï¼Œæµ…æ Angular ä¸­çš„æ–‡ä»¶ä¸Šä¼ è¿›åº¦ç›‘æ§çš„åŸç†ã€‚å…¶ä¸»è¦çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨äº† XMLHttpRequest å’Œ Observable å¯¹è±¡æ¥å®ç°çš„ã€‚</p><h3 id="æºç ">æºç </h3><figure class="highlight kotlin"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¸Šä¼ å•ä¸ªæ–‡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> uploadFile ä¸Šä¼ æ–‡ä»¶å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    upload(uploadFile: ThyUploadFile): Observable&lt;ThyUploadResponse&gt; &#123;<br>        <span class="hljs-keyword">this</span>.ensureFileName(uploadFile);<br><br>        <span class="hljs-keyword">return</span> new Observable(observer =&gt; &#123;<br>            <span class="hljs-keyword">const</span> &#123; xhr, cleanup &#125; = <span class="hljs-keyword">this</span>.uploadByXhr(observer, uploadFile);<br>            <span class="hljs-keyword">return</span> () =&gt; &#123;<br>                cleanup();<br><br>                <span class="hljs-keyword">if</span> (xhr.readyState !== xhr.DONE) &#123;<br>                    xhr.abort();<br>                &#125;<br>            &#125;;<br>        &#125;);<br>    &#125;<br></code></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-title">uploadByXhr</span>(<span class="hljs-params">observer: Subscriber&lt;ThyUploadResponse&gt;, uploadFile: ThyUploadFile</span>)</span> &#123;<br>        <span class="hljs-comment">// æ³¨å…¥ XhrFactory,è°ƒç”¨å…¶ build() æ–¹æ³•ï¼Œè¿”å› XMLHttpRequest å¯¹è±¡</span><br>        <span class="hljs-keyword">const</span> xhr = <span class="hljs-built_in">this</span>.xhrFactory.build();<br>        <span class="hljs-keyword">const</span> time: <span class="hljs-built_in">number</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<br>        <span class="hljs-keyword">let</span> speed = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> estimatedTime: <span class="hljs-built_in">number</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<br><br>        uploadFile.progress = &#123;<br>            <span class="hljs-attr">status</span>: ThyUploadStatus.started,<br>            <span class="hljs-attr">percentage</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-attr">startTime</span>: time<br>        &#125;;<br><br>        <span class="hljs-keyword">const</span> onProgress = (event: ProgressEvent): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">if</span> (event.lengthComputable) &#123;<br>                <span class="hljs-keyword">let</span> percentage = <span class="hljs-built_in">Math</span>.round((event.loaded * <span class="hljs-number">100</span>) / event.total);<br>                <span class="hljs-keyword">if</span> (percentage === <span class="hljs-number">100</span>) &#123;<br>                    percentage = <span class="hljs-number">99</span>;<br>                &#125;<br>                <span class="hljs-keyword">const</span> diff = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() - time;<br>                speed = <span class="hljs-built_in">Math</span>.round((event.loaded / diff) * <span class="hljs-number">1000</span>);<br>                <span class="hljs-keyword">const</span> progressStartTime = (uploadFile.progress &amp;&amp; uploadFile.progress.startTime) || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<br>                estimatedTime = <span class="hljs-built_in">Math</span>.ceil((event.total - event.loaded) / speed);<br><br>                uploadFile.progress.status = ThyUploadStatus.uploading;<br>                uploadFile.progress.percentage = percentage;<br>                uploadFile.progress.speed = speed;<br>                uploadFile.progress.speedHuman = <span class="hljs-string">`<span class="hljs-subst">$&#123;humanizeBytes(speed, <span class="hljs-literal">false</span>, <span class="hljs-number">2</span>)&#125;</span>/s`</span>;<br>                uploadFile.progress.startTime = progressStartTime;<br>                uploadFile.progress.estimatedTime = estimatedTime;<br>                uploadFile.progress.estimatedTimeHuman = <span class="hljs-built_in">this</span>.secondsToHuman(estimatedTime);<br><br>                observer.next(&#123; <span class="hljs-attr">status</span>: ThyUploadStatus.uploading, <span class="hljs-attr">uploadFile</span>: uploadFile &#125;);<br>            &#125;<br>        &#125;;<br><br>        <span class="hljs-keyword">const</span> onError = <span class="hljs-function">(<span class="hljs-params">error: ErrorEvent</span>) =&gt;</span> observer.error(error);<br><br>        <span class="hljs-keyword">const</span> onReadyStateChange = <span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-keyword">if</span> (xhr.readyState === XMLHttpRequest.DONE) &#123;<br>                <span class="hljs-keyword">const</span> speedTime = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() - uploadFile.progress.startTime) * <span class="hljs-number">1000</span>;<br>                <span class="hljs-keyword">const</span> speedAverage = <span class="hljs-built_in">Math</span>.round(uploadFile.nativeFile.size / speedTime);<br><br>                uploadFile.progress.status = ThyUploadStatus.done;<br>                uploadFile.progress.percentage = <span class="hljs-number">100</span>;<br>                uploadFile.progress.speed = speedAverage;<br>                uploadFile.progress.speedHuman = <span class="hljs-string">`<span class="hljs-subst">$&#123;humanizeBytes(speed, <span class="hljs-literal">false</span>, <span class="hljs-number">2</span>)&#125;</span>/s`</span>;<br>                uploadFile.progress.estimatedTime = estimatedTime;<br>                uploadFile.progress.estimatedTimeHuman = <span class="hljs-built_in">this</span>.secondsToHuman(estimatedTime || <span class="hljs-number">0</span>);<br><br>                uploadFile.responseStatus = xhr.status;<br><br>                <span class="hljs-keyword">try</span> &#123;<br>                    uploadFile.response = <span class="hljs-built_in">JSON</span>.parse(xhr.response);<br>                &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                    uploadFile.response = xhr.response;<br>                &#125;<br><br>                <span class="hljs-comment">// file.responseHeaders = this.parseResponseHeaders(xhr.getAllResponseHeaders());</span><br><br>                observer.next(&#123; <span class="hljs-attr">status</span>: ThyUploadStatus.done, <span class="hljs-attr">uploadFile</span>: uploadFile &#125;);<br><br>                observer.complete();<br>            &#125;<br>        &#125;;<br><br>        xhr.upload.addEventListener(<span class="hljs-string">&#x27;progress&#x27;</span>, onProgress, <span class="hljs-literal">false</span>);<br>        xhr.upload.addEventListener(<span class="hljs-string">&#x27;error&#x27;</span>, onError);<br>        <span class="hljs-comment">// When using the [timeout attribute](https://xhr.spec.whatwg.org/#the-timeout-attribute) and an XHR</span><br>        <span class="hljs-comment">// request times out, browsers trigger the `timeout` event (and executes the XHR&#x27;s `ontimeout`</span><br>        <span class="hljs-comment">// callback). Additionally, Safari 9 handles timed-out requests in the same way, even if no `timeout`</span><br>        <span class="hljs-comment">// has been explicitly set on the XHR.</span><br>        xhr.upload.addEventListener(<span class="hljs-string">&#x27;timeout&#x27;</span>, onError);<br>        xhr.addEventListener(<span class="hljs-string">&#x27;timeout&#x27;</span>, onError);<br>        xhr.addEventListener(<span class="hljs-string">&#x27;readystatechange&#x27;</span>, onReadyStateChange);<br><br>        xhr.open(uploadFile.method, uploadFile.url, <span class="hljs-literal">true</span>);<br>        xhr.withCredentials = uploadFile.withCredentials ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData();<br><br>            <span class="hljs-built_in">Object</span>.keys(uploadFile.data || &#123;&#125;).forEach(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> formData.append(key, uploadFile.data[key]));<br>            <span class="hljs-built_in">Object</span>.keys(uploadFile.headers || &#123;&#125;).forEach(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> xhr.setRequestHeader(key, uploadFile.headers[key]));<br><br>            formData.append(uploadFile.fileField || <span class="hljs-string">&#x27;file&#x27;</span>, uploadFile.nativeFile, uploadFile.fileName);<br><br>            observer.next(&#123; <span class="hljs-attr">status</span>: ThyUploadStatus.started, <span class="hljs-attr">uploadFile</span>: uploadFile &#125;);<br>            xhr.send(formData);<br>        &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>            observer.error(error);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> &#123;<br>            xhr,<br>            <span class="hljs-attr">cleanup</span>: <span class="hljs-function">() =&gt;</span> &#123;<br>                xhr.upload.removeEventListener(<span class="hljs-string">&#x27;progress&#x27;</span>, onProgress);<br>                xhr.upload.removeEventListener(<span class="hljs-string">&#x27;error&#x27;</span>, onError);<br>                xhr.upload.removeEventListener(<span class="hljs-string">&#x27;timeout&#x27;</span>, onError);<br>                xhr.removeEventListener(<span class="hljs-string">&#x27;timeout&#x27;</span>, onError);<br>                xhr.removeEventListener(<span class="hljs-string">&#x27;readystatechange&#x27;</span>, onReadyStateChange);<br>            &#125;<br>        &#125;;<br>    &#125;<br></code></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">private</span> ensure<span class="hljs-constructor">FileName(<span class="hljs-params">uploadFile</span>: ThyUploadFile)</span> &#123;<br>    uploadFile.fileName = uploadFile.fileName<span class="hljs-operator"> || </span>uploadFile.nativeFile.name;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ†æ">åˆ†æ</h3><p>ä»£ç çœ‹ç€æŒºé•¿çš„ï¼Œä½†æ˜¯å…¶é€»è¾‘ä¸éš¾ï¼Œæ ¸å¿ƒç‚¹å°±ä¸¤ä¸ªéƒ¨åˆ†ã€‚</p><ol><li><p>upload æ–¹æ³•è¿”å›äº†ä¸€ä¸ª ThyUploadResponse ç±»å‹çš„ Observable å¯è§‚å¯Ÿå¯¹è±¡ï¼Œ å…¶æ„é€ å‡½æ•°ä¼ å…¥ä¸€ä¸ª observerï¼ˆè§‚å¯Ÿè€…/è®¢é˜…è€…ï¼‰ï¼Œreturnäº†ä¸€ä¸ª unsubscribe å‡½æ•°ï¼Œç”¨äºå–æ¶ˆè®¢é˜…ã€‚</p></li><li><p>é‡ç‚¹æ˜¯åˆ›å»º Observable æ—¶çš„å›è°ƒå‡½æ•°ï¼Œå®ƒé‡Œé¢è°ƒç”¨äº†æœ€å…³é”®çš„ uploadByXhr(observer, uploadFile) æ–¹æ³•ï¼Œå…¶ä¸­æŠŠè§‚å¯Ÿè€… observer å’Œ æ–‡ä»¶è¯¦æƒ…å¯¹è±¡ uploadFile ä½œä¸ºå‚æ•°ä¼ äº†è¿›å»ã€‚</p><ul><li><p>æ³¨å…¥ XhrFactory æœåŠ¡ï¼Œè°ƒç”¨ build() å‡½æ•°è·å– XMLHttpRequest å¯¹è±¡</p></li><li><p>å®šä¹‰äº† progressã€errorã€readystatechange äº‹ä»¶çš„å›è°ƒå‡½æ•°</p></li><li><p>è°ƒç”¨ open() å®ä¾‹åŒ–æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¯·æ±‚</p></li><li><p>è°ƒç”¨ send() å®ä¾‹åŒ–æ–¹æ³•æ¥å‘é€ HTTP è¯·æ±‚ï¼Œæ•°æ®ä½“ä¸º FormData ç±»å‹</p></li><li><p>æœ€å return å‡ºå»ä¸€ä¸ªåŒ…å« XMLHttpRequest å¯¹è±¡å’Œä¸€ä¸ªç”¨äºå–æ¶ˆç›‘å¬çš„å‡½æ•°</p></li></ul></li><li><p>æœ€åçœ‹ä¸€ä¸‹ upload() å‡½æ•°ä¸­ return çš„ unsubscribe å‡½æ•°ä¸­éƒ½å¹²äº†äº›å•¥ï¼Ÿ</p><ul><li><p>è°ƒç”¨ cleanup() å‡½æ•°ï¼Œç”¨äºå–æ¶ˆå„ç§ upload æ—¶çš„ç›‘å¬äº‹ä»¶</p></li><li><p>å½“ xhr.readyState !== xhr.DONE æ—¶ï¼Œæ‰§è¡Œ xhr.abort() å‡½æ•°ï¼Œabort() å‡½æ•°çš„ä½œç”¨æ˜¯å–æ¶ˆ http è¯·æ±‚ï¼Œç”¨ä½œå–æ¶ˆä¸Šä¼ ã€‚</p></li></ul></li><li><p>progress äº‹ä»¶ä¼šåœ¨è¯·æ±‚æ¥æ”¶åˆ°æ•°æ®çš„æ—¶å€™è¢«å‘¨æœŸæ€§è§¦å‘ï¼ŒProgressEvent.loaded åªè¯»å±æ€§æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåº•å±‚çš„è¿›ç¨‹å·²ç»æ‰§è¡Œçš„å·¥ä½œé‡ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å±æ€§å’Œ ProgressEvent.total è®¡ç®—å®Œæˆå·¥ä½œçš„æ¯”ç‡ã€‚</p></li></ol><h3 id="ä¸ä¸Šä¼ æœ‰å…³çš„ç±»">ä¸ä¸Šä¼ æœ‰å…³çš„ç±»</h3><p>ä¸Šè¿°åˆ†æä¸­ç®€å•çš„æ¶‰åŠäº†ä¸€äº›ç±»å’Œå‡½æ•°ï¼Œä¸‹é¢æ¥ç³»ç»Ÿçš„çœ‹ä¸€ä¸‹ã€‚</p><h4 id="XMLHttpRequest">XMLHttpRequest</h4><p>å…¶å®ä¾‹æ–¹æ³•ã€äº‹ä»¶æ¯”è¾ƒå¤šï¼Œå¯å‚è€ƒï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest">ä½¿ç”¨XMLHttpRequest</a></p><h4 id="ProgressEvent">ProgressEvent</h4><p>ProgressEvent æ¥å£æ˜¯æµ‹é‡å¦‚ HTTP è¯·æ±‚ï¼ˆä¸€ä¸ªXMLHttpRequestï¼Œæˆ–è€…ä¸€ä¸ª imgï¼Œaudioï¼Œvideoï¼Œstyle æˆ– link ç­‰åº•å±‚èµ„æºçš„åŠ è½½ï¼‰ç­‰åº•å±‚æµç¨‹è¿›åº¦çš„äº‹ä»¶ã€‚</p><h5 id="å®ä¾‹å±æ€§">å®ä¾‹å±æ€§</h5><p><em>lengthComputable</em><br>ProgressEvent.lengthComputable åªè¯»å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”Boolean (en-US) æ ‡å¿—ï¼Œè¡¨ç¤ºProgressEvent æ‰€å…³è”çš„èµ„æºæ˜¯å¦å…·æœ‰å¯ä»¥è®¡ç®—çš„é•¿åº¦ã€‚</p><p><em>loaded</em><br>ProgressEvent.loaded åªè¯»å±æ€§æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåº•å±‚çš„è¿›ç¨‹å·²ç»æ‰§è¡Œçš„å·¥ä½œé‡ã€‚</p><p><em>total</em><br>æ˜¯ä¸€ä¸ªæ— ç¬¦å· 64 ä½æ•´æ•°å€¼ï¼Œè¡¨æ˜æ­£åœ¨å¤„ç†æˆ–è€…ä¼ è¾“çš„æ•°æ®çš„æ€»å¤§å°ã€‚</p><h4 id="FormData">FormData</h4><p>FormData æ¥å£æä¾›äº†ä¸€ç§è¡¨ç¤ºè¡¨å•æ•°æ®çš„é”®å€¼å¯¹ key/value çš„æ„é€ æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾çš„å°†æ•°æ®é€šè¿‡XMLHttpRequest.send() æ–¹æ³•å‘é€å‡ºå»ï¼Œæœ¬æ¥å£å’Œæ­¤æ–¹æ³•éƒ½ç›¸å½“ç®€å•ç›´æ¥ã€‚å¦‚æœé€å‡ºæ—¶çš„ç¼–ç ç±»å‹è¢«è®¾ä¸º â€œmultipart/form-dataâ€ï¼Œå®ƒä¼šä½¿ç”¨å’Œè¡¨å•ä¸€æ ·çš„æ ¼å¼ã€‚</p><h5 id="å®ä¾‹æ–¹æ³•">å®ä¾‹æ–¹æ³•</h5><p><em>append()</em><br>æ·»åŠ ä¸€ä¸ªæ–°å€¼åˆ° FormData å¯¹è±¡å†…çš„ä¸€ä¸ªå·²å­˜åœ¨çš„é”®ä¸­ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™ä¼šæ·»åŠ è¯¥é”®ã€‚</p><p><em>set()</em><br>å¯¹ FormData å¯¹è±¡é‡Œçš„æŸä¸ª key è®¾ç½®ä¸€ä¸ªæ–°çš„å€¼ï¼Œå¦‚æœè¯¥ key ä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ ã€‚</p><p>set() å’Œ FormData.append ä¸åŒä¹‹å¤„åœ¨äºï¼šå¦‚æœæŸä¸ª key å·²ç»å­˜åœ¨ï¼Œset() ä¼šç›´æ¥è¦†ç›–æ‰€æœ‰è¯¥ key å¯¹åº”çš„å€¼ï¼Œè€Œ FormData.append åˆ™æ˜¯åœ¨è¯¥ key çš„æœ€åä½ç½®å†è¿½åŠ ä¸€ä¸ªå€¼ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>angular</tag>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥å¸¸å¼€å‘ä¸­é‚£äº›ä¸å¸¸ç”¨çš„csså±æ€§</title>
    <link href="/posts/747db437/"/>
    <url>/posts/747db437/</url>
    
    <content type="html"><![CDATA[<p>ç”±äº css å±æ€§çš„ç¹å¤šå’Œéš¾å­¦ï¼Œæœ¬ç¯‡æ–‡ç« æ—¨åœ¨è®°å½•å¹³å¸¸å¼€å‘ä¸­é‡åˆ°çš„é‚£äº› css å±æ€§ï¼Œä¼šé•¿æœŸæ›´æ–°è®°å½•ã€‚</p><p>ã€æ³¨ã€‘ç‚¹å‡» css çš„å±æ€§åç§°å¯ä»¥è·³è½¬åˆ° MDN é“¾æ¥ï¼Œå¯æŸ¥çœ‹æ›´è¯¦ç»†çš„ç”¨æ³•ã€‚</p><div class="note note-success">            <ol><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events">pointer-events</a></li></ol>          </div><p>pointer-events CSS å±æ€§è®¾ç½®åœ¨ä»€ä¹ˆæƒ…å†µä¸‹(å¦‚æœæœ‰çš„è¯)ä¸€ä¸ªç‰¹å®šçš„å›¾å½¢å…ƒç´ å¯ä»¥æˆä¸ºæŒ‡é’ˆäº‹ä»¶çš„ç›®æ ‡ã€‚</p><p>é€šå¸¸å’Œ opacity å±æ€§å’Œ cursor å±æ€§æ­é…ä½¿ç”¨ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">pointer-events</span>: none;<br><span class="hljs-attribute">cursor</span>: not-allowed;<br><span class="hljs-attribute">opacity</span>: .<span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p><img src="/img/normal-css/point-events-1.png" alt=""></p><div class="note note-success">            <ol start="2"><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/filter">filter</a></li></ol>          </div><p>css çš„ filter å±æ€§å¯ä»¥ç”¨æ¥å®ç°ç½‘é¡µçš„ã€Œé»˜å“€æ¨¡å¼ã€,è®©æ•´ä¸ªç½‘ç«™å˜ç°è‰²ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">html</span> &#123;<br>  <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">80%</span>);<br>&#125;<br></code></pre></td></tr></table></figure><div class="note note-success">            <ol start="2"><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/filter">border-collapse</a></li></ol>          </div><p>è®¾ç½® &lt; table &gt; ä¸­çš„å•å…ƒæ ¼æ˜¯å¦å…·æœ‰å…±äº«è¾¹æ¡†æˆ–å•ç‹¬çš„è¾¹æ¡†ã€‚</p><p>border-collapse = separate  |  collapse</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">border</span>-<span class="hljs-built_in">collapse</span>: <span class="hljs-built_in">collapse</span>;<br></code></pre></td></tr></table></figure><p><img src="/img/normal-css/collapse.png" alt=""></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">border-collapse</span>: separate;<br></code></pre></td></tr></table></figure><p><img src="/img/normal-css/separate.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javascript Notifications API</title>
    <link href="/posts/5a30c4fd/"/>
    <url>/posts/5a30c4fd/</url>
    
    <content type="html"><![CDATA[<p>Notifications API å…è®¸ç½‘é¡µæˆ–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ï¼Œè¿™äº›é€šçŸ¥åœ¨ç³»ç»Ÿçº§æ˜¾ç¤ºåœ¨ç½‘é¡µä¹‹å¤–; è¿™ä½¿å¾—ç½‘é¡µåº”ç”¨ç¨‹åºå¯ä»¥å‘ç”¨æˆ·å‘é€ä¿¡æ¯ï¼Œå³ä½¿åº”ç”¨ç¨‹åºå¤„äºç©ºé—²çŠ¶æ€æˆ–åœ¨åå°ï¼Œä¸€èˆ¬æ­é… websocket ä½¿ç”¨ã€‚</p><div class="note note-info">            <p>å®‰å…¨ä¸Šä¸‹æ–‡: æ­¤ç‰¹æ€§ä»…åœ¨å®‰å…¨ä¸Šä¸‹æ–‡(HTTPS)ä¸­å¯ç”¨ï¼Œåœ¨éƒ¨åˆ†æˆ–æ‰€æœ‰æ”¯æŒçš„æµè§ˆå™¨ä¸­éƒ½å¯ç”¨ã€‚</p>          </div><p>éœ€è¦æ³¨æ„çš„æ˜¯æ­¤ API åªæœ‰åœ¨ https çš„ç½‘é¡µä¸­æ‰æœ‰æ•ˆæœï¼Œä½†æ˜¯ç»è¿‡æˆ‘çš„æµ‹è¯•å‘ç°åœ¨ Firefox æµè§ˆå™¨ä¸­è²Œä¼¼æœ¬åœ°ä¹Ÿå¯ä»¥è°ƒè¯•ï¼Œä½†æ˜¯ Chromeæœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹ç¡®å®ä¸è¡Œã€‚é‚£ä¹ˆå¦‚æœéè¦æƒ³åœ¨ Chrome æµè§ˆå™¨çš„æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹è°ƒè¯•åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘æŸ¥äº†å¥½ä¹…ä¹Ÿç»ˆäºæ‰¾åˆ°äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼š</p><p><a href="https://blog.csdn.net/qq_25231683/article/details/127447769">åœ¨ HTTP ç½‘ç«™ä¸­å¼€å¯ Notification API</a></p><h3 id="è¯·æ±‚æƒé™">è¯·æ±‚æƒé™</h3><p>åœ¨åº”ç”¨å¯ä»¥å‘é€é€šçŸ¥ä¹‹å‰ï¼Œç”¨æˆ·å¿…é¡»æˆäºˆåº”ç”¨æœ‰æƒè¿™ä¹ˆåšã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„è¦æ±‚ï¼Œå½“ä¸€ä¸ª API è‡³å°‘ä¸€æ¬¡è¯•å›¾ä¸ web é¡µå¤–éƒ¨è¿›è¡Œäº¤äº’æ—¶ï¼Œç”¨æˆ·ä¸å¾—ä¸ä¸“é—¨æˆäºˆè¯¥åº”ç”¨ç¨‹åºæœ‰æƒé™æå‡ºé€šçŸ¥ï¼Œä»è€Œè®©ç”¨æˆ·æ§åˆ¶å…è®¸å“ªäº›åº”ç”¨ç¨‹åºæˆ–ç½‘ç«™æ˜¾ç¤ºé€šçŸ¥ã€‚</p><p>æƒé™çŠ¶æ€æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li><p>defaultï¼šç”¨æˆ·è¿˜æœªè¢«è¯¢é—®æ˜¯å¦æˆæƒï¼Œæ‰€ä»¥é€šçŸ¥ä¸ä¼šè¢«æ˜¾ç¤ºã€‚å‚çœ‹ è·å¾—æƒé™ ä»¥äº†è§£å¦‚ä½•è¯·æ±‚æ˜¾ç¤ºé€šçŸ¥çš„æƒé™ã€‚</p></li><li><p>grantedï¼šè¡¨ç¤ºä¹‹å‰å·²ç»è¯¢é—®è¿‡ç”¨æˆ·ï¼Œå¹¶ä¸”ç”¨æˆ·å·²ç»æˆäºˆäº†æ˜¾ç¤ºé€šçŸ¥çš„æƒé™ã€‚</p></li><li><p>deniedï¼šç”¨æˆ·å·²ç»æ˜ç¡®çš„æ‹’ç»äº†æ˜¾ç¤ºé€šçŸ¥çš„æƒé™ã€‚</p></li></ul><p>å¦‚æœæƒé™å°šæœªè¢«æˆäºˆï¼Œé‚£ä¹ˆåº”ç”¨ä¸å¾—ä¸é€šè¿‡ Notification.requestPermission() æ–¹æ³•è®©ç”¨æˆ·è¿›è¡Œé€‰æ‹©ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¸€æ—¦ç”¨æˆ·å›åº”äº†æ˜¾ç¤ºé€šçŸ¥çš„è¯·æ±‚ï¼Œå°†ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><p>é€šå¸¸ä½ åº”åœ¨ä½ çš„åº”ç”¨é¦–æ¬¡åˆå§‹åŒ–çš„æ—¶å€™è¯·æ±‚æ˜¾ç¤ºé€šçŸ¥çš„æƒé™ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><pre><code class="hljs kotlin">checkPermission(onSuccess?: Function, onError?: Function, onThen?: Function) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.permissionLevel !== <span class="hljs-string">&#x27;granted&#x27;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isSupported) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            Notification.requestPermission(result =&gt; &#123;<br>                <span class="hljs-keyword">if</span> (result === <span class="hljs-string">&#x27;granted&#x27;</span>) &#123;<br>                    <span class="hljs-keyword">this</span>.permissionLevel = <span class="hljs-string">&#x27;granted&#x27;</span>;<br>                    <span class="hljs-keyword">if</span> (onSuccess) &#123;<br>                        onSuccess();<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (result === <span class="hljs-string">&#x27;denied&#x27;</span>) &#123;<br>                    <span class="hljs-keyword">this</span>.permissionLevel = <span class="hljs-string">&#x27;denied&#x27;</span>;<br>                    <span class="hljs-keyword">if</span> (onError) &#123;<br>                        onError();<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">this</span>.isSetPermission = <span class="hljs-literal">false</span>;<br>                &#125;<br>            &#125;);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">this</span>.permissionLevel = <span class="hljs-string">&#x27;granted&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (onSuccess) &#123;<br>                onSuccess();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">this</span>.isSetPermission = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">if</span> (onThen) &#123;<br>            onThen();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ›å»ºé€šçŸ¥">åˆ›å»ºé€šçŸ¥</h3><p>åˆ›å»ºé€šçŸ¥å¾ˆç®€å•ï¼Œåªéœ€è¦ç”¨ Notification æ„é€ æ–¹æ³•ã€‚è¿™ä¸ªæ„é€ å‡½æ•°éœ€è¦ä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºåœ¨é€šçŸ¥å†…çš„æ ‡é¢˜ä»¥åŠä¸€äº›ç”¨æ¥å¢å¼ºé€šçŸ¥çš„é€‰é¡¹ï¼Œä¾‹å¦‚ icon æˆ–æ–‡æœ¬ bodyã€‚</p><p>ä¸€æ—¦é€šçŸ¥è¢«åˆ›å»ºå‡ºæ¥ï¼Œå®ƒä¼šç«‹å³è¢«æ˜¾ç¤ºå‡ºæ¥ã€‚ä¸ºäº†è·Ÿè¸ªé€šçŸ¥å½“å‰çš„çŠ¶æ€ï¼Œåœ¨ Notification å®ä¾‹å±‚é¢ä¸Šä¼šæœ‰ 4 ä¸ªäº‹ä»¶è¢«è§¦å‘ï¼š</p><ul><li>showï¼šå½“é€šçŸ¥è¢«æ˜¾ç¤ºç»™ç”¨æˆ·æ—¶è§¦å‘ã€‚</li><li>clickï¼šå½“ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶è§¦å‘ã€‚</li><li>closeï¼šå½“é€šçŸ¥è¢«å…³é—­æ—¶è§¦å‘ã€‚</li><li>errorï¼šå½“é€šçŸ¥å‘ç”Ÿé”™è¯¯çš„æ—¶å€™è§¦å‘ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºé€šçŸ¥ç”±äºæŸäº›åŸå› è€Œæ— æ³•æ˜¾ç¤ºã€‚</li></ul><p>è¿™äº›äº‹ä»¶å¯ä»¥é€šè¿‡äº‹ä»¶å¤„ç†è·Ÿè¸ª onshowã€onclickã€onclose å’Œ onerrorã€‚å› ä¸º Notification åŒæ ·ç»§æ‰¿è‡ª EventTargetï¼Œå› æ­¤å¯ä»¥å¯¹å®ƒè°ƒç”¨ addEventListener() æ–¹æ³•ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-title">show</span>(<span class="hljs-params">option: &#123; title?: <span class="hljs-built_in">string</span>; body?: <span class="hljs-built_in">string</span>; icon?: <span class="hljs-built_in">string</span>, click?: <span class="hljs-built_in">Function</span> &#125;</span>)</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.isSupported) &#123;<br>            <span class="hljs-keyword">const</span> notifyOption = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, <span class="hljs-built_in">this</span>.configOptions, option);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.permissionLevel === <span class="hljs-string">&#x27;granted&#x27;</span>) &#123;<br>                <span class="hljs-keyword">const</span> notification = <span class="hljs-keyword">new</span> Notification(notifyOption.title, notifyOption);<br>                <span class="hljs-keyword">if</span> (option.click) &#123;<br>                    notification.onclick = <span class="hljs-function">() =&gt;</span> &#123;<br>                        option.click();<br>                        notification.close();<br>                    &#125;;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                Notification.requestPermission(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> &#123;<br>                    <span class="hljs-keyword">if</span> (result === <span class="hljs-string">&#x27;granted&#x27;</span>) &#123;<br>                        <span class="hljs-keyword">const</span> notification = <span class="hljs-keyword">new</span> Notification(notifyOption.title, notifyOption);<br>                        <span class="hljs-keyword">if</span> (option.click) &#123;<br>                            notification.onclick = <span class="hljs-function">() =&gt;</span> &#123;<br>                                option.click();<br>                                notification.close();<br>                            &#125;;<br>                        &#125;<br>                    &#125;<br>                &#125;);<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="å…³é—­é€šçŸ¥">å…³é—­é€šçŸ¥</h3><p>å¯ä»¥ä½¿ç”¨ close ()åˆ é™¤ä¸ç”¨æˆ·ä¸å†ç›¸å…³çš„é€šçŸ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Javascript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>jsåŸç”Ÿapi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaScript Intersection Observer API</title>
    <link href="/posts/4e1dac9a/"/>
    <url>/posts/4e1dac9a/</url>
    
    <content type="html"><![CDATA[<p>åœ¨æˆ‘ä»¬å…¬å¸çš„äº§å“ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªæ–°ä¸Šçº¿çš„æœ‰æ„æ€çš„äº¤äº’æ•ˆæœï¼ŒåŸæœ¬æˆ‘ä»¥ä¸ºè¿™ç§äº¤äº’æ˜¯å€ŸåŠ©äº† positon: sticky å®šä½å®ç°ï¼Œä½†æ˜¯ç»†ç»†è§‚å¯Ÿåå‘ç°å¹¶ä¸æ˜¯ï¼Œäºæ˜¯ç¿»çœ‹æºç ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå¹¶äºæ­¤å­¦åˆ°äº†ä¸€ä¸ªæ–°çš„æœ‰æ„æ€çš„ API: Intersection Observerã€‚</p><span id="more"></span><p>å…ˆçœ‹ä¸€ä¸‹äº§å“çš„äº¤äº’æ•ˆæœï¼šå½“æ»šåŠ¨æ¡å‘ä¸‹æ»šåŠ¨æ—¶ï¼Œåœ¨å†…å®¹çš„æ ‡é¢˜å³å°†æ¶ˆå¤±çš„æ—¶å€™ï¼Œæ¨¡å—æ¡†é¡¶éƒ¨çš„æ ‡é¢˜å†…å®¹å°±æ¢æˆäº†å†…å®¹çš„æ ‡é¢˜ã€‚</p><p><img src="/img/intersection/1.gif" alt=""></p><p>å…ˆè¯´ä¸€ä¸‹å®ç°æ€è·¯å§ï¼šå®ç°æ­¤äº¤äº’çš„å…³é”®ç‚¹å°±æ˜¯åœ¨äºæ€ä¹ˆä¼˜é›…çš„åˆ¤æ–­å‡ºå†…å®¹çš„æ ‡é¢˜çš„å¯è§æ€§ï¼Ÿè§£å†³äº†è¿™ä¸ªé—®é¢˜ä»¥åï¼Œæ¥ä¸‹æ¥å°±æ˜¯åœ¨å†…å®¹çš„æ ‡é¢˜æ¶ˆå¤±æˆ–è€…å‡ºç°çš„èŠ‚ç‚¹ï¼Œæ·»åŠ ä¸Šç›¸åº”çš„ css è¿‡æ¸¡å±æ€§ï¼ˆtransitionï¼‰æ ·å¼å°±å¯ä»¥äº†ã€‚</p><h3 id="Intersection-observer-æ¦‚å¿µå’Œç”¨æ³•">Intersection observer æ¦‚å¿µå’Œç”¨æ³•</h3><p>Intersection Observer API æä¾›äº†ä¸€ç§å¼‚æ­¥è§‚å¯Ÿç›®æ ‡å…ƒç´ ä¸ç¥–å…ˆå…ƒç´ æˆ–é¡¶çº§æ–‡æ¡£è§†å£äº¤é›†ä¸­çš„å˜åŒ–çš„æ–¹æ³•ã€‚</p><p>Intersection Observer API å…è®¸æ‚¨é…ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨ä»¥ä¸‹æƒ…å†µå‘ç”Ÿæ—¶è°ƒç”¨è¯¥å‡½æ•°:</p><ul><li><p>æ¯å½“ç›®æ ‡ (target) å…ƒç´ ä¸è®¾å¤‡è§†çª—æˆ–è€…å…¶ä»–æŒ‡å®šå…ƒç´ å‘ç”Ÿäº¤é›†çš„æ—¶å€™æ‰§è¡Œã€‚è®¾å¤‡è§†çª—æˆ–è€…å…¶ä»–å…ƒç´ æˆ‘ä»¬ç§°å®ƒä¸ºæ ¹å…ƒç´ æˆ–æ ¹ (root)ã€‚</p></li><li><p>Observer ç¬¬ä¸€æ¬¡ç›‘å¬ç›®æ ‡å…ƒç´ çš„æ—¶å€™</p></li></ul><p>ç›®æ ‡ (target) å…ƒç´ ä¸æ ¹ (root) å…ƒç´ ä¹‹é—´çš„äº¤å‰åº¦æ˜¯äº¤å‰æ¯” (intersection ratio)ã€‚è¿™æ˜¯ç›®æ ‡ (target) å…ƒç´ ç›¸å¯¹äºæ ¹ (root) çš„äº¤é›†ç™¾åˆ†æ¯”çš„è¡¨ç¤ºï¼Œå®ƒçš„å–å€¼åœ¨ 0.0 å’Œ 1.0 ä¹‹é—´ã€‚</p><p>ç”¨æ³•ä¹Ÿæ˜¯éå¸¸ç®€å•ï¼Œåˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ª intersection observer</li></ol><p>åˆ›å»ºä¸€ä¸ª IntersectionObserver å¯¹è±¡ï¼Œå¹¶ä¼ å…¥ç›¸åº”å‚æ•°å’Œå›è°ƒç”¨å‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°å°†ä¼šåœ¨ç›®æ ‡ (target) å…ƒç´ å’Œæ ¹ (root) å…ƒç´ çš„äº¤é›†å¤§å°è¶…è¿‡é˜ˆå€¼ (threshold) è§„å®šçš„å¤§å°æ—¶å€™è¢«æ‰§è¡Œã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">let</span> options = &#123;<br>  root: document.query<span class="hljs-constructor">Selector(&#x27;#<span class="hljs-params">scrollArea</span>&#x27;)</span>,<br>  rootMargin: &#x27;<span class="hljs-number">0</span>px&#x27;,<br>  threshold: <span class="hljs-number">1.0</span><br>&#125;<br><br><span class="hljs-keyword">let</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-constructor">IntersectionObserver(<span class="hljs-params">callback</span>, <span class="hljs-params">options</span>)</span>;<br></code></pre></td></tr></table></figure><p>é˜ˆå€¼ä¸º 1.0 æ„å‘³ç€ç›®æ ‡å…ƒç´ å®Œå…¨å‡ºç°åœ¨ root é€‰é¡¹æŒ‡å®šçš„å…ƒç´ ä¸­å¯è§æ—¶ï¼Œå›è°ƒå‡½æ•°å°†ä¼šè¢«æ‰§è¡Œã€‚</p><ol start="2"><li>Intersection observer options</li></ol><p>ä¼ é€’åˆ° IntersectionObserver() æ„é€ å‡½æ•°çš„ options å¯¹è±¡ï¼Œå…è®¸æ‚¨æ§åˆ¶è§‚å¯Ÿè€…çš„å›è°ƒå‡½æ•°çš„è¢«è°ƒç”¨æ—¶çš„ç¯å¢ƒã€‚å®ƒæœ‰ä»¥ä¸‹å­—æ®µï¼š</p><div class="note note-success">            <p>info</p>          </div><p>æŒ‡å®šæ ¹ (root) å…ƒç´ ï¼Œç”¨äºæ£€æŸ¥ç›®æ ‡çš„å¯è§æ€§ã€‚å¿…é¡»æ˜¯ç›®æ ‡å…ƒç´ çš„çˆ¶çº§å…ƒç´ ã€‚å¦‚æœæœªæŒ‡å®šæˆ–è€…ä¸ºnullï¼Œåˆ™é»˜è®¤ä¸ºæµè§ˆå™¨è§†çª—ã€‚</p><div class="note note-success">            <p>rootMargin</p>          </div><p>æ ¹ (root) å…ƒç´ çš„å¤–è¾¹è·ã€‚ç±»ä¼¼äº CSS ä¸­çš„ margin å±æ€§ï¼Œæ¯”å¦‚ â€œ10px 20px 30px 40pxâ€ (topã€rightã€bottomã€left)ã€‚å¦‚æœæœ‰æŒ‡å®š root å‚æ•°ï¼Œåˆ™ rootMargin ä¹Ÿå¯ä»¥ä½¿ç”¨ç™¾åˆ†æ¯”æ¥å–å€¼ã€‚è¯¥å±æ€§å€¼æ˜¯ç”¨ä½œ root å…ƒç´ å’Œ target å‘ç”Ÿäº¤é›†æ—¶å€™çš„è®¡ç®—äº¤é›†çš„åŒºåŸŸèŒƒå›´ï¼Œä½¿ç”¨è¯¥å±æ€§å¯ä»¥æ§åˆ¶ root å…ƒç´ æ¯ä¸€è¾¹çš„æ”¶ç¼©æˆ–è€…æ‰©å¼ ã€‚é»˜è®¤å€¼ä¸ºå››ä¸ªè¾¹è·å…¨æ˜¯ 0ã€‚</p><div class="note note-success">            <p>threshold</p>          </div><p>å¯ä»¥æ˜¯å•ä¸€çš„ number ä¹Ÿå¯ä»¥æ˜¯ number æ•°ç»„ï¼Œtarget å…ƒç´ å’Œ root å…ƒç´ ç›¸äº¤ç¨‹åº¦è¾¾åˆ°è¯¥å€¼çš„æ—¶å€™ IntersectionObserver æ³¨å†Œçš„å›è°ƒå‡½æ•°å°†ä¼šè¢«æ‰§è¡Œã€‚å¦‚æœä½ åªæ˜¯æƒ³è¦æ¢æµ‹å½“ target å…ƒç´ çš„åœ¨ root å…ƒç´ ä¸­çš„å¯è§æ€§è¶…è¿‡ 50% çš„æ—¶å€™ï¼Œä½ å¯ä»¥æŒ‡å®šè¯¥å±æ€§å€¼ä¸º 0.5ã€‚å¦‚æœä½ æƒ³è¦ target å…ƒç´ åœ¨ root å…ƒç´ çš„å¯è§ç¨‹åº¦æ¯å¤š 25% å°±æ‰§è¡Œä¸€æ¬¡å›è°ƒï¼Œé‚£ä¹ˆä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªæ•°ç»„ [0, 0.25, 0.5, 0.75, 1]ã€‚é»˜è®¤å€¼æ˜¯ 0 (æ„å‘³ç€åªè¦æœ‰ä¸€ä¸ª target åƒç´ å‡ºç°åœ¨ root å…ƒç´ ä¸­ï¼Œå›è°ƒå‡½æ•°å°†ä¼šè¢«æ‰§è¡Œ)ã€‚è¯¥å€¼ä¸º 1.0 å«ä¹‰æ˜¯å½“ target å®Œå…¨å‡ºç°åœ¨ root å…ƒç´ ä¸­æ—¶å€™ å›è°ƒæ‰ä¼šè¢«æ‰§è¡Œã€‚</p><ol start="3"><li>Targeting an element to be observed</li></ol><p>åˆ›å»ºä¸€ä¸ª observer åéœ€è¦ç»™å®šä¸€ä¸ªç›®æ ‡å…ƒç´ è¿›è¡Œè§‚å¯Ÿã€‚</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs aspectj">let <span class="hljs-keyword">target</span> = document.querySelector(<span class="hljs-string">&#x27;#listItem&#x27;</span>);<br>observer.observe(<span class="hljs-keyword">target</span>);<br></code></pre></td></tr></table></figure><h3 id="å®æˆ˜Demo">å®æˆ˜Demo</h3><p>å¤§æ¦‚äº†è§£äº†è¯¥ API çš„è¯­æ³•ä»¥åï¼Œå°è¯•å†™ä¸€ä¸ªç®€å•çš„ demo è¿˜åŸä¸€ä¸‹å…¬å¸äº§å“çš„é‚£ç§äº¤äº’æ•ˆæœã€‚</p><p>html</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span> [<span class="hljs-attr">ngClass</span>]=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;&#x27;fixed&#x27;: isFixed&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;title1&quot;</span>&gt;</span>ç›®æ ‡å…ƒç´ å¯è§<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;title2&quot;</span>&gt;</span>ç›®æ ‡å…ƒç´ æ¶ˆå¤±å•¦<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> #<span class="hljs-attr">wraper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;wraper&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span> #<span class="hljs-attr">box</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>scss</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;<br>    <span class="hljs-attribute">display</span>: flex;<br>    <span class="hljs-attribute">flex-direction</span>: column;<br>    <span class="hljs-attribute">position</span>: relative;<br><br>    <span class="hljs-selector-tag">header</span> &#123;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;<br>      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#aaa</span>;<br>      <span class="hljs-attribute">display</span>: flex;<br>      <span class="hljs-attribute">align-items</span>: center;<br><br>      <span class="hljs-selector-class">.title1</span> &#123;<br>        <span class="hljs-attribute">visibility</span>: visible;<br>        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>        <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">0px</span>;<br>        <span class="hljs-attribute">transition</span>: <span class="hljs-number">400ms</span> ease-out;<br>        <span class="hljs-attribute">transition-property</span>: margin-top, opacity;<br>        <span class="hljs-attribute">position</span>: inherit;<br>        <span class="hljs-attribute">overflow</span>: hidden;<br>      &#125;<br><br>      <span class="hljs-selector-class">.title2</span> &#123;<br>        <span class="hljs-attribute">position</span>: absolute;<br>        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">visibility</span>: hidden;<br>        <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">32px</span>;<br>        <span class="hljs-attribute">transition</span>: <span class="hljs-number">400ms</span> ease-out;<br>        <span class="hljs-attribute">transition-property</span>: margin-top, opacity;<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-selector-class">.wraper</span> &#123;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">600px</span>;<br>      <span class="hljs-attribute">overflow</span>: auto;<br>      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#eee</span>;<br><br>      <span class="hljs-selector-class">.box</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;<br>        <span class="hljs-attribute">background-color</span>: red;<br>      &#125;<br><br>      <span class="hljs-selector-class">.content</span> &#123;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">1100px</span>;<br>      &#125;<br>    &#125;<br><br>    &amp;<span class="hljs-selector-class">.fixed</span> &#123;<br>      <span class="hljs-selector-tag">header</span> &#123;<br>        <span class="hljs-selector-class">.title1</span> &#123;<br>          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>          <span class="hljs-attribute">margin-top</span>: -<span class="hljs-number">32px</span>;<br>          <span class="hljs-attribute">position</span>: absolute;<br>          <span class="hljs-attribute">pointer-events</span>: none;<br>        &#125;<br>  <br>        <span class="hljs-selector-class">.title2</span> &#123;<br>          <span class="hljs-attribute">display</span>: flex;<br>          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>          <span class="hljs-attribute">visibility</span>: visible;<br>          <span class="hljs-attribute">position</span>: inherit;<br>          <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">0</span>;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure><p>ts</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@ViewChild(<span class="hljs-meta-string">&#x27;wraper&#x27;</span>, &#123; read: ElementRef &#125;)</span> body!: ElementRef;<br><br><span class="hljs-meta">@ViewChild(<span class="hljs-meta-string">&#x27;box&#x27;</span>, &#123; read: ElementRef &#125;)</span> box!: ElementRef;<br><br>isFixed: boolean = <span class="hljs-literal">false</span>;<br><br>ngAfterViewInit(): void &#123;<br>   <span class="hljs-keyword">const</span> options = &#123;<br>     root: <span class="hljs-keyword">this</span>.body.nativeElement,<br>     rootMargin: <span class="hljs-string">&#x27;0px&#x27;</span>,<br>     threshold: <span class="hljs-number">0.2</span>,<br>   &#125;;<br>   <span class="hljs-keyword">const</span> observer = new IntersectionObserver(<span class="hljs-keyword">this</span>.callback, options);<br>   observer.observe(<span class="hljs-keyword">this</span>.box.nativeElement);<br> &#125;<br><br> callback = (<span class="hljs-keyword">data</span>: IntersectionObserverEntry[]) =&gt; &#123;<br>   <span class="hljs-keyword">const</span> intersectionRatio = <span class="hljs-keyword">data</span>[<span class="hljs-number">0</span>]?.intersectionRatio;<br>     <span class="hljs-keyword">if</span> (intersectionRatio &lt; <span class="hljs-number">0.2</span>) &#123;<br>       <span class="hljs-keyword">this</span>.isFixed = <span class="hljs-literal">true</span>;<br>     &#125; <span class="hljs-keyword">else</span> &#123;<br>       <span class="hljs-keyword">this</span>.isFixed = <span class="hljs-literal">false</span>;<br>     &#125;<br> &#125;;<br></code></pre></td></tr></table></figure><p>å®Œç»“æ’’èŠ±ğŸ‰ï¼Œæœ€åçœ‹ä¸€ä¸‹æ•ˆæœï¼š</p><p><img src="/img/intersection/2.gif" alt=""></p><h3 id="æ€»ç»“">æ€»ç»“</h3><p>è¿™é‡Œåªæ˜¯å®ç°äº†ä¸ªç®€å•çš„äº¤äº’æ•ˆæœï¼Œå…¶å® Intersection observer API çš„ä½œç”¨è¿œä¸æ­¢äºæ­¤ï¼Œæ¯”å¦‚ è¿˜å¯ä»¥ç”¨æ¥å®ç°å›¾ç‰‡çš„æ‡’åŠ è½½ã€å†…å®¹æ— é™æ»šåŠ¨ç­‰ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»æŸ¥çœ‹æ›´è¯¦ç»†çš„ç”¨æ³•ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#intersection_observer_concepts_and_usage">MDN-Intersection Observer API</a></p><p>æœ€åæ€»ç»“ä¸€ä¸‹ç”¨åˆ°çš„çŸ¥è¯†ç‚¹ï¼š</p><ol><li>Intersection observer API</li><li>åˆ©ç”¨ css çš„ transitionã€transition-property å±æ€§</li></ol>]]></content>
    
    
    <categories>
      
      <category>Javascript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>jsåŸç”Ÿapi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Angularä¸­çš„å¼€å‘æŠ€å·§</title>
    <link href="/posts/61885c8d/"/>
    <url>/posts/61885c8d/</url>
    
    <content type="html"><![CDATA[<h3 id="å†™åœ¨å‰é¢-ğŸ‘£">å†™åœ¨å‰é¢ ğŸ‘£</h3><p>angularæ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„å‰ç«¯æ¡†æ¶ï¼Œä½†æ˜¯å„ç§è¯­æ³•å’Œapiä¹Ÿæ˜¯ç›¸å¯¹è¾ƒå¤šï¼ŒæŒæ¡ä¸€äº›å¼€å‘æŠ€å·§å¯ä»¥ä½¿æˆ‘ä»¬å†™çš„ä»£ç çœ‹èµ·æ¥æ›´ä¼˜é›…ï¼Œæˆ‘æ¥è§¦angularå¼€å‘ä¸‰å¹´æœ‰ä½™ï¼ŒåŠ å…¥æˆ‘ä»¬worktileå›¢é˜Ÿä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œä¸ç®¡æ˜¯é€šè¿‡è‡ªå·±å­¦ä¹ è¿˜æ˜¯å‚è€ƒç ”ç©¶å‰è¾ˆå†™çš„ä»£ç ï¼Œå­¦åˆ°äº†å¾ˆå¤šæ–°çš„çŸ¥è¯†ï¼Œæ­£å¥½å€Ÿæ­¤æœºä¼šæ¥ä¸€æ³¢æ€»ç»“ã€‚</p><span id="more"></span><h3 id="å·¥å…·ç¯‡-ğŸ› ï¸">å·¥å…·ç¯‡ ğŸ› ï¸</h3><p>ä¿—è¯è¯´å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å…ˆæ¨èå‡ ä¸ªæˆ‘è£…æœºå¿…å¤‡çš„è½¯ä»¶å’Œæ’ä»¶ã€‚</p><ol><li>utools è½¯ä»¶</li></ol><p>æé«˜ç”Ÿäº§åŠ›çš„å·¥å…·ï¼Œè½»é‡ã€å®‰å…¨ã€ç®€æ´ã€æ— å¹¿å‘Šã€‚</p><ol start="2"><li>FeHelper æµè§ˆå™¨æ’ä»¶</li></ol><p>å‰ç«¯åŠ©æ‰‹</p><ol start="3"><li>æ²™æ‹‰æŸ¥è¯</li></ol><p>Saladict æ²™æ‹‰æŸ¥è¯æ˜¯ä¸€æ¬¾ä¸“ä¸šåˆ’è¯ç¿»è¯‘æ‰©å±•ï¼Œä¸ºäº¤å‰é˜…è¯»è€Œç”Ÿã€‚å¤§é‡æƒå¨è¯å…¸æ¶µç›–ä¸­è‹±æ—¥éŸ©æ³•å¾·è¥¿è¯­ã€‚</p><h3 id="js-ts-ç¯‡-ğŸƒ">js/ts ç¯‡ ğŸƒ</h3><ol><li>æ±‚æ•°ç»„ä¸­çš„æ€»å’Œã€æœ€å¤§æœ€å°å€¼</li></ol><figure class="highlight js"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> array = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>];<br></code></pre></td></tr></table></figure><ul><li>æ±‚å’Œ</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript">array.reduce(<span class="hljs-function">(<span class="hljs-params">pre,cur</span>) =&gt;</span> pre + cur);<br></code></pre></td></tr></table></figure><ul><li>æ±‚æœ€å¤§å€¼</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript">array.reduce(<span class="hljs-function">(<span class="hljs-params">pre,cur</span>) =&gt;</span> pre &gt; cur ? pre : cur);<br></code></pre></td></tr></table></figure><ul><li>æ±‚æœ€å°å€¼</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript">array.reduce(<span class="hljs-function">(<span class="hljs-params">pre,cur</span>) =&gt;</span> pre &lt; cur ? pre : cur);<br></code></pre></td></tr></table></figure><ol start="2"><li>è¿‡æ»¤å‡ºæ•°ç»„ä¸­çš„çœŸå€¼</li></ol><p>å‚æ•°å€¼ä¸º 0 ã€ -0 ã€ null ã€ false ã€ NaN ã€ undefined ï¼Œæˆ–ç©ºå­—ç¬¦ä¸²ï¼ˆ â€œâ€ ï¼‰ï¼Œåˆ™è¯¥å¯¹è±¡å…·</p><p>æœ‰çš„åˆå§‹å€¼ä¸º false</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> array = [<span class="hljs-number">0</span>,-<span class="hljs-number">0</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">false</span>,<span class="hljs-literal">NaN</span>,<span class="hljs-literal">undefined</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br><br>array.filter(<span class="hljs-built_in">Boolean</span>);<br><br><span class="hljs-comment">// Booleanä¸ä»…æ˜¯ä¸€ä¸ªbooleanç±»å‹çš„åŒ…è£…å™¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè½¬æ¢å‡½æ•°ä½¿ç”¨ï¼Œç­‰åŒäºåŒé‡éè¿ç®—ç¬¦!!</span><br><span class="hljs-comment">// ä¸Šè¡Œä»£ç ç­‰åŒäºï¼š</span><br><span class="hljs-comment">// array.filter(item =&gt; Boolean(item)); </span><br><br><span class="hljs-comment">// è¾“å‡ºï¼š[1, 2, 3]</span><br></code></pre></td></tr></table></figure><ol start="3"><li>å»é™¤æ•°ç»„ä¸­é‡å¤å€¼</li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> array = [a,b,c,d,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,a,e,f,<span class="hljs-number">1</span>];<br><br>array.filter(<span class="hljs-function">(<span class="hljs-params">item,idx</span>) =&gt;</span> array.indexOf(item) === idx);<br><br>array = [...new <span class="hljs-built_in">Set</span>(array)]<br></code></pre></td></tr></table></figure><ol start="4"><li>ä¸‰å…ƒè¿ç®—ç¬¦å’Œç©ºåˆå¹¶è¿ç®—ç¬¦(??)</li></ol><p>ä¸‰å…ƒè¿ç®—ç¬¦å¤§å®¶ç»å¸¸ç”¨ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ–è®¸ç©ºåˆå¹¶è¿ç®—ç¬¦æ‰æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p><p>ç©ºåˆå¹¶è¿ç®—ç¬¦ (??) æ˜¯ä¸€ä¸ªé€»è¾‘è¿ç®—ç¬¦ï¼Œå½“å…¶å·¦ä¾§æ“ä½œæ•°ä¸ºç©ºæˆ–æœªå®šä¹‰æ—¶è¿”å›å…¶å³ä¾§æ“ä½œæ•°ï¼Œå¦åˆ™è¿”å›å…¶å·¦ä¾§æ“ä½œæ•°ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> item: <span class="hljs-built_in">any</span> = helpers.find(okrObjectiveType, &#123; <span class="hljs-attr">value</span>: value.type &#125;);<br><span class="hljs-keyword">return</span> item ? item.desc : <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-comment">// ç­‰åŒäºï¼š</span><br><span class="hljs-keyword">return</span> item?.desc ?? <span class="hljs-string">&#x27;&#x27;</span>;<br></code></pre></td></tr></table></figure><ol start="5"><li>å±•å¼€è¯­æ³•</li></ol><ul><li>åˆå¹¶å¯¹è±¡å±æ€§ä¸è¦å†ç”¨ Object.assign() å±æ€§å•¦</li></ul><p>å±•å¼€å¯¹è±¡çš„è¯­æ³•å’Œ Object.assign() è¡Œä¸ºä¸€è‡´ï¼Œæ‰§è¡Œçš„éƒ½æ˜¯æµ…æ‹·è´ (åªéå†ä¸€å±‚)ã€‚ä½†æ˜¯è¯­æ³•æ›´ç®€çŸ­ï¼Œéœ€è¦æ³¨</p><p>æ„çš„æ˜¯ Object.assign() å‡½æ•°ä¼šè§¦å‘ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/set"> setters </a>ï¼Œè€Œå±•å¼€è¯­æ³•åˆ™ä¸ä¼šã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> user = &#123; <br> <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Kapil Raghuwanshi&#x27;</span>, <br> <span class="hljs-attr">gender</span>: <span class="hljs-string">&#x27;Male&#x27;</span> <br>&#125;;<br><br><span class="hljs-keyword">const</span> college = &#123; <br> <span class="hljs-attr">primary</span>: <span class="hljs-string">&#x27;Mani Primary School&#x27;</span>, <br> <span class="hljs-attr">secondary</span>: <span class="hljs-string">&#x27;Lass Secondary School&#x27;</span> <br>&#125;;<br><br><span class="hljs-keyword">const</span> summary = &#123;...user,...college&#125;;<br></code></pre></td></tr></table></figure><ul><li>è¿æ¥å¤šä¸ªæ•°ç»„</li></ul><p>æ²¡æœ‰å±•å¼€è¯­æ³•çš„æ—¶å€™ï¼Œåªèƒ½ç»„åˆä½¿ç”¨ push , splice , concat ç­‰æ–¹æ³•ï¼Œæ¥å°†å·²æœ‰æ•°ç»„å…ƒç´ å˜æˆæ–°æ•°ç»„çš„ä¸€éƒ¨åˆ†ã€‚æœ‰äº†å±•å¼€è¯­æ³•ï¼Œé€šè¿‡å­—é¢é‡æ–¹å¼ï¼Œæ„é€ æ–°æ•°ç»„ä¼šå˜å¾—æ›´ç®€å•ã€æ›´ä¼˜é›…ï¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> parts = [<span class="hljs-string">&#x27;shoulders&#x27;</span>, <span class="hljs-string">&#x27;knees&#x27;</span>];<br><br><span class="hljs-keyword">const</span> lyrics = [<span class="hljs-string">&#x27;head&#x27;</span>, ...parts, <span class="hljs-string">&#x27;and&#x27;</span>, <span class="hljs-string">&#x27;toes&#x27;</span>];<br><br><span class="hljs-comment">// [&quot;head&quot;, &quot;shoulders&quot;, &quot;knees&quot;, &quot;and&quot;, &quot;toes&quot;]</span><br></code></pre></td></tr></table></figure><ol start="6"><li>å¯é€‰é“¾</li></ol><p>å¯é€‰çš„é“¾æ¥ ?. å¦‚æœå€¼åœ¨ ? ä¹‹å‰ï¼Œåˆ™åœæ­¢è¯„ä¼°ã€‚ä¸º undefined æˆ– null å¹¶è¿”å›ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">thy-avatar</span></span><br><span class="hljs-tag">      <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;styx-body-title-doc-avatar&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">thyShowName</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">      [<span class="hljs-attr">thySize</span>]=<span class="hljs-string">&quot;24&quot;</span></span><br><span class="hljs-tag">      [<span class="hljs-attr">thyName</span>]=<span class="hljs-string">&quot;detailInfo?.created_by?.display_name&quot;</span></span><br><span class="hljs-tag">      [<span class="hljs-attr">thySrc</span>]=<span class="hljs-string">&quot;detailInfo?.created_by?.avatar&quot;</span></span><br><span class="hljs-tag">      [<span class="hljs-attr">thyDisabled</span>]=<span class="hljs-string">&quot;detailInfo?.created_by?.uid | isDisabledMember&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">thy-avatar</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="7"><li>å‚æ•°é»˜è®¤å€¼</li></ol><p>ç»™å‡½æ•°å‚æ•°è®¾ç½®é»˜è®¤å€¼æœ‰æ—¶ä¼šå¾ˆæ–¹ä¾¿ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Pipe</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;taskStateClass&#x27;</span> &#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskStateClassPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-title">transform</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: <span class="hljs-built_in">number</span>, prefix = <span class="hljs-string">&#x27;wtf-&#x27;</span></span>)</span> &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">type</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">const</span> stateConstantMap = helpers.keyBy(stateConstant, <span class="hljs-string">&#x27;value&#x27;</span>);<br>        <span class="hljs-keyword">const</span> state = stateConstantMap[<span class="hljs-keyword">type</span>];<br>        <span class="hljs-keyword">let</span> className = state ? state.className : <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">if</span> (prefix) &#123;<br>            className = prefix + className;<br>        &#125;<br>        <span class="hljs-keyword">return</span> className;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="8"><li>å·§å¦™çš„ä½¿ç”¨ç»“æ„èµ‹å€¼å¯ä»¥é¿å…ä½¿ç”¨ any ç±»å‹</li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-title">onViewFilter</span>(<span class="hljs-params">$event: &#123; config: MissionViewFilterConfigurationInfo; originConfig: MissionViewFilterConfigurationInfo &#125;</span>)</span> &#123;<br>        <span class="hljs-keyword">if</span> ($event.config.date_unit !== $event.originConfig.date_unit) &#123;<br>            <span class="hljs-built_in">this</span>.initDateRangeValue($event.config.date_unit);<br>            <span class="hljs-built_in">this</span>.setDateRange();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><ol start="9"><li>padStartæ–¹æ³•è¡¥0</li></ol><p>getDate()ã€getMonth() ç­‰apiè·å–æ—¥æœŸçš„å€¼å¯èƒ½åªæœ‰ä¸€ä½ï¼Œå¸¸è§çš„éœ€æ±‚æ˜¯æ ¼å¼åŒ–æˆä¸¤ä½æ•°å­—</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getDate(); <span class="hljs-comment">// 21</span><br><br><span class="hljs-keyword">const</span> month = <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getMonth()&#125;</span>`</span>.padStart(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>) <span class="hljs-comment">// 08</span><br></code></pre></td></tr></table></figure><ol start="10"><li>å­—ç¬¦ä¸²è½¬numberç±»å‹å¿«æ·æ–¹æ³•</li></ol><p>ä¸€å…ƒçš„ + å·è¿ç®—ç¬¦ç›¸å½“äº Number() æ–¹æ³•ã€‚</p><p>å…ˆæ¥å›é¡¾ä¸€ä¸‹ JavaScript ä¸­çš„åŸå§‹å€¼éƒ½æœ‰å“ªäº›ï¼š</p><p>JavaScript ä¸­çš„åŸå§‹å€¼æ˜¯æŒ‡æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€nullå’Œundefinedã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">const</span> a = +<span class="hljs-string">&#x27;3&#x27;</span>; <span class="hljs-comment">// 3</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js">+ <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// NaN</span><br> <br>+ <span class="hljs-literal">null</span>; <span class="hljs-comment">// 0</span><br> <br>+ <span class="hljs-literal">true</span>; <span class="hljs-comment">// 1</span><br>+ <span class="hljs-literal">false</span>; <span class="hljs-comment">// 0</span><br> <br>+ <span class="hljs-string">&#x27;1&#x27;</span>; <span class="hljs-comment">// 1</span><br>+ <span class="hljs-string">&#x27;-1&#x27;</span>; <span class="hljs-comment">// -1</span><br>+ <span class="hljs-string">&#x27;a1&#x27;</span>; <span class="hljs-comment">// NaN</span><br><br><span class="hljs-comment">// Objectç±»å‹çš„å€¼çš„è½¬æ¢ï¼š</span><br><br>+ <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() <span class="hljs-comment">// 1663912235982</span><br>+ &#123;&#125;; <span class="hljs-comment">// =&gt; NaN</span><br>+ &#123; <span class="hljs-attr">valueOf</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> &#125; &#125;; <span class="hljs-comment">// =&gt; 0</span><br>+ &#123;<br>    <span class="hljs-attr">a</span>: <span class="hljs-function">() =&gt;</span> &#123;&#125;,<br>    <span class="hljs-attr">valueOf</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.a;<br>    &#125;,<br>    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Apply the following steps:<br>1.Let primValue be ToPrimitive(input argument, hint Number).<br>2.Return ToNumber(primValue).</p><p>ToPrimitiveä¼šè°ƒç”¨ [[DefaultValue]]å†…éƒ¨æ–¹æ³•</p><p>1.Let valueOf be the result of calling the [[Get]] internal method of object O with argument â€œvalueOfâ€.<br>2.If IsCallable(valueOf) is true then,<br>a.Let val be the result of calling the [[Call]] internal method of valueOf, with O as the this value and an empty argument list.<br>b.If val is a primitive value, return val.</p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼šå¦‚æœä¼ å…¥çš„å€¼æ˜¯ object ç±»å‹çš„è¯ï¼Œä¼šå…ˆè°ƒç”¨ Object.valueOf() å‡½æ•°ï¼Œå¦‚æœå…¶è¿”å›å€¼å±äºåŸå§‹å€¼ç±»å‹ï¼Œé‚£ä¹ˆå°±ç»§ç»­è°ƒç”¨Number() å‡½æ•°ï¼Œå¦åˆ™ä¼šå»è°ƒç”¨ Object.toString() å‡½æ•°ï¼Œè¾“å…¥å…¶è¿”å›å€¼ã€‚</p><h3 id="rxjsç¯‡-ğŸ‡">rxjsç¯‡ ğŸ‡</h3><ol><li>ä½¿ç”¨takeUntilå–æ¶ˆè®¢é˜…</li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript">destroy$: Subject&lt;<span class="hljs-built_in">any</span>&gt; = <span class="hljs-keyword">new</span> Subject&lt;<span class="hljs-built_in">any</span>&gt;();<br><span class="hljs-function"><span class="hljs-title">ngOnInit</span>(<span class="hljs-params"></span>)</span> &#123;<br>  request.pipe(takeUntil(<span class="hljs-built_in">this</span>.destroy$)).subscribe();<br>  request.pipe(takeUntil(<span class="hljs-built_in">this</span>.destroy$)).subscribe();<br>  request.pipe(takeUntil(<span class="hljs-built_in">this</span>.destroy$)).subscribe();<br>&#125;<br><span class="hljs-function"><span class="hljs-title">ngOnDestroy</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-built_in">this</span>.destroy$.next(<span class="hljs-literal">null</span>);<br>  <span class="hljs-built_in">this</span>.destroy$.complete();<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰©å±•ï¼šå…¶å®ƒæ‰¹é‡å–æ¶ˆè®¢é˜…çš„æ–¹å¼</p><ul><li>SubscriptionLike</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript">subscriptions: SubscriptionLike[] = [];<br><span class="hljs-function"><span class="hljs-title">ngOnInit</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-built_in">this</span>.subscriptions.push(request.subscribe(...));<br>  <span class="hljs-built_in">this</span>.subscriptions.push(request.subscribe(...));<br>  <span class="hljs-built_in">this</span>.subscriptions.push(request.subscribe(...));<br>&#125;<br><span class="hljs-function"><span class="hljs-title">ngOnDestroy</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-built_in">this</span>.subscriptions.forEach(<br>    <span class="hljs-function">(<span class="hljs-params">subscription</span>) =&gt;</span> subscription.unsubscribe());<br>&#125;<br></code></pre></td></tr></table></figure><p>å…³äº SubscriptionLike ç±»å‹ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> SubscriptionLike <span class="hljs-keyword">extends</span> Unsubscribable &#123;<br>  get closed: <span class="hljs-built_in">boolean</span><br>  unsubscribe(): <span class="hljs-built_in">void</span><br><br>  <span class="hljs-comment">// inherited from index/Unsubscribable</span><br>  unsubscribe(): <span class="hljs-built_in">void</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶å®ç°ç±»ï¼š</p><p>Subjectã€BehaviorSubjectã€ReplySubjectã€AsyncSubjectã€Subscriptionã€Subscriber</p><ul><li>Subscription</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript">subscriptions: Subscription = <span class="hljs-keyword">new</span> Subscription();<br><span class="hljs-function"><span class="hljs-title">ngOnInit</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-built_in">this</span>.subscriptions.add(request.subscribe(...));<br>  <span class="hljs-built_in">this</span>.subscriptions.add(request.subscribe(...));<br>  <span class="hljs-built_in">this</span>.subscriptions.add(request.subscribe(...));<br>&#125;<br><span class="hljs-function"><span class="hljs-title">ngOnDestroy</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-built_in">this</span>.subscriptions.unsubscribe();<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>forkJoinè¿æ¥å¤šä¸ªè¯·æ±‚</li></ol><p>å½“æœ‰ä¸€ç»„ observablesï¼Œä½†ä½ åªå…³å¿ƒæ¯ä¸ª observable æœ€åå‘å‡ºçš„å€¼æ—¶ï¼Œæ­¤æ“ä½œç¬¦æ˜¯æœ€é€‚åˆçš„ã€‚æ­¤æ“ä½œç¬¦çš„ä¸€ä¸ªå¸¸è§ç”¨ä¾‹æ˜¯åœ¨é¡µé¢åŠ è½½(æˆ–å…¶ä»–äº‹ä»¶)æ—¶ä½ å¸Œæœ›å‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œå¹¶åœ¨æ‰€æœ‰è¯·æ±‚éƒ½å“åº”åå†é‡‡å–è¡ŒåŠ¨ã€‚</p><ol start="3"><li>distinctUntilChangedå»é™¤é‡å¤æ•°æ®</li></ol><p>åªæœ‰å½“å½“å‰å€¼ä¸ä¹‹å‰æœ€åä¸€ä¸ªå€¼ä¸åŒæ—¶æ‰ä¼šå‘å‡ºã€‚distinctUntilChanged é»˜è®¤ä½¿ç”¨ === è¿›è¡Œæ¯”è¾ƒ</p><ol start="4"><li>finalize/finally</li></ol><p>å½“Observableå®Œæˆæˆ–è€…æŠ¥é”™æ—¶è°ƒç”¨ã€‚</p><ol start="5"><li>switchMap</li></ol><p>å½“å‰ä¸€ä¸ªè®¢é˜…æœªå®Œæˆæ—¶ï¼Œåˆå‘å‡ºæ–°çš„è®¢é˜…ï¼Œåˆ™ä¼šå–æ¶ˆä¹‹å‰è®¢é˜…ã€‚</p><p>Demo------Typehead æœç´¢:</p><p>ç±»å‹å¤´æœç´¢æ˜¯ä¸€ç§é€šè¿‡æ–‡æœ¬é€æ­¥æœç´¢å’Œè¿‡æ»¤çš„æ–¹æ³•ã€‚å®ƒæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºè‡ªåŠ¨å®Œæˆï¼Œå¢é‡æœç´¢ï¼Œæœç´¢ä½œä¸ºä½ çš„ç±»å‹ï¼Œå†…è”æœç´¢ï¼Œå³æ—¶æœç´¢å’Œå­—è½®ã€‚</p><p><a href="https://www.how2js.site/2022/08/26/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8Rxjs%E7%9A%84Operators%E4%BC%98%E5%8C%96%E6%B6%88%E6%81%AF%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/">å…³äºç±»å‹å¤´æœç´¢ä¼˜åŒ–çš„demoä¹‹å‰æ–‡ç« æœ‰ä¸“é—¨å†™è¿‡</a></p><p><a href="https://www.how2js.site/2022/09/01/%E9%AB%98%E9%98%B6-RxJs-%E6%98%A0%E5%B0%84%E8%BF%90%E7%AE%97%E7%AC%A6%E7%BB%BC%E5%90%88%E6%8C%87%E5%8D%97%EF%BC%9AswitchMap%E3%80%81mergeMap%E3%80%81concatMap%EF%BC%88%E5%92%8C-excludeMap%EF%BC%89%E3%80%90%E8%AF%91%E3%80%91/#RxJs-switchMap-%E8%BF%90%E7%AE%97%E7%AC%A6">æ‰©å±•ï¼šconcatMapã€mergeMapã€switchMapå’ŒexhaustMapçš„ä½¿ç”¨åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯</a></p><h3 id="Angularè¯­æ³•ç¯‡-ğŸ‘¼">Angularè¯­æ³•ç¯‡ ğŸ‘¼</h3><ol><li>åˆç†ä½¿ç”¨ ngZone  runOutsideAngular æ¥æå‡åº”ç”¨æ€§èƒ½ æˆ‘ä»¬çŸ¥é“Angularå¯ä»¥è‡ªåŠ¨å¤„ç†å˜åŒ–æ£€æµ‹ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä½¿ç”¨äº†  zone.js ï¼Œç®€å•çš„æ¥è¯´ï¼Œ zone.js å°±æ˜¯é€šè¿‡æ‰“è¡¥ä¸çš„æ–¹å¼æ¥æ‹¦æˆªæµè§ˆå™¨çš„äº‹ä»¶ï¼Œç„¶åè¿›è¡Œå˜åŒ–æ£€æµ‹ï¼Œä½†æ˜¯å˜åŒ–æ£€æµ‹æ˜¯æå…¶æ¶ˆè€—èµ„æºçš„ï¼Œå¦‚æœç»‘å®šäº†å¤§é‡çš„äº‹ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆæ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨  runOutsideAngular æ¥å‡å°‘ä¸å¿…è¦çš„å˜åŒ–æ£€æµ‹ã€‚</li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-built_in">this</span>.ngZone.runOutsideAngular(<span class="hljs-function">() =&gt;</span> &#123;<br>   <span class="hljs-built_in">this</span>.renderer.listen(<span class="hljs-built_in">this</span>.elementRef.nativeElement, <span class="hljs-string">&#x27;keydown&#x27;</span>, <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> keyCode = event.which || event.keyCode;<br>         <span class="hljs-keyword">if</span> (keyCode === keycodes.ENTER) &#123;<br>              event.preventDefault();<br>              <span class="hljs-built_in">this</span>.ngZone.run(<span class="hljs-function">() =&gt;</span> &#123;<br>                  <span class="hljs-built_in">this</span>.thyEnter.emit(event);<br>              &#125;);<br>         &#125;<br>   &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><ol start="2"><li>@ViewChild è¯»å–æŒ‡å®šç±»å‹çš„å®ä¾‹</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> #<span class="hljs-attr">input</span> <span class="hljs-attr">thyInput</span>  [<span class="hljs-attr">thyAutofocus</span>]=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™è¡Œä»£ç æœ‰ä¸‰ä¸ªå®ä¾‹ ElementRef ã€ ThyInputComponent ã€ ThyAutoFocusDirective ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¦‚æœæˆ‘ä»¬è¦è·å–æŒ‡å®šç±»å‹çš„å®ä¾‹åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">&#x27;input&#x27;</span>, &#123; <span class="hljs-attr">read</span>:ThyInputComponent &#125;)  inputComponent : ThyInputComponent ;<br></code></pre></td></tr></table></figure><ol start="3"><li>åŠ¨æ€ç»‘å®šçš„æ ·å¼æˆ–è€…ç±»åå¦‚æœåªæœ‰ä¸€ä¸ªæ—¶å¯ä»¥ç®€å†™</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">thy-list-item</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">&quot;let item of context&quot;</span> [<span class="hljs-attr">class.active</span>]=<span class="hljs-string">&quot;item.isActive&quot;</span></span><br><span class="hljs-tag">    [<span class="hljs-attr">innerHTML</span>]=<span class="hljs-string">&quot;item.elementRef.nativeElement.innerHTML | bypassSecurityTrustHtml&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">thy-list-item</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="å…¶å®ƒ-ğŸ¢">å…¶å®ƒ ğŸ¢</h3><ol><li>å¦‚ä½•æµè§ˆå™¨ä¸­è°ƒè¯•å…ƒç´ çš„ hover æ ·å¼</li></ol><p><img src="/img/angularTips/css-debugger.jpeg" alt=""></p><ol start="2"><li>ä½¿ç”¨ git å‘½ä»¤çš„ git cherry-pick æŠŠä¸€ä¸ªåˆ†æ”¯çš„éƒ¨åˆ†commitåº”ç”¨åˆ°å…¶ä»–çš„åˆ†æ”¯ä¸Šã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">git cherry-pick commitHash<br><br>// è½¬ç§»å¤šä¸ªæäº¤<br><br>git cherry-pick hashA hashB<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rxjs</tag>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é«˜é˜¶ RxJs æ˜ å°„è¿ç®—ç¬¦ç»¼åˆæŒ‡å—ï¼šswitchMapã€mergeMapã€concatMapï¼ˆå’Œ excludeMapï¼‰ã€è¯‘ã€‘</title>
    <link href="/posts/3fb32397/"/>
    <url>/posts/3fb32397/</url>
    
    <content type="html"><![CDATA[<p><strong><a href="https://blog.angular-university.io/rxjs-higher-order-mapping/">åŸæ–‡: Comprehensive Guide to Higher-Order RxJs Mapping Operators: switchMap, mergeMap, concatMap (and exhaustMap)</a></strong></p><p>æˆ‘ä»¬æ¯å¤©å‘ç°çš„ä¸€äº›æœ€å¸¸ç”¨çš„ RxJs æ“ä½œç¬¦æ˜¯ RxJs é«˜é˜¶æ˜ å°„æ“ä½œç¬¦ï¼šswitchMapã€mergeMapã€concatMap å’Œ exhaustMapã€‚</p><span id="more"></span><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç¨‹åºä¸­çš„å¤§å¤šæ•°ç½‘ç»œè°ƒç”¨éƒ½å°†ä½¿ç”¨è¿™äº›è¿ç®—ç¬¦ä¹‹ä¸€æ¥å®Œæˆï¼Œå› æ­¤ç†Ÿæ‚‰å®ƒä»¬å¯¹äºç¼–å†™å‡ ä¹ä»»ä½•å“åº”å¼ç¨‹åºéƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><p>çŸ¥é“åœ¨ç»™å®šæƒ…å†µä¸‹ä½¿ç”¨å“ªä¸ªè¿ç®—ç¬¦ï¼ˆä»¥åŠä¸ºä»€ä¹ˆï¼‰å¯èƒ½ä¼šæœ‰ç‚¹ä»¤äººå›°æƒ‘ï¼Œæˆ‘ä»¬ç»å¸¸æƒ³çŸ¥é“è¿™äº›è¿ç®—ç¬¦æ˜¯å¦‚ä½•çœŸæ­£å·¥ä½œçš„ä»¥åŠä¸ºä»€ä¹ˆå®ƒä»¬è¢«è¿™æ ·å‘½åã€‚</p><p>è¿™äº›æ“ä½œç¬¦çœ‹èµ·æ¥ä¼¼ä¹æ— å…³ï¼Œä½†æˆ‘ä»¬çœŸçš„å¾ˆæƒ³ä¸€å£æ°”å­¦å®Œå®ƒä»¬ï¼Œå› ä¸ºé€‰æ‹©é”™è¯¯çš„æ“ä½œç¬¦å¯èƒ½ä¼šæ„å¤–åœ°å¯¼è‡´æˆ‘ä»¬çš„ç¨‹åºå‡ºç°ä¸€äº›å¾®å¦™çš„é—®é¢˜ã€‚</p><h2 id="ä¸ºä»€ä¹ˆæ˜ å°„æ“ä½œç¬¦æœ‰ç‚¹æ··ä¹±ï¼Ÿ">ä¸ºä»€ä¹ˆæ˜ å°„æ“ä½œç¬¦æœ‰ç‚¹æ··ä¹±ï¼Ÿ</h2><p>è¿™æ˜¯æœ‰åŸå› çš„ï¼šä¸ºäº†ç†è§£è¿™äº›æ“ä½œç¬¦ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£æ¯ä¸ªæ“ä½œç¬¦å†…éƒ¨ä½¿ç”¨çš„ Observable ç»„åˆç­–ç•¥ã€‚</p><p>ä¸å…¶è¯•å›¾ç†è§£ switchMap æœ¬èº«ï¼Œä¸å¦‚å…ˆäº†è§£ä»€ä¹ˆæ˜¯ Observable åˆ‡æ¢ï¼›æˆ‘ä»¬éœ€è¦å…ˆå­¦ä¹  Observable è¿æ¥ç­‰ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿›å…¥ concatMapã€‚</p><p>è¿™å°±æ˜¯æˆ‘ä»¬å°†åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ‰€åšçš„ï¼Œæˆ‘ä»¬å°†æŒ‰é€»è¾‘é¡ºåºå­¦ä¹  concatã€mergeã€switch å’Œexhaustç­–ç•¥åŠå…¶å¯¹åº”çš„æ˜ å°„è¿ç®—ç¬¦ï¼šconcatMapã€mergeMapã€switchMap å’Œ exhaustMapã€‚</p><p>æˆ‘ä»¬å°†ç»“åˆå¼¹ç å›¾å’Œä¸€äº›å®é™…ç¤ºä¾‹ï¼ˆåŒ…æ‹¬è¿è¡Œä»£ç ï¼‰æ¥è§£é‡Šè¿™äº›æ¦‚å¿µã€‚</p><p>æœ€åï¼Œæ‚¨å°†ç¡®åˆ‡åœ°çŸ¥é“è¿™äº›æ˜ å°„è¿ç®—ç¬¦ä¸­çš„æ¯ä¸€ä¸ªæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½•æ—¶ä½¿ç”¨å®ƒä»¬ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Œä»¥åŠå®ƒä»¬å‘½åçš„åŸå› ã€‚</p><h2 id="ç›®å½•">ç›®å½•</h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹ä¸»é¢˜:</p><ul><li>æ˜ å°„è¿ç®—ç¬¦</li><li>ä»€ä¹ˆæ˜¯é«˜é˜¶å¯è§‚æµ‹æ˜ å°„</li><li>å¯è§‚å¯Ÿåˆ°çš„è¿é”ååº”</li><li>RxJs concatMap æ“ä½œç¬¦</li><li>å¯è§‚å¯Ÿåˆ°çš„åˆå¹¶</li><li>RxJs mergeMap è¿ç®—ç¬¦</li><li>å¯è§‚å¯Ÿåˆ°çš„åˆ‡æ¢</li><li>RxJs switchMap è¿ç®—ç¬¦</li><li>Exhaust ç­–ç•¥</li><li>RxJs exhaust è¿ç®—ç¬¦</li><li>å¦‚ä½•é€‰æ‹©æ­£ç¡®çš„æ˜ å°„æ“ä½œç¬¦ï¼Ÿ</li><li>è¿è¡Œ GitHub repo (åŒ…å«ä»£ç ç¤ºä¾‹)</li><li>æ€»ç»“</li></ul><p>è¯·æ³¨æ„ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘ä»¬æ­£åœ¨è¿›è¡Œçš„ <a href="'https://blog.angular-university.io/tag/rxjs/'">RxJs ç³»åˆ—</a>çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œé—²è¯å°‘è¯´ï¼Œè®©æˆ‘ä»¬å¼€å§‹æˆ‘ä»¬çš„ RxJs æ˜ å°„è¿ç®—ç¬¦æ·±æ½œï¼</p><h2 id="Rxjsæ˜ å°„è¿ç®—ç¬¦">Rxjsæ˜ å°„è¿ç®—ç¬¦</h2><p>è®©æˆ‘ä»¬ä»å¤´å¼€å§‹ï¼Œä»‹ç»ä¸€ä¸‹è¿™äº›æ˜ å°„è¿ç®—ç¬¦çš„ä¸€èˆ¬ä½œç”¨ã€‚</p><p>æ­£å¦‚æ“ä½œç¬¦çš„åç§°æ‰€æš—ç¤ºçš„é‚£æ ·ï¼Œå®ƒä»¬æ­£åœ¨æ‰§è¡ŒæŸç§æ˜ å°„: ä½†ç©¶ç«Ÿæ˜ å°„çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿé¦–å…ˆè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ RxJs map æ“ä½œç¬¦çš„å¼¹ç å›¾:</p><p><img src="/img/rxjsMap/01-rxjs-map.png" alt=""></p><p>ä½¿ç”¨ map æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥è·å–ä¸€ä¸ªè¾“å…¥æµ(å€¼ä¸º1ã€2ã€3) ï¼Œå¹¶ä»ä¸­åˆ›å»ºä¸€ä¸ªæ´¾ç”Ÿçš„æ˜ å°„è¾“å‡ºæµ(å€¼ä¸º10ã€20ã€30)ã€‚</p><p>åº•éƒ¨çš„è¾“å‡ºæµçš„å€¼æ˜¯é€šè¿‡è·å–è¾“å…¥æµçš„å€¼å¹¶åº”ç”¨å®ƒä»¬å¾—åˆ°çš„ä¸€ä¸ªå‡½æ•°: è¿™ä¸ªå‡½æ•°åªæ˜¯å°†è¿™äº›å€¼ä¹˜ä»¥10ã€‚</p><p>å› æ­¤ï¼Œæ˜ å°„è¿ç®—ç¬¦å®Œå…¨æ˜¯å…³äºæ˜ å°„è¾“å…¥å¯è§‚æµ‹å€¼çš„ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒæ¥å¤„ç† HTTP è¯·æ±‚çš„ä¸€ä¸ªä¾‹å­:</p><figure class="highlight livescript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-keyword">const</span> http$ : Observable&lt;Course[]&gt; = <span class="hljs-built_in">this</span>.http.get(<span class="hljs-string">&#x27;/api/courses&#x27;</span>);<br><br>http$<br>    .pipe(<br>        tap(() =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;HTTP request executed&#x27;</span>)),<br>        <span class="hljs-keyword">map</span>(res =&gt; <span class="hljs-built_in">Object</span>.values(res[<span class="hljs-string">&#x27;payload&#x27;</span>]))<br>    )<br>    .subscribe(<br>        courses =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;courses&quot;</span>, courses)<br>    );<br><br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯è§‚å¯Ÿçš„ HTTP æ¥è¿›è¡Œåç«¯è°ƒç”¨ï¼Œå¹¶ä¸”æˆ‘ä»¬è®¢é˜…äº†å®ƒã€‚å¯è§‚å¯Ÿå¯¹è±¡å°†å‘å‡ºåç«¯ HTTP å“åº”çš„å€¼ï¼Œè¿™æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒHTTP å“åº”å°†æ•°æ®åŒ…è£…åœ¨ä¸€ä¸ªæœ‰æ•ˆè´Ÿè½½å±æ€§ä¸­ï¼Œå› æ­¤ä¸ºäº†è·å–æ•°æ®ï¼Œæˆ‘ä»¬åº”ç”¨äº† RxJs æ˜ å°„æ“ä½œç¬¦ã€‚ç„¶åæ˜ å°„å‡½æ•°å°†æ˜ å°„ JSON å“åº”æœ‰æ•ˆè´Ÿè½½å¹¶æå–æœ‰æ•ˆè´Ÿè½½å±æ€§çš„å€¼ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å·²ç»å›é¡¾äº†åŸºæœ¬æ˜ å°„æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œç°åœ¨è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹é«˜é˜¶æ˜ å°„ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯é«˜é˜¶å¯è§‚æµ‹æ˜ å°„ï¼Ÿ">ä»€ä¹ˆæ˜¯é«˜é˜¶å¯è§‚æµ‹æ˜ å°„ï¼Ÿ</h2><p>åœ¨é«˜é˜¶æ˜ å°„ä¸­ï¼Œæˆ‘ä»¬ä¸æ˜¯å°†ç±»ä¼¼1çš„æ™®é€šå€¼æ˜ å°„åˆ°ç±»ä¼¼10çš„å¦ä¸€ä¸ªå€¼ï¼Œè€Œæ˜¯å°†ä¸€ä¸ªå€¼æ˜ å°„åˆ°ä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡ï¼</p><p>ç»“æœæ˜¯ä¸€ä¸ªé«˜é˜¶çš„ Observableã€‚å®ƒåªæ˜¯ä¸€ä¸ªObservableï¼Œå’Œå…¶ä»–çš„ä¸€æ ·ï¼Œä½†å®ƒçš„å€¼æœ¬èº«ä¹Ÿæ˜¯ Observableï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«è®¢é˜…ã€‚</p><p>è¿™å¬èµ·æ¥å¯èƒ½æœ‰ç‚¹ç‰µå¼ºï¼Œä½†å®é™…ä¸Šï¼Œè¿™ç§ç±»å‹çš„æ˜ å°„ä¸€ç›´åœ¨å‘ç”Ÿã€‚è®©æˆ‘ä»¬ç»™å‡ºè¿™ç§æ˜ å°„çš„ä¸€ä¸ªå®é™…ä¾‹å­ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå“åº”å¼è¡¨å•ï¼Œå®ƒé€šè¿‡ä¸€ä¸ªObservable éšæ—¶é—´å‘å‡ºæœ‰æ•ˆçš„è¡¨å•å€¼:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Component(&#123;</span><br><span class="hljs-meta">    selector: <span class="hljs-meta-string">&#x27;course-dialog&#x27;</span>,</span><br><span class="hljs-meta">    templateUrl: <span class="hljs-meta-string">&#x27;./course-dialog.component.html&#x27;</span></span><br><span class="hljs-meta">&#125;)</span><br>export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseDialogComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">AfterViewInit</span> </span>&#123;<br><br>    form: FormGroup;<br>    course:Course;<br><br>    <span class="hljs-meta">@ViewChild(<span class="hljs-meta-string">&#x27;saveButton&#x27;</span>)</span> saveButton: ElementRef;<br><br>    <span class="hljs-keyword">constructor</span>(<br>        <span class="hljs-keyword">private</span> fb: FormBuilder,<br>        <span class="hljs-keyword">private</span> dialogRef: MatDialogRef&lt;CourseDialogComponent&gt;,<br>        <span class="hljs-meta">@Inject(MAT_DIALOG_DATA)</span> course:Course) &#123;<br><br>        <span class="hljs-keyword">this</span>.course = course;<br><br>        <span class="hljs-keyword">this</span>.form = fb.group(&#123;<br>            description: [course.description, <br>                          Validators.required],<br>            category: [course.category, Validators.required],<br>            releasedAt: [moment(), Validators.required],<br>            longDescription: [course.longDescription,<br>                              Validators.required]<br>        &#125;);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>Reactive Form æä¾›äº†ä¸€ä¸ªå¯è§‚å¯Ÿçš„å¯¹è±¡ this.Form.valueChangesï¼Œå®ƒåœ¨ç”¨æˆ·ä¸è¡¨å•äº¤äº’æ—¶å‘å‡ºæœ€æ–°çš„è¡¨å•å€¼ã€‚è¿™å°†æ˜¯æˆ‘ä»¬å¯è§‚å¯Ÿåˆ°çš„æºå¤´ã€‚</p><p>æˆ‘ä»¬æƒ³è¦åšçš„æ˜¯åœ¨è¿™äº›å€¼éšç€æ—¶é—´çš„æ¨ç§»å‘å‡ºæ—¶è‡³å°‘ä¿å­˜å…¶ä¸­çš„ä¸€äº›å€¼ï¼Œä»¥å®ç°è¡¨å•è‰æ¡ˆçš„é¢„ä¿å­˜ç‰¹æ€§ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·å¡«å†™è¡¨å•æ—¶ï¼Œæ•°æ®å°†é€æ­¥ä¿å­˜ï¼Œä»è€Œé¿å…ç”±äºæ„å¤–é‡æ–°åŠ è½½è€Œä¸¢å¤±æ•´ä¸ªè¡¨å•æ•°æ®ã€‚</p><h2 id="ä¸ºä»€ä¹ˆæ˜¯é«˜é˜¶å¯è§‚å¯Ÿå¯¹è±¡ï¼Ÿ">ä¸ºä»€ä¹ˆæ˜¯é«˜é˜¶å¯è§‚å¯Ÿå¯¹è±¡ï¼Ÿ</h2><p>ä¸ºäº†å®ç°è¡¨å•è‰æ¡ˆä¿å­˜åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦è·å–è¡¨å•å€¼ï¼Œç„¶ååˆ›å»ºç¬¬äºŒä¸ªå¯è§‚å¯Ÿçš„ HTTP å¯¹è±¡æ¥æ‰§è¡Œåç«¯ä¿å­˜ï¼Œç„¶åè®¢é˜…å®ƒã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°è¯•æ‰‹åŠ¨å®Œæˆæ‰€æœ‰è¿™äº›æ“ä½œï¼Œä½†è¿™æ ·æˆ‘ä»¬å°±ä¼šé™·å…¥åµŒå¥—çš„è®¢é˜…åæ¨¡å¼:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-built_in">this</span>.form.valueChanges<br>    .subscribe(<br>       <span class="hljs-function"><span class="hljs-params">formValue</span> =&gt;</span> &#123;<br>      <br>           <span class="hljs-keyword">const</span> httpPost$ = <br>                 <span class="hljs-built_in">this</span>.http.put(<span class="hljs-string">`/api/course/<span class="hljs-subst">$&#123;courseId&#125;</span>`</span>, formValue);<br><br>           httpPost$.subscribe(<br>               <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> ... handle successful save ...<br>               err =&gt; ... handle save error ...<br>           );<br><br>       &#125;        <br>    );<br><br></code></pre></td></tr></table></figure><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œè¿™å°†å¯¼è‡´æˆ‘ä»¬çš„ä»£ç å¾ˆå¿«åœ°åµŒå¥—åœ¨å¤šä¸ªçº§åˆ«ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨æœ€åˆä½¿ç”¨ RxJs æ—¶è¯•å›¾é¿å…çš„é—®é¢˜ä¹‹ä¸€ã€‚</p><blockquote><p>è®©æˆ‘ä»¬æŠŠè¿™ä¸ªæ–°çš„ httpPost$ Observable ç§°ä¸ºå†…éƒ¨å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨å†…éƒ¨åµŒå¥—ä»£ç å—ä¸­åˆ›å»ºçš„ã€‚</p></blockquote><h3 id="é¿å…åµŒå¥—è®¢é˜…">é¿å…åµŒå¥—è®¢é˜…</h3><p>æˆ‘ä»¬å¸Œæœ›ä»¥ä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹å¼å®Œæˆæ‰€æœ‰è¿™äº›è¿‡ç¨‹: æˆ‘ä»¬å¸Œæœ›è·å–è¡¨å•å€¼ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°ä¸€ä¸ªä¿å­˜çš„ Observableã€‚è¿™å°†æœ‰æ•ˆåœ°åˆ›å»ºä¸€ä¸ªæ›´é«˜é˜¶çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå…¶ä¸­æ¯ä¸ªå€¼å¯¹åº”ä¸€ä¸ªä¿å­˜è¯·æ±‚ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¸Œæœ›é€æ˜åœ°è®¢é˜…è¿™äº›ç½‘ç»œè§‚å¯Ÿæ•°æ®ï¼Œå¹¶ä¸”ä¸€æ¬¡æ€§ç›´æ¥æ¥æ”¶ç½‘ç»œå“åº”ï¼Œä»¥é¿å…ä»»ä½•åµŒå¥—ã€‚</p><p>å¦‚æœæˆ‘ä»¬æœ‰æŸç§æ›´é«˜é˜¶çš„ RxJs æ˜ å°„è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšåˆ°è¿™ä¸€åˆ‡ï¼é‚£ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å››ä¸ªä¸åŒçš„æ“ä½œå‘˜å‘¢ï¼Ÿ</p><p>ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œæƒ³è±¡ä¸€ä¸‹å¦‚æœ valueChanges è¿ç»­å‘å‡ºå¤šä¸ªè¡¨å•å€¼ï¼Œå¹¶ä¸”ä¿å­˜æ“ä½œéœ€è¦ä¸€äº›æ—¶é—´æ‰èƒ½å®Œæˆï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µ:</p><ul><li><p>æˆ‘ä»¬æ˜¯å¦åº”è¯¥ç­‰å¾…ä¸€ä¸ªä¿å­˜è¯·æ±‚å®Œæˆåå†è¿›è¡Œå¦ä¸€ä¸ªä¿å­˜ï¼Ÿ</p></li><li><p>æˆ‘ä»¬åº”è¯¥åŒæ—¶è¿›è¡Œå¤šæ¬¡ä¿å­˜å—ï¼Ÿ</p></li><li><p>æˆ‘ä»¬åº”è¯¥å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä¿å­˜ï¼Œé‡æ–°å¼€å§‹ä¸€ä¸ªæ–°çš„å—ï¼Ÿ</p></li><li><p>å¦‚æœå…¶ä¸­ä¸€ä¸ªå·²ç»åœ¨è¿›è¡Œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¿½ç•¥æ–°çš„ä¿å­˜å°è¯•å—ï¼Ÿ</p></li></ul><p>åœ¨ç ”ç©¶è¿™äº›ç”¨ä¾‹ä¸­çš„æ¯ä¸€ä¸ªä¹‹å‰ï¼Œè®©æˆ‘ä»¬å›åˆ°ä¸Šé¢çš„åµŒå¥—è®¢é˜…ä»£ç ã€‚</p><p>åœ¨åµŒå¥—è®¢é˜…ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯å¹¶è¡Œåœ°è§¦å‘ä¿å­˜æ“ä½œï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºä¸èƒ½å¼ºæœ‰åŠ›åœ°ä¿è¯åç«¯å°†æŒ‰é¡ºåºå¤„ç†ä¿å­˜æ“ä½œï¼Œå¹¶ä¸”æœ€åä¸€ä¸ªæœ‰æ•ˆçš„è¡¨å•å€¼ç¡®å®æ˜¯å­˜å‚¨åœ¨åç«¯ä¸Šçš„è¡¨å•å€¼ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç¡®ä¿åªæœ‰åœ¨å‰ä¸€æ¬¡ä¿å­˜å®Œæˆåæ‰æ‰§è¡Œä¿å­˜è¯·æ±‚ã€‚</p><h3 id="ç†è§£-Observable-concat">ç†è§£ Observable concat()</h3><p>ä¸ºäº†å®ç°é¡ºåºä¿å­˜ï¼Œæˆ‘ä»¬å°†å¼•å…¥å¯è§‚å¯Ÿå¯¹è±¡è¿æ¥çš„æ–°æ¦‚å¿µã€‚åœ¨è¿™ä¸ªä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ concat () RxJs å‡½æ•°å°†ä¸¤ä¸ªå¯è§‚å¯Ÿå¯¹è±¡è¿æ¥èµ·æ¥:</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gams"><br>const series1<span class="hljs-symbol">$</span> = of(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>);<br><br>const series2<span class="hljs-symbol">$</span> = of(<span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;y&#x27;</span>);<br><br>const result<span class="hljs-symbol">$</span> = concat(series1<span class="hljs-symbol">$</span>, series2<span class="hljs-symbol">$</span>);<br><br>result<span class="hljs-symbol">$</span>.subscribe(console.<span class="hljs-built_in">log</span>);<br><br></code></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨ of åˆ›å»ºå‡½æ•°åˆ›å»ºäº†ä¸¤ä¸ª Observables series1$ å’Œ series2$ ä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ç¬¬ä¸‰ä¸ª result$ Observableï¼Œå®ƒæ˜¯ä¸²è” series1$ å’Œ series2$ çš„ç»“æœã€‚</p><p>ä¸‹é¢æ˜¯è¿™ä¸ªç¨‹åºçš„æ§åˆ¶å°è¾“å‡ºï¼Œæ˜¾ç¤ºäº†ç»“æœ Observable å‘å‡ºçš„å€¼:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><br><span class="hljs-selector-tag">a</span><br><span class="hljs-selector-tag">b</span><br>x<br>y<br><br></code></pre></td></tr></table></figure><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œè¿™äº›å€¼æ˜¯å°† series1$ çš„å€¼ä¸ series2$ è¿æ¥åœ¨ä¸€èµ·çš„ç»“æœã€‚ä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜: è¿™åªæœ‰åœ¨è¿™äº›å¯è§‚æµ‹æ•°æ®å®Œæˆçš„æƒ…å†µä¸‹æ‰æœ‰æ•ˆ! ï¼</p><p>ofå‡½æ•°çš„ä½œç”¨æ˜¯: åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„å¯¹è±¡ï¼Œå‘å‡ºä¼ é€’ç»™of()çš„å€¼ï¼Œç„¶ååœ¨å‘å‡ºæ‰€æœ‰å€¼ä¹‹åå®Œæˆ Observableã€‚</p><h3 id="Observable-concat-çš„å¼¹ç å›¾">Observable concat çš„å¼¹ç å›¾</h3><p>ä¸ºäº†çœŸæ­£ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦çœ‹çœ‹ Observable concat çš„å¼¹ç å›¾:</p><p><img src="/img/rxjsMap/01-rxjs-concat.png" alt=""></p><p>ä½ æ³¨æ„åˆ°ç¬¬ä¸€ä¸ªå¯è§‚å¯Ÿå€¼ b åé¢çš„ç«–æ¡äº†å—ï¼Ÿè¿™æ ‡å¿—ç€ç¬¬ä¸€ä¸ªå€¼ä¸º a å’Œ b (series1$)çš„å¯è§‚å¯Ÿå¯¹è±¡å®Œæˆçš„æ—¶é—´ç‚¹ã€‚</p><p>è®©æˆ‘ä»¬æŒ‰ç…§æ—¶é—´çº¿ä¸€æ­¥ä¸€æ­¥æ¥åˆ†æè¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆ:</p><ul><li><p>ä¸¤ä¸ªå¯è§‚å¯Ÿå¯¹è±¡ series1$ å’Œ series2$ è¢«ä¼ å…¥ concat() å‡½æ•°</p></li><li><p>ç„¶å concat ()å°†è®¢é˜…ç¬¬ä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡ series1$ï¼Œä½†ä¸è®¢é˜…ç¬¬äºŒä¸ªå¯è§‚å¯Ÿå¯¹è±¡ series2$(è¿™å¯¹äºç†è§£è¿æ¥éå¸¸å…³é”®)</p></li><li><p>series1$ å‘å‡ºå€¼ aï¼Œè¯¥å€¼ç«‹å³åæ˜ åœ¨è¾“å‡º result$ Observable ä¸­</p></li><li><p>series2$ Observable è¿˜æ²¡æœ‰å‘å‡ºå€¼ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æœ‰è¢«è®¢é˜…</p></li><li><p>ç„¶å series1$ å°†å‘å‡º b å€¼ï¼Œè¯¥å€¼å°†åæ˜ åœ¨è¾“å‡ºä¸­</p></li><li><p>ç„¶åï¼Œseries1$ å°†å®Œæˆï¼Œå¹¶ä¸”åªæœ‰åœ¨å®Œæˆä¹‹åï¼Œconcat() æ‰ä¼šè®¢é˜… series2$</p></li><li><p>ç„¶åï¼Œseries2$ å€¼å°†å¼€å§‹åæ˜ åœ¨è¾“å‡ºä¸­ï¼Œç›´åˆ° ç„¶åï¼Œseries2$ å®Œæˆ</p></li><li><p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥å‘ concat() ä¼ é€’ä»»æ„å¤šçš„å¯è§‚æµ‹æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯åƒæœ¬ä¾‹ä¸­è¿™æ ·çš„ä¸¤ä¸ª</p></li></ul><h3 id="å…³äºObservable-concat-çš„å…³é”®ç‚¹">å…³äºObservable concat çš„å…³é”®ç‚¹</h3><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼ŒObservable è¿æ¥å°±æ˜¯å…³äº Observable çš„å®Œæˆï¼ˆcomplete)ï¼ æˆ‘ä»¬å–ç¬¬ä¸€ä¸ª Observable å¹¶ä½¿ç”¨å®ƒçš„å€¼ï¼Œç­‰å¾…å®ƒå®Œæˆï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ä¸‹ä¸€ä¸ª Observableï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰ Observable å®Œæˆã€‚</p><p>å›åˆ°æˆ‘ä»¬çš„é«˜é˜¶ Observable æ˜ å°„ç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸²è”çš„æ¦‚å¿µå¦‚ä½•å¸®åŠ©æˆ‘ä»¬ã€‚</p><h3 id="ä½¿ç”¨-Observable-çš„è¿æ¥å®ç°é¡ºåºä¿å­˜">ä½¿ç”¨ Observable çš„è¿æ¥å®ç°é¡ºåºä¿å­˜</h3><p>æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„è¡¨å•å€¼æŒ‰é¡ºåºä¿å­˜ï¼Œæˆ‘ä»¬éœ€è¦è·å–æ¯ä¸ªè¡¨å•å€¼å¹¶å°†å…¶æ˜ å°„åˆ° httpPost$ Observableã€‚</p><p>ç„¶åæˆ‘ä»¬éœ€è¦è®¢é˜…å®ƒï¼Œä½†æˆ‘ä»¬å¸Œæœ›åœ¨è®¢é˜…ä¸‹ä¸€ä¸ª httpPost$ Observable ä¹‹å‰å®Œæˆä¿å­˜ã€‚</p><p>ç„¶åæˆ‘ä»¬å°†è®¢é˜…æ¯ä¸ª httpPost$ å¹¶æŒ‰é¡ºåºå¤„ç†æ¯ä¸ªè¯·æ±‚çš„ç»“æœã€‚ æœ€åï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ä¸ªæ··åˆäº†ä»¥ä¸‹å†…å®¹çš„è¿ç®—ç¬¦ï¼š</p><ul><li><p>ä¸€ä¸ªé«˜é˜¶æ˜ å°„æ“ä½œï¼ˆè·å–è¡¨å•å€¼å¹¶å°†å…¶è½¬æ¢ä¸º httpPost$ Observableï¼‰</p></li><li><p>ä½¿ç”¨ concat() æ“ä½œï¼Œå°†å¤šä¸ª httpPost$ Observables è¿æ¥åœ¨ä¸€èµ·ä»¥ç¡®ä¿åœ¨å‰ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„ä¿å­˜é¦–å…ˆå®Œæˆä¹‹å‰ä¸ä¼šè¿›è¡Œä¸‹ä¸€ä¸ª HTTP ä¿å­˜ã€‚</p></li></ul><h3 id="RxJs-concatMap-æ“ä½œç¬¦">RxJs concatMap æ“ä½œç¬¦</h3><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-built_in">this</span>.form.valueChanges<br>    .pipe(<br>        concatMap(<span class="hljs-function"><span class="hljs-params">formValue</span> =&gt;</span> <span class="hljs-built_in">this</span>.http.put(<span class="hljs-string">`/api/course/<span class="hljs-subst">$&#123;courseId&#125;</span>`</span>, <br>                                             formValue))<br>    )<br>    .subscribe(<br>       <span class="hljs-function"><span class="hljs-params">saveResult</span> =&gt;</span>  ... handle successful save ...,<br>        <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> ... handle save error ...      <br>    );<br></code></pre></td></tr></table></figure><p>æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä½¿ç”¨åƒ concatMap è¿™æ ·çš„é«˜é˜¶æ˜ å°„è¿ç®—ç¬¦çš„ç¬¬ä¸€ä¸ªå¥½å¤„æ˜¯ç°åœ¨æˆ‘ä»¬ä¸å†æœ‰åµŒå¥—è®¢é˜…ã€‚</p><p>é€šè¿‡ä½¿ç”¨ concatMapï¼Œç°åœ¨æ‰€æœ‰è¡¨å•å€¼éƒ½å°†æŒ‰é¡ºåºå‘é€åˆ°åç«¯ï¼Œå¦‚ Chrome DevTools Network é€‰é¡¹å¡ä¸­æ‰€ç¤ºï¼š</p><p><img src="/img/rxjsMap/03-rxjs-concat-example.png" alt=""></p><h3 id="åˆ†è§£-concatMap-ç½‘ç»œæ—¥å¿—å›¾">åˆ†è§£ concatMap ç½‘ç»œæ—¥å¿—å›¾</h3><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œä¸€ä¸ªä¿å­˜ HTTP è¯·æ±‚åªæœ‰åœ¨å‰ä¸€æ¬¡ä¿å­˜å®Œæˆåæ‰ä¼šå¯åŠ¨ã€‚ä»¥ä¸‹æ˜¯ concatMap æ“ä½œç¬¦å¦‚ä½•ç¡®ä¿è¯·æ±‚å§‹ç»ˆæŒ‰é¡ºåºå‘ç”Ÿ:</p><ul><li><p>concatMap æ­£åœ¨è·å–æ¯ä¸ªè¡¨å•å€¼å¹¶å°†å…¶è½¬æ¢ä¸ºä¿å­˜çš„ HTTP Observableï¼Œç§°ä¸ºå†…éƒ¨ Observable</p></li><li><p>concatMap ç„¶åè®¢é˜…å†…éƒ¨ Observable å¹¶å°†å…¶è¾“å‡ºå‘é€åˆ°ç»“æœ Observable</p></li><li><p>ç¬¬äºŒä¸ªè¡¨å•å€¼å¯èƒ½æ¯”åœ¨åç«¯ä¿å­˜å‰ä¸€ä¸ªè¡¨å•å€¼æ›´å¿«</p></li><li><p>å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ–°çš„è¡¨å•å€¼å°†ä¸ä¼šç«‹å³æ˜ å°„åˆ° HTTP è¯·æ±‚</p></li><li><p>ç›¸åï¼Œ concatMap å°†ç­‰å¾…å…ˆå‰çš„ HTTP Observable å®Œæˆï¼Œç„¶åå°†æ–°å€¼æ˜ å°„åˆ° HTTP Observableï¼Œè®¢é˜…å®ƒå¹¶å› æ­¤è§¦å‘ä¸‹ä¸€æ¬¡ä¿å­˜</p></li></ul><p>æ³¨æ„ï¼Œè¿™é‡Œçš„ä»£ç åªæ˜¯ä¿å­˜è¡¨å•è‰ç¨¿å€¼çš„å®ç°çš„åŸºç¡€ã€‚æ‚¨å¯ä»¥å°†å®ƒä¸å…¶ä»–æ“ä½œç¬¦ç»„åˆèµ·æ¥ï¼Œä¾‹å¦‚ï¼Œåªä¿å­˜æœ‰æ•ˆçš„è¡¨å•å€¼ï¼Œå¹¶ä½¿ç”¨é˜²æŠ–ã€èŠ‚æµæ“ä½œï¼Œä»¥ç¡®ä¿å®ƒä»¬ä¸ä¼šå¤ªé¢‘ç¹åœ°å‘ç”Ÿã€‚</p><h3 id="å¯è§‚å¯Ÿå¯¹è±¡çš„åˆå¹¶ï¼ˆmergeï¼‰">å¯è§‚å¯Ÿå¯¹è±¡çš„åˆå¹¶ï¼ˆmergeï¼‰</h3><p>å°† Observable ä¸²è”åº”ç”¨äºä¸€ç³»åˆ— HTTP ä¿å­˜æ“ä½œä¼¼ä¹æ˜¯ç¡®ä¿ä¿å­˜æŒ‰é¢„æœŸé¡ºåºå‘ç”Ÿçš„å¥½æ–¹æ³•ã€‚</p><p>ä½†æ˜¯åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å¹¶è¡Œè¿è¡Œï¼Œè€Œä¸éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªå†…éƒ¨ Observable å®Œæˆã€‚</p><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬æœ‰åˆå¹¶ Observable ç»„åˆç­–ç•¥ï¼ ä¸ concat ä¸åŒï¼Œmerge ä¸ä¼šåœ¨è®¢é˜…ä¸‹ä¸€ä¸ª Observable ä¹‹å‰ç­‰å¾… Observable å®Œæˆã€‚</p><p>ç›¸åï¼Œmerge åŒæ—¶è®¢é˜…æ¯ä¸ªåˆå¹¶çš„ Observableï¼Œç„¶åéšç€å¤šä¸ªå€¼éšç€æ—¶é—´çš„æ¨ç§»åˆ°è¾¾ï¼Œå®ƒå°†æ¯ä¸ªæº Observable çš„å€¼è¾“å‡ºåˆ°ç»„åˆç»“æœ Observableã€‚</p><h3 id="merge-æ“ä½œçš„å®é™…ä¾‹å­">merge æ“ä½œçš„å®é™…ä¾‹å­</h3><p>ä¸ºäº†æ¸…æ¥šåœ°è¡¨æ˜ merge ä¸ä¾èµ–äº observable çš„å®Œæˆï¼ˆcompleteï¼‰ï¼Œè®©æˆ‘ä»¬åˆå¹¶ä¸¤ä¸ªæ°¸è¿œä¸ä¼šå®Œæˆçš„å¯è§‚æµ‹æ•°æ®ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ interval Observables:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">const</span> series<span class="hljs-number">1</span>$ = interval(<span class="hljs-number">1000</span>).pipe(map(val =&gt; val*<span class="hljs-number">10</span>));<br><br><span class="hljs-attribute">const</span> series<span class="hljs-number">2</span>$ = interval(<span class="hljs-number">1000</span>).pipe(map(val =&gt; val*<span class="hljs-number">100</span>));<br><br><span class="hljs-attribute">const</span> result$ = merge(series<span class="hljs-number">1</span>$, series<span class="hljs-number">2</span>$);<br><br><span class="hljs-attribute">result</span>$.subscribe(console.log);<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ interval() åˆ›å»ºçš„ Observable å°†æ¯éš”ä¸€ç§’å‘å‡ºå€¼ 0ã€1ã€2 ç­‰ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šå®Œæˆã€‚</p><p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯¹è¿™äº›åŒºé—´ Observable åº”ç”¨äº†å‡ ä¸ª map è¿ç®—ç¬¦ï¼Œåªæ˜¯ä¸ºäº†æ›´å®¹æ˜“åœ¨æ§åˆ¶å°è¾“å‡ºä¸­åŒºåˆ†å®ƒä»¬ã€‚</p><p>ä»¥ä¸‹æ˜¯æ§åˆ¶å°ä¸­å¯è§çš„å‰å‡ ä¸ªå€¼ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs">0<br>0<br>10<br>100<br>20<br>200<br>30<br>300<br></code></pre></td></tr></table></figure><h3 id="Merging-and-Observable-Completion">Merging and Observable Completion</h3><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œåˆå¹¶çš„æºå¯è§‚æµ‹æ•°æ®çš„å€¼åœ¨å‘å‡ºæ—¶ç«‹å³æ˜¾ç¤ºåœ¨å¯è§‚æµ‹ç»“æœä¸­ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªåˆå¹¶çš„å¯è§‚æµ‹æ•°æ®å®Œæˆï¼Œé‚£ä¹ˆå½“å…¶ä»–å¯è§‚æµ‹æ•°æ®éšç€æ—¶é—´çš„æ¨ç§»åˆ°è¾¾æ—¶ï¼Œmerge å°†ç»§ç»­å‘å‡ºå®ƒä»¬çš„å€¼ã€‚</p><h3 id="Observable-merge-çš„å¼¹ç å›¾">Observable merge çš„å¼¹ç å›¾</h3><p><img src="/img/rxjsMap/04-rxjs-merge.png" alt=""></p><p>æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œåˆå¹¶çš„æº Observables çš„å€¼ç«‹å³æ˜¾ç¤ºåœ¨è¾“å‡ºä¸­ã€‚ ç›´åˆ°æ‰€æœ‰åˆå¹¶çš„ Observable å®Œæˆåï¼Œç»“æœ Observable æ‰ä¼šå®Œæˆã€‚</p><p>ç°åœ¨æˆ‘ä»¬äº†è§£äº†åˆå¹¶ç­–ç•¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒå¦‚ä½•åœ¨é«˜é˜¶ Observable æ˜ å°„çš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚</p><h3 id="RxJs-mergeMap-è¿ç®—ç¬¦">RxJs mergeMap è¿ç®—ç¬¦</h3><p>å¦‚æœæˆ‘ä»¬å°† merge ç­–ç•¥ä¸é«˜é˜¶å¯è§‚æµ‹æ˜ å°„çš„æ¦‚å¿µç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº† RxJs mergeMap æ“ä½œç¬¦ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæ“ä½œç¬¦çš„å¼¹ç å›¾:</p><p><img src="/img/rxjsMap/04-rxjs-mergeMap-2.png" alt=""></p><p>ä¸‹é¢æ˜¯ mergeMap æ“ä½œç¬¦çš„å·¥ä½œåŸç†:</p><ul><li><p>ä¸ concatMap çš„æƒ…å†µä¸€æ ·ï¼Œæºå¯è§‚æµ‹çš„æ¯ä¸ªå€¼ä»ç„¶è¢«æ˜ å°„åˆ°å†…éƒ¨çš„å¯è§‚æµ‹å€¼ä¸­</p></li><li><p>ä¸ concatMap ä¸€æ ·ï¼Œè¿™ä¸ªå†…éƒ¨è§‚å¯Ÿå¯¹è±¡ä¹Ÿæ˜¯ç”± mergeMap è®¢é˜…çš„</p></li><li><p>å½“å†…éƒ¨è§‚å¯Ÿå€¼å‘å‡ºæ–°å€¼æ—¶ï¼Œå®ƒä»¬ä¼šç«‹å³åæ˜ åœ¨è¾“å‡ºè§‚å¯Ÿå€¼ä¸­</p></li><li><p>ä½†æ˜¯ä¸ concatMap ä¸åŒçš„æ˜¯ï¼Œåœ¨ mergeMap çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¿…ç­‰å¾…å…ˆå‰çš„å†…éƒ¨å¯è§‚æµ‹å€¼å®Œæˆï¼Œç„¶åå†è§¦å‘ä¸‹ä¸€ä¸ªå†…éƒ¨å¯è§‚æµ‹å€¼</p></li><li><p>è¿™æ„å‘³ç€ä½¿ç”¨ mergeMap (ä¸ concatMap ä¸åŒ) ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¤šä¸ªå†…éƒ¨å¯è§‚æµ‹æ•°æ®éšæ—¶é—´é‡å ï¼Œå¹¶è¡Œå‘å‡ºå€¼ï¼Œå°±åƒæˆ‘ä»¬åœ¨å›¾ç‰‡ä¸­çœ‹åˆ°çš„ç”¨çº¢è‰²çªå‡ºæ˜¾ç¤ºçš„é‚£æ ·</p></li></ul><h3 id="æ£€æŸ¥-mergeMap-ç½‘ç»œæ—¥å¿—">æ£€æŸ¥ mergeMap ç½‘ç»œæ—¥å¿—</h3><p>å›åˆ°æˆ‘ä»¬ä¹‹å‰çš„è¡¨å•è‰æ¡ˆä¿å­˜ç¤ºä¾‹ï¼Œå¾ˆæ˜æ˜¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ concatMapï¼Œè€Œä¸æ˜¯ mergeMapï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›ä¿å­˜å¹¶è¡Œå‘ç”Ÿã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœæˆ‘ä»¬ä¸å°å¿ƒé€‰æ‹©äº† mergeMap ä¼šå‘ç”Ÿä»€ä¹ˆ:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-built_in">this</span>.form.valueChanges<br>    .pipe(<br>        mergeMap(<span class="hljs-function"><span class="hljs-params">formValue</span> =&gt;</span> <br>                 <span class="hljs-built_in">this</span>.http.put(<span class="hljs-string">`/api/course/<span class="hljs-subst">$&#123;courseId&#125;</span>`</span>, <br>                               formValue))<br>    )<br>    .subscribe(<br>       <span class="hljs-function"><span class="hljs-params">saveResult</span> =&gt;</span>  ... handle successful save ...,<br>        <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> ... handle save error ...      <br>    );<br></code></pre></td></tr></table></figure><p>ç°åœ¨å‡è®¾ç”¨æˆ·ä¸è¡¨å•è¿›è¡Œäº¤äº’å¹¶å¼€å§‹å¿«é€Ÿåœ°è¾“å…¥æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨ç½‘ç»œæ—¥å¿—ä¸­çœ‹åˆ°å¹¶è¡Œè¿è¡Œçš„å¤šä¸ªä¿å­˜è¯·æ±‚:</p><p><img src="/img/rxjsMap/10-mergeMap-demo.png" alt=""></p><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œè¯·æ±‚æ˜¯å¹¶è¡Œå‘ç”Ÿçš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªé”™è¯¯ï¼åœ¨é‡è´Ÿè½½ä¸‹ï¼Œè¿™äº›è¯·æ±‚å¯èƒ½ä¼šè¢«å¤„ç†å¾—æ— åºã€‚</p><h3 id="å¯è§‚å¯Ÿå¯¹è±¡çš„åˆ‡æ¢">å¯è§‚å¯Ÿå¯¹è±¡çš„åˆ‡æ¢</h3><p>ç°åœ¨æˆ‘ä»¬æ¥è°ˆè°ˆå¦ä¸€ä¸ª Observable ç»„åˆç­–ç•¥ï¼šåˆ‡æ¢ã€‚ åˆ‡æ¢çš„æ¦‚å¿µæ›´æ¥è¿‘äºåˆå¹¶è€Œä¸æ˜¯ä¸²è”ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ç­‰å¾…ä»»ä½• Observable ç»ˆæ­¢ã€‚</p><p>ä½†æ˜¯åœ¨åˆ‡æ¢æ—¶ï¼Œä¸åˆå¹¶ä¸åŒï¼Œå¦‚æœä¸€ä¸ªæ–°çš„ Observable å¼€å§‹å‘å‡ºå€¼ï¼Œæˆ‘ä»¬å°†åœ¨è®¢é˜…æ–°çš„ Observable ä¹‹å‰å–æ¶ˆè®¢é˜…ä¹‹å‰çš„ Observableã€‚</p><p>Observable åˆ‡æ¢å°±æ˜¯ä¸ºäº†ç¡®ä¿æœªä½¿ç”¨çš„ Observables çš„å–æ¶ˆè®¢é˜…é€»è¾‘è¢«è§¦å‘ï¼Œä»è€Œå¯ä»¥é‡Šæ”¾èµ„æºï¼</p><h3 id="Observable-Switch-çš„å¼¹ç å›¾">Observable Switch çš„å¼¹ç å›¾</h3><p><img src="/img/rxjsMap/05-switch.png" alt=""></p><p>æ³¨æ„å¯¹è§’çº¿ï¼Œè¿™äº›ä¸æ˜¯å¶ç„¶çš„ï¼ åœ¨åˆ‡æ¢ç­–ç•¥çš„æƒ…å†µä¸‹ï¼Œåœ¨å›¾ä¸­è¡¨ç¤ºé«˜é˜¶ Observable å¾ˆé‡è¦ï¼Œå®ƒæ˜¯å›¾åƒçš„é¡¶è¡Œã€‚</p><p>è¿™ä¸ªé«˜é˜¶ Observable å‘å‡ºçš„å€¼æœ¬èº«å°±æ˜¯ Observableã€‚</p><p>å¯¹è§’çº¿ä»é«˜é˜¶ Observable é¡¶çº¿åˆ†å‰çš„é‚£ä¸€åˆ»ï¼Œæ˜¯ Observable å€¼è¢« switch å‘å‡ºå’Œè®¢é˜…çš„é‚£ä¸€åˆ»ã€‚</p><h3 id="åˆ†è§£-switch-ç½‘ç»œæ—¥å¿—å›¾">åˆ†è§£ switch ç½‘ç»œæ—¥å¿—å›¾</h3><p>ä¸‹é¢æ˜¯è¿™ä¸ªå›¾è¡¨ä¸­çš„æƒ…å†µ:</p><ul><li><p>é«˜é˜¶ Observable å‘å‡ºå®ƒçš„ç¬¬ä¸€ä¸ªå†…éƒ¨ Observable (a-b-c-d)ï¼Œå®ƒè¢«è®¢é˜…ï¼ˆé€šè¿‡ switch ç­–ç•¥å®ç°ï¼‰ç¬¬ä¸€ä¸ªå†…éƒ¨ Observable (a-b-c-d) å‘å‡ºå€¼ a å’Œ bï¼Œå®ƒä»¬ç«‹å³åæ˜ åœ¨è¾“å‡ºä¸­</p></li><li><p>ä½†éšåç¬¬äºŒä¸ªå†…éƒ¨ Observable (e-f-g) è¢«å‘å°„ï¼Œè¿™è§¦å‘äº†ç¬¬ä¸€ä¸ªå†…éƒ¨ Observable (a-b-c-d) çš„å–æ¶ˆè®¢é˜…ï¼Œè¿™æ˜¯åˆ‡æ¢çš„å…³é”®éƒ¨åˆ†</p></li><li><p>ç„¶åç¬¬äºŒä¸ªå†…éƒ¨ Observable (e-f-g) å¼€å§‹å‘å‡ºæ–°å€¼ï¼Œè¿™äº›å€¼åæ˜ åœ¨è¾“å‡ºä¸­</p></li><li><p>ä½†è¯·æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªå†…éƒ¨ Observable (a-b-c-d) åŒæ—¶ä»åœ¨å‘å‡ºæ–°å€¼ c å’Œ d</p></li><li><p>ç„¶è€Œï¼Œè¿™äº›åæ¥çš„å€¼æ²¡æœ‰åæ˜ åœ¨è¾“å‡ºä¸­ï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬åŒæ—¶å–æ¶ˆäº†ç¬¬ä¸€ä¸ªå†…éƒ¨ Observable (a-b-c-d) çš„è®¢é˜…</p></li></ul><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆè¦ç”¨è¿™ç§ä¸åŒå¯»å¸¸çš„æ–¹å¼ï¼Œç”¨å¯¹è§’çº¿æ¥ç»˜åˆ¶å›¾è¡¨äº†: å› ä¸ºæˆ‘ä»¬éœ€è¦ç›´è§‚åœ°è¡¨ç¤ºæ¯ä¸ªå†…éƒ¨å¯è§‚æµ‹æ•°æ®æ˜¯ä»å“ªé‡Œè®¢é˜…(æˆ–è€…å–æ¶ˆè®¢é˜…)çš„ï¼Œè¿™å‘ç”Ÿåœ¨å¯¹è§’çº¿ä»é«˜é˜¶å¯è§‚æµ‹æ•°æ®æºåˆ†å‰å‡ºæ¥çš„ç‚¹ä¸Šã€‚</p><h3 id="RxJs-switchMap-è¿ç®—ç¬¦">RxJs switchMap è¿ç®—ç¬¦</h3><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨ switch ç­–ç•¥å¹¶å°†å…¶åº”ç”¨äºé«˜é˜¶æ˜ å°„ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‘å‡ºå€¼1ã€3å’Œ5çš„æ™®é€šè¾“å…¥æµã€‚</p><p>ç„¶åæˆ‘ä»¬å°†æŠŠæ¯ä¸ªå€¼æ˜ å°„åˆ°ä¸€ä¸ªå¯è§‚æµ‹å€¼ï¼Œå°±åƒæˆ‘ä»¬åœ¨è¿æ¥æ˜ å°„å’Œåˆå¹¶æ˜ å°„çš„æƒ…å†µä¸‹æ‰€åšçš„é‚£æ ·ï¼Œå¹¶è·å¾—ä¸€ä¸ªæ›´é«˜é˜¶çš„å¯è§‚æµ‹å€¼ã€‚</p><p>å¦‚æœæˆ‘ä»¬ç°åœ¨åœ¨å‘å‡ºçš„å†…éƒ¨ Observable ä¹‹é—´åˆ‡æ¢ï¼Œè€Œä¸æ˜¯è¿æ¥æˆ–åˆå¹¶å®ƒä»¬ï¼Œæˆ‘ä»¬æœ€ç»ˆä¼šå¾—åˆ° switchMap è¿ç®—ç¬¦ï¼š</p><p><img src="/img/rxjsMap/06-switchMap-2.png" alt=""></p><h3 id="åˆ†è§£-Observable-switchMap-çš„å¼¹ç å›¾">åˆ†è§£ Observable switchMap çš„å¼¹ç å›¾</h3><p>ä¸‹é¢æ˜¯è¿™ä¸ªæ“ä½œç¬¦çš„å·¥ä½œåŸç†:</p><ul><li><p>å¯è§‚æµ‹çš„æºå‘å°„å€¼1ã€3å’Œ5</p></li><li><p>ç„¶åé€šè¿‡åº”ç”¨æ˜ å°„å‡½æ•°å°†è¿™äº›å€¼è½¬æ¢ä¸º Observables</p></li><li><p>å½“å†…éƒ¨è§‚å¯Ÿå€¼å‘å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œè¯¥å€¼å°†ç«‹å³åæ˜ åœ¨è¾“å‡ºä¸­</p></li><li><p>ä½†æ˜¯å¦‚æœåœ¨å‰ä¸€ä¸ª Observable æœ‰æœºä¼šå®Œæˆä¹‹å‰å‘å‡ºäº†åƒ 5 è¿™æ ·çš„æ–°å€¼ï¼Œåˆ™å‰ä¸€ä¸ªå†…éƒ¨ Observable (30-30-30) å°†è¢«å–æ¶ˆè®¢é˜…ï¼Œå¹¶ä¸”å®ƒçš„å€¼å°†ä¸å†åæ˜ åœ¨è¾“å‡ºä¸­</p></li><li><p>æ³¨æ„ä¸Šå›¾ä¸­çº¢è‰²çš„ 30-30-30 å†…éƒ¨ Observableï¼šæœ€å 30 ä¸ªå€¼æ²¡æœ‰å‘å‡ºï¼Œå› ä¸º 30-30-30 å†…éƒ¨ Observable è¢«å–æ¶ˆè®¢é˜…</p></li></ul><h3 id="Search-TypeAhead-switchMap-è¿ç®—ç¬¦ç¤ºä¾‹">Search TypeAhead-switchMap è¿ç®—ç¬¦ç¤ºä¾‹</h3><p>switchMap çš„ä¸€ä¸ªéå¸¸å¸¸è§çš„ç”¨ä¾‹æ˜¯ search Typeheadã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰æˆ‘ä»¬çš„æº Observerï¼Œå®ƒçš„å€¼æœ¬èº«å°†è§¦å‘æœç´¢è¯·æ±‚ã€‚</p><p>è¿™ä¸ªæº Observable å°†å‘å‡ºå€¼ï¼Œè¿™äº›å€¼æ˜¯ç”¨æˆ·åœ¨è¾“å…¥ä¸­é”®å…¥çš„æœç´¢æ–‡æœ¬ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> searchText$: Observable&lt;<span class="hljs-built_in">string</span>&gt; = <br>      fromEvent&lt;<span class="hljs-built_in">any</span>&gt;(<span class="hljs-built_in">this</span>.input.nativeElement, <span class="hljs-string">&#x27;keyup&#x27;</span>)<br>    .pipe(<br>        map(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> event.target.value),<br>        startWith(<span class="hljs-string">&#x27;&#x27;</span>)<br>    )<br>    .subscribe(<span class="hljs-built_in">console</span>.log);<br></code></pre></td></tr></table></figure><p>æ­¤æº Observable é“¾æ¥åˆ°ç”¨æˆ·é”®å…¥å…¶æœç´¢çš„è¾“å…¥æ–‡æœ¬å­—æ®µã€‚ å½“ç”¨æˆ·è¾“å…¥å•è¯â€œHello Worldâ€ä½œä¸ºæœç´¢æ—¶ï¼Œè¿™äº›æ˜¯ searchText$ å‘å‡ºçš„å€¼ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">H</span><br><span class="hljs-built_in">H</span><br>He<br>Hel<br>Hell<br>Hello<br>Hello <br>Hello W<br>Hello W<br>Hello Wo<br>Hello Wor<br>Hello Worl<br>Hello World<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨é˜²æŠ–å¹¶åˆ é™¤é‡å¤é¡¹">ä½¿ç”¨é˜²æŠ–å¹¶åˆ é™¤é‡å¤é¡¹</h3><p>æ³¨æ„é‡å¤çš„å€¼ï¼Œæˆ–è€…æ˜¯ç”±äºä½¿ç”¨äº†ä¸¤ä¸ªå•è¯ä¹‹é—´çš„ç©ºæ ¼ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨ Shift é”®å°†å­—æ¯ H å’Œ W å¤§å†™ã€‚</p><p>ä¸ºäº†é¿å…å°†æ‰€æœ‰è¿™äº›å€¼ä½œä¸ºå•ç‹¬çš„æœç´¢è¯·æ±‚å‘é€åˆ°åç«¯ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ deounceTime æ“ä½œç¬¦ç­‰å¾…ç”¨æˆ·è¾“å…¥ç¨³å®šä¸‹æ¥:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> searchText$: Observable&lt;<span class="hljs-built_in">string</span>&gt; = <br>      fromEvent&lt;<span class="hljs-built_in">any</span>&gt;(<span class="hljs-built_in">this</span>.input.nativeElement, <span class="hljs-string">&#x27;keyup&#x27;</span>)<br>    .pipe(<br>        map(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> event.target.value),<br>        startWith(<span class="hljs-string">&#x27;&#x27;</span>),<br>        debounceTime(<span class="hljs-number">400</span>)<br>    )<br>    .subscribe(<span class="hljs-built_in">console</span>.log);<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦ï¼Œå¦‚æœç”¨æˆ·ä»¥æ­£å¸¸é€Ÿåº¦è¾“å…¥ï¼Œæˆ‘ä»¬ç°åœ¨åœ¨ searchText $çš„è¾“å‡ºä¸­åªæœ‰ä¸€ä¸ªå€¼:</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Hello World</span><br></code></pre></td></tr></table></figure><p>è¿™å·²ç»æ¯”æˆ‘ä»¬ä»¥å‰çš„è¦å¥½å¾—å¤šäº†ï¼Œç°åœ¨åªæœ‰å½“å®ƒçš„ç¨³å®šå€¼è‡³å°‘ä¸º400æ¯«ç§’æ—¶æ‰ä¼šå‘å‡ºä¸€ä¸ªå€¼ï¼</p><p>ä½†æ˜¯ï¼Œå¦‚æœç”¨æˆ·åœ¨æ€è€ƒæœç´¢æ—¶è¾“å…¥é€Ÿåº¦å¾ˆæ…¢ï¼Œä»¥è‡³äºä¸¤ä¸ªå€¼ä¹‹é—´çš„æ—¶é—´é—´éš”è¶…è¿‡400æ¯«ç§’ï¼Œé‚£ä¹ˆæœç´¢æµå¯èƒ½æ˜¯è¿™æ ·çš„:</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">He</span><br><span class="hljs-attribute">Hell</span><br><span class="hljs-attribute">Hello World</span><br></code></pre></td></tr></table></figure><p>æ­¤å¤–ï¼Œç”¨æˆ·å¯ä»¥é”®å…¥ä¸€ä¸ªå€¼ï¼ŒæŒ‰é€€æ ¼é”®å¹¶å†æ¬¡é”®å…¥ï¼Œè¿™å¯èƒ½å¯¼è‡´é‡å¤çš„æœç´¢å€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ç‹¬ç‰¹çš„ distinctUntilChanged æ“ä½œç¬¦æ¥é˜²æ­¢é‡å¤æœç´¢çš„å‘ç”Ÿã€‚</p><h3 id="å–æ¶ˆè¿‡æ—¶æœç´¢">å–æ¶ˆè¿‡æ—¶æœç´¢</h3><p>ä½†æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥å–æ¶ˆä»¥å‰çš„æœç´¢ï¼Œä½œä¸ºä¸€ä¸ªæ–°çš„æœç´¢å¼€å§‹ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬è¦åšçš„æ˜¯å°†æ¯ä¸ªæœç´¢å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªåç«¯æœç´¢è¯·æ±‚å¹¶è®¢é˜…å®ƒï¼Œç„¶ååœ¨ä¸¤ä¸ªè¿ç»­çš„æœç´¢è¯·æ±‚ä¹‹é—´åº”ç”¨åˆ‡æ¢ç­–ç•¥ï¼Œå¦‚æœè§¦å‘ä¸€ä¸ªæ–°çš„æœç´¢ï¼Œåˆ™å‰ä¸€ä¸ªæœç´¢å°†è¢«å–æ¶ˆã€‚</p><p>è€Œè¿™æ­£æ˜¯ switchMap æ“ä½œç¬¦è¦åšçš„äº‹æƒ…ï¼ä¸‹é¢æ˜¯ä½¿ç”¨å®ƒçš„ Typehead é€»è¾‘çš„æœ€ç»ˆå®ç°:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">const</span> searchText$: Observable&lt;<span class="hljs-built_in">string</span>&gt; = <br>      fromEvent&lt;any&gt;(<span class="hljs-keyword">this</span>.input.nativeElement, <span class="hljs-string">&#x27;keyup&#x27;</span>)<br>    .pipe(<br>        map(<span class="hljs-keyword">event</span> =&gt; <span class="hljs-keyword">event</span>.target.<span class="hljs-keyword">value</span>),<br>        startWith(<span class="hljs-string">&#x27;&#x27;</span>),<br>        debounceTime(<span class="hljs-number">400</span>),<br>        distinctUntilChanged()<br>    ); <br><br><span class="hljs-keyword">const</span> lessons$: Observable&lt;Lesson[]&gt; = searchText$<br>    .pipe(<br>        switchMap(search =&gt; <span class="hljs-keyword">this</span>.loadLessons(search))        <br>    )<br>    .subscribe();<br><br><span class="hljs-function">function <span class="hljs-title">loadLessons</span>(<span class="hljs-params">search:<span class="hljs-built_in">string</span></span>): Observable&lt;Lesson[]&gt;</span> &#123;<br>    <br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">params</span> = <span class="hljs-keyword">new</span> HttpParams().<span class="hljs-keyword">set</span>(<span class="hljs-string">&#x27;search&#x27;</span>, search);<br>   <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.http.<span class="hljs-keyword">get</span>(`/api/lessons/$&#123;coursesId&#125;`, &#123;<span class="hljs-keyword">params</span>&#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ switchMap æ“ä½œç¬¦çš„è¿è¡Œæƒ…å†µï¼å¦‚æœç”¨æˆ·åœ¨æœç´¢æ ä¸Šè¾“å…¥ï¼Œç„¶åçŠ¹è±«äº†ä¸€ä¸‹ï¼Œè¾“å…¥äº†å…¶ä»–å†…å®¹ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥åœ¨ç½‘ç»œæ—¥å¿—ä¸­çœ‹åˆ°:</p><p><img src="/img/rxjsMap/11-switchMap-example.png" alt=""></p><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œä»¥å‰çš„ä¸€äº›æœç´¢å·²ç»è¢«å–æ¶ˆï¼Œå› ä¸ºä»–ä»¬æ­£åœ¨è¿›è¡Œï¼Œè¿™æ˜¯å¯æ€•çš„ï¼Œå› ä¸ºè¿™å°†é‡Šæ”¾æœåŠ¡å™¨èµ„æºï¼Œç„¶åå¯ä»¥ç”¨äºå…¶ä»–äº‹æƒ…ã€‚</p><h3 id="The-Exhaust-Strategy">The Exhaust Strategy</h3><p>switchMap æ“ä½œç¬¦å¯¹äº typehead åœºæ™¯æ˜¯ç†æƒ³çš„ï¼Œä½†æ˜¯åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦åšçš„æ˜¯å¿½ç•¥æºå¯è§‚å¯Ÿå€¼ä¸­çš„æ–°å€¼ï¼Œç›´åˆ°å‰é¢çš„å€¼è¢«å®Œå…¨å¤„ç†ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨è§¦å‘ä¸€ä¸ªåç«¯ä¿å­˜è¯·æ±‚ï¼Œä»¥å“åº”ä¿å­˜æŒ‰é’®ä¸­çš„å•å‡»ã€‚æˆ‘ä»¬å¯ä»¥é¦–å…ˆå°è¯•ä½¿ç”¨ concatMap æ“ä½œç¬¦æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä»¥ç¡®ä¿æŒ‰é¡ºåºæ‰§è¡Œä¿å­˜æ“ä½œ:</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">from<span class="hljs-constructor">Event(<span class="hljs-params">this</span>.<span class="hljs-params">saveButton</span>.<span class="hljs-params">nativeElement</span>, &#x27;<span class="hljs-params">click</span>&#x27;)</span><br>    .pipe(<br>        concat<span class="hljs-constructor">Map(()</span> =&gt; this.save<span class="hljs-constructor">Course(<span class="hljs-params">this</span>.<span class="hljs-params">form</span>.<span class="hljs-params">value</span>)</span>)<br>    )<br>    .subscribe<span class="hljs-literal">()</span>;<br></code></pre></td></tr></table></figure><p>è¿™å¯ä»¥ç¡®ä¿æŒ‰é¡ºåºä¿å­˜ï¼Œä½†æ˜¯å¦‚æœç”¨æˆ·å¤šæ¬¡å•å‡»ä¿å­˜æŒ‰é’®ï¼Œç°åœ¨ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿä¸‹é¢æ˜¯æˆ‘ä»¬å°†åœ¨ç½‘ç»œæ—¥å¿—ä¸­çœ‹åˆ°çš„å†…å®¹:</p><p><img src="/img/rxjsMap/12-exhaustMap-before.png" alt=""></p><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œæ¯æ¬¡ç‚¹å‡»éƒ½ä¼šè§¦å‘è‡ªå·±çš„ä¿å­˜: å¦‚æœæˆ‘ä»¬ç‚¹å‡»20æ¬¡ï¼Œå°±ä¼šæœ‰20æ¬¡ä¿å­˜ï¼åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ä»…ä»…æ˜¯ç¡®ä¿ä¿å­˜æŒ‰é¡ºåºå‘ç”Ÿã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿå¿½ç•¥ä¸€ä¸ªç‚¹å‡»ï¼Œä½†åªæœ‰å½“ä¸€ä¸ªä¿å­˜æ˜¯æ­£åœ¨è¿›è¡Œã€‚exhaust ç»„åˆç­–ç•¥å°†å…è®¸æˆ‘ä»¬è¿™æ ·åšã€‚</p><h3 id="exhaust-çš„å¼¹ç å›¾">exhaust çš„å¼¹ç å›¾</h3><p>ä¸ºäº†ç†è§£ exhaust æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå¼¹ç å›¾:</p><p><img src="/img/rxjsMap/07-exhaust.png" alt=""></p><p>å°±åƒä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸ªæ›´é«˜é˜¶çš„ Observableï¼Œå®ƒçš„å€¼æœ¬èº«å°±æ˜¯ Observableï¼Œä»ç¬¬ä¸€è¡Œåˆ†å‰å‡ºæ¥ã€‚è¿™æ˜¯è¿™å¼ å›¾ä¸­å‘ç”Ÿçš„äº‹æƒ…ï¼š</p><ul><li><p>å°±åƒ switch çš„æƒ…å†µä¸€æ ·ï¼Œexhaust è®¢é˜…ç¬¬ä¸€ä¸ªå†…éƒ¨ Observable (a-b-c)</p></li><li><p>åƒå¾€å¸¸ä¸€æ ·ï¼Œå€¼ aã€b å’Œ c ä¼šç«‹å³åæ˜ åœ¨è¾“å‡ºä¸­</p></li><li><p>ç„¶åå‘å‡ºç¬¬äºŒä¸ªå†…éƒ¨ Observable (d-e-f)ï¼Œè€Œç¬¬ä¸€ä¸ª Observable (a-b-c) ä»åœ¨è¿›è¡Œä¸­</p></li><li><p>ç¬¬äºŒä¸ª Observable è¢« exhaust ç­–ç•¥ä¸¢å¼ƒï¼Œå¹¶ä¸”ä¸ä¼šè¢«è®¢é˜…ï¼ˆè¿™æ˜¯ exhaust çš„å…³é”®éƒ¨åˆ†ï¼‰</p></li><li><p>åªæœ‰åœ¨ç¬¬ä¸€ä¸ªå¯è§‚æµ‹æ•°æ®(a-b-c)å®Œæˆåï¼Œexhaust æ‰ä¼šè®¢é˜…æ–°çš„å¯è§‚æµ‹æ•°æ®</p></li><li><p>å½“ç¬¬ä¸‰ä¸ª Observable (g-h-i) å‘å‡ºæ—¶ï¼Œç¬¬ä¸€ä¸ª Observable (a-b-c) å·²ç»å®Œæˆï¼Œæ‰€ä»¥ç¬¬ä¸‰ä¸ª Observable ä¸ä¼šè¢«ä¸¢å¼ƒï¼Œä¼šè¢«è®¢é˜…</p></li><li><p>ç„¶åï¼Œç¬¬ä¸‰ä¸ª Observable çš„å€¼ g-h-i å°†æ˜¾ç¤ºåœ¨ç»“æœ Observable çš„è¾“å‡ºä¸­ï¼Œä¸è¾“å‡ºä¸­ä¸å­˜åœ¨çš„å€¼ d-e-f ä¸åŒ</p></li></ul><p>å°±åƒ concatã€merge å’Œ switch çš„æƒ…å†µä¸€æ ·ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨é«˜é˜¶æ˜ å°„çš„ä¸Šä¸‹æ–‡ä¸­åº”ç”¨ exhaust ç­–ç•¥ã€‚</p><h3 id="RxJs-exhaustMap-è¿ç®—ç¬¦">RxJs exhaustMap è¿ç®—ç¬¦</h3><p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ exaustMap æ“ä½œç¬¦çš„å¼¹ç å›¾ã€‚è®©æˆ‘ä»¬è®°ä½ï¼Œä¸å‰é¢å›¾è¡¨çš„é¡¶è¡Œä¸åŒï¼Œæºå¯è§‚æµ‹å€¼1-3-5å‘å‡ºçš„å€¼ä¸æ˜¯å¯è§‚æµ‹å€¼ã€‚</p><p>ç›¸åï¼Œè¿™äº›å€¼å¯ä»¥æ˜¯é¼ æ ‡ç‚¹å‡»:</p><p><img src="/img/rxjsMpa/08-exhaustMap.png" alt=""></p><p>ä¸‹é¢æ˜¯ exhaustMap å›¾è¡¨çš„æƒ…å†µ:</p><ul><li><p>å‘å‡ºå€¼ 1ï¼Œå¹¶åˆ›å»ºå†…éƒ¨ Observable 10-10-10</p></li><li><p>Observable 10-10-10 å‘å‡ºæ‰€æœ‰å€¼å¹¶åœ¨æº Observable ä¸­å‘å‡ºå€¼ 3 ä¹‹å‰å®Œæˆï¼Œå› æ­¤æ‰€æœ‰ 10-10-10 å€¼åœ¨è¾“å‡ºä¸­å‘å‡º</p></li><li><p>åœ¨è¾“å…¥ä¸­å‘å‡ºä¸€ä¸ªæ–°å€¼ 3ï¼Œè§¦å‘ä¸€ä¸ªæ–°çš„ 30-30-30 å†…éƒ¨ Observable</p></li><li><p>ä½†æ˜¯ç°åœ¨ï¼Œè™½ç„¶ 30-30-30 ä»åœ¨è¿è¡Œï¼Œä½†æˆ‘ä»¬åœ¨æº Observable ä¸­å¾—åˆ°äº†ä¸€ä¸ªæ–°å€¼ 5</p></li><li><p>è¿™ä¸ªå€¼ 5 è¢« exhaust ç­–ç•¥ä¸¢å¼ƒï¼Œè¿™æ„å‘³ç€ä»æœªåˆ›å»º 50-50-50 Observableï¼Œå› æ­¤ 50-50-50 å€¼ä»æœªå‡ºç°åœ¨è¾“å‡ºä¸­</p></li></ul><h3 id="A-Practical-Example-for-exhaustMap">A Practical Example for exhaustMap</h3><p>ç°åœ¨è®©æˆ‘ä»¬å°†è¿™ä¸ªæ–°çš„ exhaustMap æ“ä½œç¬¦åº”ç”¨åˆ°æˆ‘ä»¬çš„ä¿å­˜æŒ‰é’®åœºæ™¯:</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">from<span class="hljs-constructor">Event(<span class="hljs-params">this</span>.<span class="hljs-params">saveButton</span>.<span class="hljs-params">nativeElement</span>, &#x27;<span class="hljs-params">click</span>&#x27;)</span><br>    .pipe(<br>        exhaust<span class="hljs-constructor">Map(()</span> =&gt; this.save<span class="hljs-constructor">Course(<span class="hljs-params">this</span>.<span class="hljs-params">form</span>.<span class="hljs-params">value</span>)</span>)<br>    )<br>    .subscribe<span class="hljs-literal">()</span>;<br></code></pre></td></tr></table></figure><p><img src="/img/rxjsMap/12-exhaustMap-after.png" alt=""></p><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œå½“ä¿å­˜è¯·æ±‚è¢«å¿½ç•¥æ—¶ï¼Œæˆ‘ä»¬æ‰€åšçš„å•å‡»ä»ç„¶åœ¨è¿›è¡Œï¼Œæ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼</p><p>æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬è¿ç»­ç‚¹å‡»20æ¬¡ï¼Œæœ€ç»ˆæ­£åœ¨è¿›è¡Œçš„ä¿å­˜è¯·æ±‚ä¼šç»“æŸï¼Œç„¶åç¬¬äºŒä¸ªä¿å­˜è¯·æ±‚ä¼šå¼€å§‹ã€‚</p><h3 id="å¦‚ä½•é€‰æ‹©æ­£ç¡®çš„æ˜ å°„æ“ä½œç¬¦ï¼Ÿ">å¦‚ä½•é€‰æ‹©æ­£ç¡®çš„æ˜ å°„æ“ä½œç¬¦ï¼Ÿ</h3><p>concatMap, mergeMap, switchMap and exhaustMap éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯é«˜é˜¶æ˜ å°„æ“ä½œç¬¦ã€‚</p><p>ä½†å®ƒåœ¨è®¸å¤šå¾®å¦™çš„æ–¹é¢ä¹Ÿæ˜¯å¦‚æ­¤ä¸åŒï¼Œä»¥è‡³äºæ²¡æœ‰ä¸€ä¸ªæ“ä½œç¬¦å¯ä»¥è¢«å®‰å…¨åœ°æŒ‡å®šä¸ºé»˜è®¤å€¼ã€‚</p><p>ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°æ ¹æ®ç”¨ä¾‹é€‰æ‹©åˆé€‚çš„æ“ä½œç¬¦:</p><ul><li><p>å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ç­‰å¾…å®Œæˆæ—¶æŒ‰é¡ºåºæ‰§è¡Œæ“ä½œï¼Œé‚£ä¹ˆ concatMap æ˜¯æ­£ç¡®çš„é€‰æ‹©</p></li><li><p>å¯¹äºå¹¶è¡Œå¤„ç†ï¼ŒmergeMap æ˜¯æœ€å¥½çš„é€‰æ‹©</p></li><li><p>å¦‚æœæˆ‘ä»¬éœ€è¦å–æ¶ˆé€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨ switchMap</p></li><li><p>åœ¨å½“å‰çš„ Observables è¿˜åœ¨è¿è¡Œçš„æ—¶å€™å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼ŒexhaustMap å°±æ˜¯è¿™æ ·åšçš„</p></li></ul><h3 id="Running-GitHub-repo-with-code-samples">Running GitHub repo (with code samples)</h3><p>å¦‚æœä½ æƒ³å°è¯•ä¸€ä¸‹è¿™ç¯‡æ–‡ç« ä¸­çš„ä¾‹å­ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª<a href="https://github.com/angular-university/rxjs-course/tree/1-operators-finished">ä»“åº“</a>ï¼Œé‡Œé¢åŒ…å«äº†è¿™ç¯‡æ–‡ç« çš„è¿è¡Œä»£ç ã€‚</p><p>è¿™ä¸ªå­˜å‚¨åº“åŒ…æ‹¬ä¸€ä¸ªå°çš„ HTTP åç«¯ï¼Œå®ƒå°†å¸®åŠ©åœ¨ä¸€ä¸ªæ›´ç°å®çš„åœºæ™¯ä¸­æµ‹è¯• RxJ æ˜ å°„æ“ä½œç¬¦ï¼Œå¹¶åŒ…æ‹¬è¿è¡Œä¾‹å­ï¼Œæ¯”å¦‚è¡¨å•è‰ç¨¿çš„é¢„å…ˆä¿å­˜ã€typeaheadã€ä¸»é¢˜å’Œç”¨ Reactive é£æ ¼ç¼–å†™çš„ç»„ä»¶çš„ä¾‹å­:</p><p><img src="/img/rxjsMap/09-demo-app.png" alt=""></p><h3 id="ç»“è®º">ç»“è®º</h3><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼ŒRxJs é«˜é˜¶æ˜ å°„è¿ç®—ç¬¦å¯¹äºåœ¨å“åº”å¼ç¼–ç¨‹ä¸­æ‰§è¡Œä¸€äº›éå¸¸å¸¸è§çš„æ“ä½œ(å¦‚ç½‘ç»œè°ƒç”¨)æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><p>ä¸ºäº†çœŸæ­£ç†è§£è¿™äº›æ˜ å°„æ“ä½œç¬¦åŠå…¶åç§°ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆå…³æ³¨ç†è§£åº•å±‚çš„å¯è§‚å¯Ÿç»„åˆç­–ç•¥ concatã€ mergeã€ switch å’Œ exhaustã€‚</p><p>æˆ‘ä»¬è¿˜éœ€è¦è®¤è¯†åˆ°å­˜åœ¨ä¸€ä¸ªæ›´é«˜é˜¶çš„æ˜ å°„æ“ä½œï¼Œå…¶ä¸­å€¼è¢«è½¬æ¢ä¸ºåˆ†ç¦»çš„å¯è§‚æµ‹å€¼ï¼Œå¹¶ä¸”è¿™äº›å¯è§‚æµ‹å€¼è¢«æ˜ å°„æ“ä½œæœ¬èº«ä»¥éšè—çš„æ–¹å¼è®¢é˜…ã€‚</p><p>é€‰æ‹©æ­£ç¡®çš„è¿ç®—ç¬¦å°±æ˜¯é€‰æ‹©æ­£ç¡®çš„å†…éƒ¨ Observable ç»„åˆç­–ç•¥ã€‚ é€‰æ‹©é”™è¯¯çš„è¿ç®—ç¬¦é€šå¸¸ä¸ä¼šå¯¼è‡´ç¨‹åºç«‹å³æŸåï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›éš¾ä»¥è§£å†³çš„é—®é¢˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rxjs</tag>
      
      <tag>operators</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•ä¸€æ¬¡ä½¿ç”¨RxJsçš„æ“ä½œç¬¦ä¼˜åŒ–æ¶ˆæ¯æœç´¢åŠŸèƒ½</title>
    <link href="/posts/3a4ba2b1/"/>
    <url>/posts/3a4ba2b1/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>ä¹‹å‰åœ¨å¼€å‘æ¶ˆæ¯æœç´¢æ¨¡å—æ—¶ï¼Œé‡åˆ°ä¸ªé—®é¢˜ï¼šå¦‚æœåœ¨é˜²æŠ–å…è®¸çš„æ—¶é—´å†…ï¼Œè¿ç»­ä¸¤æ¬¡è¾“å…¥ä¸åŒçš„å…³é”®è¯è§¦å‘httpè¯·æ±‚ï¼Œå¦‚æœç½‘ç»œé€Ÿåº¦æ…¢ï¼Œæˆ–è€…æ¥å£è°ƒç”¨æ—¶é—´é•¿çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ä¸¤ä¸ªhttpè¿æ¥åŒæ—¶åœ¨è¯·æ±‚ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´é¡µé¢ä¼šæ˜¾ç¤ºä¸¤éä¸åŒçš„è¯·æ±‚ç»“æœï¼Œç”šè‡³å¦‚æœè¯´ç¬¬ä¸€æ¬¡çš„è¯·æ±‚å“åº”æ—¶é—´å¿«äºç¬¬äºŒæ¬¡çš„è¯ï¼Œä¼šé€ æˆå½“æœç´¢çš„ç»“æœæ˜¾ç¤ºä¸æ­£ç¡®çš„ç°è±¡ã€‚å½“æ—¶å¹¶æ²¡æœ‰æƒ³åˆ°å¥½çš„è§£å†³æ€è·¯ï¼Œç„¶åå°±æç½®äº†ï¼Œç›´åˆ°æœ€è¿‘çœ‹åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œæ­£å¥½è§£å†³äº†æˆ‘çš„éœ€æ±‚ï¼Œç„¶åå°±æ¥ä¼˜åŒ–è®°å½•ä¸€ä¸‹ã€‚</p><span id="more"></span><h2 id="ä¼˜åŒ–">ä¼˜åŒ–</h2><p>å…ˆçœ‹ä¸€ä¸‹ä¹‹å‰çš„ä»£ç ï¼š</p><p><img src="/img/optimize-message/precode.png" alt=""></p><p>å…¶ä¸­ä¸»è¦çš„é—®é¢˜å°±æ˜¯è®¢é˜…å±‚å±‚åµŒå¥—ï¼Œçœ‹èµ·æ¥éå¸¸ä¹±ï¼Œä¹Ÿæ²¡æœ‰ä¸€äº›æœç´¢çš„ä¼˜åŒ–ã€‚</p><p>åˆ©ç”¨rxjsæ“ä½œç¬¦ä¼˜åŒ–åçš„ä»£ç ï¼š</p><p><img src="/img/optimize-message/curcode.png" alt=""></p><p>å¯ä»¥æ˜æ˜¾çš„çœ‹å‡ºæ¥ä»£ç å˜å¾—ç®€æ´äº†è®¸å¤šã€‚</p><p>ä¸»è¦çš„æ“ä½œç¬¦å¦‚ä¸‹ï¼š</p><ul><li><p>forkJoin</p></li><li><p>fromEvent</p></li><li><p>map</p></li><li><p>filter</p></li><li><p>debounceTime</p></li><li><p>distinctUntilChanged</p></li><li><p>switchMap</p></li><li><p>takeUntil</p></li></ul><p>åˆ†æï¼š</p><p>é¦–å…ˆä½¿ç”¨ forkJoin æ¥èšåˆä¸‰ä¸ª Observableï¼Œé¿å…äº†è®¢é˜…çš„å±‚å±‚åµŒå¥—ï¼Œä½¿ç”¨ fromEvent æ“ä½œç¬¦æ›¿ä»£ input çš„ keyup äº‹ä»¶ï¼Œmap æ“ä½œç¬¦å¤„ç†æµå‘å‡ºè¾“å…¥çš„å€¼ï¼Œfilter è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²ï¼Œä¸ä¼šå‘é€è¯·æ±‚ï¼ŒdebounceTime è¿›è¡Œé˜²æŠ–å¤„ç†ï¼Œç”¨æˆ·å¯ä»¥é”®å…¥ä¸€ä¸ªå€¼ï¼ŒæŒ‰é€€æ ¼é”®å¹¶å†æ¬¡é”®å…¥ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é‡å¤çš„æœç´¢å€¼ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  distinctUntilChanged æ“ä½œç¬¦æ¥é˜²æ­¢é‡å¤æœç´¢çš„å‘ç”Ÿã€‚switchMap æ“ä½œç¬¦çš„ä½œç”¨æ˜¯å¦‚æœè¿ç»­å‘é€äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œä¸”éƒ½æ²¡æœ‰è¯·æ±‚å®Œæˆï¼Œåˆ™å¯ä»¥å–æ¶ˆä¹‹å‰çš„æœç´¢ã€‚æœ€åä½¿ç”¨ takeUnit æ“ä½œç¬¦æ¥ç®¡ç†å–æ¶ˆè®¢é˜…ã€‚</p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>RxJs æ“ä½œç¬¦çš„åˆç†è¿ç”¨å¯ä»¥ä¼˜åŒ–ä»£ç é€»è¾‘ï¼Œä½†æ˜¯ RxJs æ“ä½œç¬¦ç§ç±»å¤šï¼Œè€Œä¸”å­¦èµ·æ¥å¤šå°‘çš„æ˜¯æœ‰ç‚¹æŠ½è±¡çš„ï¼Œåªæœ‰åœ¨å®é™…çš„å¼€å‘ä¸­å»åº”ç”¨å®ƒï¼Œæ‰æ›´èƒ½ä½“ä¼šåˆ°å®ƒçš„å¼ºå¤§ä¹‹å¤„ï½ Keep Learningï½</p>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RxJs</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Angularä¸­çš„ä¾èµ–æ³¨å…¥</title>
    <link href="/posts/9a3d5d6c/"/>
    <url>/posts/9a3d5d6c/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>ç›¸ä¿¡angularä¸­çš„ã€Œä¾èµ–æ³¨å…¥ã€å¯¹äºå¤§éƒ¨åˆ†çš„angularå¼€å‘è€…éƒ½æ˜¯ä¸€ä¸ªä¸å®¹æ˜“è·¨è¿‡å»çš„åï¼Œå½“ç„¶æˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œè¿™ç¯‡æ–‡ç« æ„æ€äº†å¾ˆä¹…ï¼Œå¤§æ¦‚ä»ä¸€å¹´å‰å°±æƒ³å¯¹æ­¤æ¥ä¸ªæ€»ç»“ï¼Œå¥ˆä½•ä¸çŸ¥é“ä»ä½•å†™èµ·ï¼Œä¸»è¦åŸå› æ˜¯åœ¨å¹³å¸¸çš„å®é™…å¼€å‘ä¸­ç”¨åˆ°çš„ä¾èµ–æ³¨å…¥çš„çŸ¥è¯†å¤ªæµ…ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½å¾ˆå¥½çš„è¯»æ‡‚æ–‡æ¡£çš„æ„æ€ï¼Œå¦‚ä»Šæœ‰æœºä¼šåœ¨å®é™…çš„é¡¹ç›®ä¸­æ¥è§¦åˆ°äº†æ›´å¤šä¾èµ–æ³¨å…¥çš„ç”¨æ³•ï¼Œæ•…æ­¤æ€»ç»“ä¸€ä¸‹ã€‚</p><span id="more"></span><p>æœ¬æ–‡å†…å®¹å¤§éƒ¨åˆ†æ¥æºäºå®˜æ–¹æ–‡æ¡£ï¼Œå› ä¸ºæ–‡æ¡£ä¸­çš„çŸ¥è¯†ç‚¹è¿‡äºé›¶æ•£ï¼Œä¸œä¸€é”¤å­è¥¿ä¸€æ£’å­çš„ï¼Œæ‘¸ä¸ç€å¤´è„‘ï¼Œæ‰€ä»¥æˆ‘æŒ‰ç…§è‡ªå·±çš„ç†è§£ï¼ŒåŠ ä¸Šå®é™…çš„demoæ¥æ¢³ç†ä¸€ä¸‹å…¶ä¸­çš„çŸ¥è¯†ç‚¹ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯ã€Œä¾èµ–æ³¨å…¥ï¼ˆdependency-injectionï¼‰ã€ï¼Ÿ">ä»€ä¹ˆæ˜¯ã€Œä¾èµ–æ³¨å…¥ï¼ˆdependency injectionï¼‰ã€ï¼Ÿ</h2><blockquote><p>ä¾èµ–æ³¨å…¥æ—¢æ˜¯è®¾è®¡æ¨¡å¼ï¼ŒåŒæ—¶åˆæ˜¯ä¸€ç§æœºåˆ¶ï¼šå½“åº”ç”¨ç¨‹åºçš„ä¸€äº›éƒ¨ä»¶ï¼ˆå³ä¸€äº›ä¾èµ–ï¼‰éœ€è¦å¦ä¸€äº›éƒ¨ä»¶æ—¶ï¼Œ åˆ©ç”¨ä¾èµ–æ³¨å…¥æ¥åˆ›å»ºè¢«è¯·æ±‚çš„éƒ¨ä»¶ï¼Œå¹¶å°†å®ƒä»¬æ³¨å…¥åˆ°éœ€è¦å®ƒä»¬çš„éƒ¨ä»¶ä¸­ã€‚<br>åœ¨ Angular ä¸­ï¼Œä¾èµ–é€šå¸¸æ˜¯æœåŠ¡ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯å€¼ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²æˆ–å‡½æ•°ã€‚åº”ç”¨çš„æ³¨å…¥å™¨ï¼ˆå®ƒæ˜¯åœ¨å¯åŠ¨æœŸé—´è‡ªåŠ¨åˆ›å»ºçš„ï¼‰ä¼šä½¿ç”¨è¯¥æœåŠ¡æˆ–å€¼çš„é…ç½®å¥½çš„æä¾›è€…æ¥æŒ‰éœ€å®ä¾‹åŒ–è¿™äº›ä¾èµ–ã€‚å„ä¸ªä¸åŒçš„æä¾›è€…å¯ä»¥ä¸ºåŒä¸€ä¸ªæœåŠ¡æä¾›ä¸åŒçš„å®ç°ã€‚</p></blockquote><p>ä¸Šé¢è¿™æ®µè¯ç”¨æˆ‘è‡ªå·±çš„ç†è§£ï¼Œé€šä¿—çš„æ¥è®²å°±æ˜¯ï¼Œä¹‹å‰æˆ‘ä»¬å¦‚æœæƒ³è¦å®ä¾‹åŒ–ç±»ï¼ˆclassï¼‰çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå°±è¦ç”¨ã€Œnewã€è¿ç®—ç¬¦æ¥å®ç°ï¼Œç°åœ¨æœ‰äº†ä¾èµ–æ³¨å…¥è¿™ä¸ªä¸œè¥¿ä»¥åå°±ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±äº²è‡ªåŠ¨æ‰‹å»newä¸€ä¸ªå¯¹è±¡äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„åœ°æ–¹ä½¿ç”¨angularçš„ã€Œä¾èµ–æ³¨å…¥ã€çš„è¯­æ³•ï¼Œå°±å¯ä»¥æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„å¯¹è±¡äº†ï¼Œè€Œå¸®åŠ©æˆ‘ä»¬åˆ›å»ºå¯¹è±¡çš„è¿™ä¸ªä¸œè¥¿å«åšã€Œæ³¨å…¥å™¨ã€ï¼Œæ³¨å…¥å™¨è¿™ä¸ªä¸œè¥¿ï¼Œå¾ˆæŠ½è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸è§æ‘¸ä¸ç€ï¼Œè¿™æ˜¯angularåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºçš„ã€‚</p><p>å…ˆæŠŠå‡ ä¸ªåè¯ææ¸…æ¥šï¼Œã€ŒæœåŠ¡ã€ã€ã€Œæ³¨å…¥å™¨ã€ã€ã€ŒDIä»¤ç‰Œã€ã€ã€Œæä¾›è€…ã€ã€‚</p><h2 id="æœåŠ¡">æœåŠ¡</h2><p>åœ¨ Angular ä¸­ï¼ŒæœåŠ¡å°±æ˜¯ä¸€ä¸ªå¸¦æœ‰ @Injectable è£…é¥°å™¨çš„ç±»ï¼Œå®ƒå°è£…äº†å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­å¤ç”¨çš„é UI é€»è¾‘å’Œä»£ç ã€‚ Angular æŠŠç»„ä»¶å’ŒæœåŠ¡åˆ†å¼€ï¼Œæ˜¯ä¸ºäº†å¢è¿›æ¨¡å—åŒ–ç¨‹åº¦å’Œå¯å¤ç”¨æ€§ã€‚</p><p>@Injectable å…ƒæ•°æ®è®©æœåŠ¡ç±»èƒ½ç”¨äºä¾èµ–æ³¨å…¥æœºåˆ¶ä¸­ã€‚å¯æ³¨å…¥çš„ç±»æ˜¯ç”¨æä¾›è€…è¿›è¡Œå®ä¾‹åŒ–çš„ã€‚ å„ä¸ªæ³¨å…¥å™¨ä¼šç»´æŠ¤ä¸€ä¸ªæä¾›è€…çš„åˆ—è¡¨ï¼Œå¹¶æ ¹æ®ç»„ä»¶æˆ–å…¶å®ƒæœåŠ¡çš„éœ€è¦ï¼Œç”¨å®ƒä»¬æ¥æä¾›æœåŠ¡çš„å®ä¾‹ã€‚</p><h2 id="DIä»¤ç‰Œ">DIä»¤ç‰Œ</h2><p>ä¸€ç§ç”¨æ¥æŸ¥é˜…çš„ä»¤ç‰Œï¼Œå®ƒå…³è”åˆ°ä¸€ä¸ªä¾èµ–æä¾›è€…ï¼Œç”¨äºä¾èµ–æ³¨å…¥ç³»ç»Ÿä¸­ï¼ŒDIä»¤ç‰Œå’Œæ³¨å…¥çš„ä¾èµ–é¡¹ç›¸æ˜ å°„ï¼Œå¯ä»¥æŠŠDIä»¤ç‰Œä½œä¸ºkeyæ¥æ‰¾åˆ°ä¾èµ–é¡¹ã€‚</p><p>ä»¤ç‰Œé€šå¸¸æ˜¯ Type æˆ– InjectionToken çš„å®ä¾‹ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯ any å®ä¾‹ã€‚</p><h2 id="æä¾›è€…">æä¾›è€…</h2><p>ä¸€ä¸ªå®ç°äº† Provider æ¥å£çš„å¯¹è±¡ã€‚ä¸€ä¸ªæä¾›è€…å¯¹è±¡å®šä¹‰äº†å¦‚ä½•è·å–ä¸ DI ä»¤ç‰Œï¼ˆtokenï¼‰ ç›¸å…³è”çš„å¯æ³¨å…¥ä¾èµ–ã€‚ æ³¨å…¥å™¨ä¼šä½¿ç”¨è¿™ä¸ªæä¾›è€…æ¥åˆ›å»ºå®ƒæ‰€ä¾èµ–çš„é‚£äº›ç±»çš„å®ä¾‹ã€‚</p><p>Angular ä¼šä¸ºæ¯ä¸ªæ³¨å…¥å™¨æ³¨å†Œä¸€äº› Angular è‡ªå·±çš„æœåŠ¡ã€‚ä½ ä¹Ÿå¯ä»¥æ³¨å†Œåº”ç”¨è‡ªå·±æ‰€éœ€çš„æœåŠ¡æä¾›è€…ã€‚</p><p>ä¾èµ–æä¾›è€…ä¼šä½¿ç”¨ DI ä»¤ç‰Œæ¥é…ç½®æ³¨å…¥å™¨ï¼Œæ³¨å…¥å™¨ä¼šç”¨å®ƒæ¥æä¾›è¿™ä¸ªä¾èµ–å€¼çš„å…·ä½“çš„ã€è¿è¡Œæ—¶ç‰ˆæœ¬ã€‚</p><figure class="highlight coq"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs coq">type Provider = TypeProvider | <span class="hljs-type">ValueProvider</span> | <span class="hljs-type">ClassProvider</span> | <span class="hljs-type">ConstructorProvider</span> | <span class="hljs-type">ExistingProvider</span> | <span class="hljs-type">FactoryProvider</span> | <span class="hljs-type">any</span>[];<br></code></pre></td></tr></table></figure><p>ClassProvider</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">interface</span> <span class="hljs-symbol">ClassProvider</span> <span class="hljs-symbol">extends</span> <span class="hljs-symbol">ClassSansProvider</span> &#123;<br>  <span class="hljs-comment">// DI ä»¤ç‰Œ</span><br>  provide: any<br>  multi?: <span class="hljs-built_in">bool</span>ean<br><br>  <span class="hljs-comment">// ç»§æ‰¿è‡ª core/ClassSansProvider</span><br>  useClass: Type&lt;any&gt;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ³¨å…¥å™¨">æ³¨å…¥å™¨</h2><p>Angular ä¾èµ–æ³¨å…¥ç³»ç»Ÿä¸­å¯ä»¥åœ¨ç¼“å­˜ä¸­æ ¹æ®åå­—æŸ¥æ‰¾ä¾èµ–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®è¿‡çš„ã€Œæä¾›è€…ã€æ¥åˆ›å»ºä¾èµ–ã€‚ å¯åŠ¨è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªæ¨¡å—åˆ›å»ºä¸€ä¸ªæ³¨å…¥å™¨ï¼Œå¹¶è¢«ç»„ä»¶æ ‘ç»§æ‰¿ã€‚</p><ul><li><p>æ³¨å…¥å™¨ä¼šæä¾›ä¾èµ–çš„ä¸€ä¸ªå•ä¾‹ï¼Œå¹¶æŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡æ³¨å…¥åˆ°å¤šä¸ªç»„ä»¶ä¸­ã€‚</p></li><li><p>æ¨¡å—å’Œç»„ä»¶çº§åˆ«çš„æ³¨å…¥å™¨æ ‘å¯ä»¥ä¸ºå®ƒä»¬æ‹¥æœ‰çš„ç»„ä»¶åŠå…¶å­ç»„ä»¶æä¾›åŒä¸€ä¸ªä¾èµ–çš„ä¸åŒå®ä¾‹ã€‚</p></li><li><p>ä½ å¯ä»¥ä¸ºåŒä¸€ä¸ªä¾èµ–ä½¿ç”¨ä¸åŒçš„æä¾›è€…æ¥é…ç½®è¿™äº›æ³¨å…¥å™¨ï¼Œè¿™äº›æä¾›è€…å¯ä»¥ä¸ºåŒä¸€ä¸ªä¾èµ–æä¾›ä¸åŒçš„å®ç°ã€‚</p></li></ul><h2 id="æ€ä¹ˆæ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Ÿ">æ€ä¹ˆæ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Ÿ</h2><p>ä»¥æœ€å¸¸ç”¨çš„æœåŠ¡ä¸ºä¾‹ï¼Œåœ¨ç»„ä»¶ä¸­æ³¨å…¥ä¸€ä¸ªæœåŠ¡ï¼š</p><p>ä¸Šé¢ğŸ‘†ä»‹ç»äº†ï¼Œåœ¨ Angular ä¸­æœåŠ¡å°±æ˜¯ä¸€ä¸ªå¸¦æœ‰ @Injectable() è£…é¥°å™¨çš„ç±»ï¼Œå¯ä»¥æŠŠå®ƒä½œä¸ºä¾èµ–ï¼Œæ³¨å…¥åˆ°ç»„ä»¶ä¸­ã€‚åŒæ ·ï¼Œä¹Ÿè¦ä½¿ç”¨ @Injectable() è£…é¥°å™¨æ¥è¡¨æ˜ä¸€ä¸ªç»„ä»¶æˆ–å…¶å®ƒç±»ï¼ˆæ¯”å¦‚å¦ä¸€ä¸ªæœåŠ¡ã€ç®¡é“æˆ– NgModuleï¼‰æ‹¥æœ‰ä¸€ä¸ªä¾èµ–ï¼Œæˆ‘ä»¬å®é™…é¡¹ç›®ä¸­ç»å¤§éƒ¨åˆ†æ³¨å…¥çš„ä¾èµ–éƒ½æ˜¯æœåŠ¡ã€‚</p><ul><li><p><strong>æ³¨å…¥å™¨</strong>æ˜¯ä¸»è¦çš„æœºåˆ¶ã€‚Angular ä¼šåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¸ºä½ åˆ›å»ºå…¨åº”ç”¨çº§æ³¨å…¥å™¨ä»¥åŠæ‰€éœ€çš„å…¶å®ƒæ³¨å…¥å™¨ã€‚ä½ ä¸ç”¨è‡ªå·±åˆ›å»ºã€Œæ³¨å…¥å™¨ã€ã€‚</p></li><li><p>è¯¥æ³¨å…¥å™¨ä¼šåˆ›å»ºä¾èµ–ã€ç»´æŠ¤ä¸€ä¸ªå®¹å™¨æ¥ç®¡ç†è¿™äº›ä¾èµ–ï¼Œå¹¶å°½å¯èƒ½å¤ç”¨å®ƒä»¬ã€‚</p></li><li><p><strong>æä¾›è€…</strong>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å‘Šè¯‰æ³¨å…¥å™¨åº”è¯¥å¦‚ä½•è·å–æˆ–åˆ›å»ºä¾èµ–ã€‚</p></li></ul><p>ä½ çš„åº”ç”¨ä¸­æ‰€éœ€çš„ä»»ä½•ä¾èµ–ï¼Œéƒ½å¿…é¡»ä½¿ç”¨è¯¥åº”ç”¨çš„æ³¨å…¥å™¨æ¥æ³¨å†Œä¸€ä¸ª<strong>æä¾›è€…</strong>ï¼Œä»¥ä¾¿æ³¨å…¥å™¨å¯ä»¥ä½¿ç”¨è¿™ä¸ªæä¾›è€…æ¥åˆ›å»ºæ–°å®ä¾‹ã€‚å¯¹äºæœåŠ¡ï¼Œè¯¥æä¾›è€…é€šå¸¸å°±æ˜¯æœåŠ¡ç±»æœ¬èº«ã€‚</p><blockquote><p>ä¾èµ–ä¸ä¸€å®šæ˜¯æœåŠ¡ â€”â€” å®ƒè¿˜å¯èƒ½æ˜¯å‡½æ•°æˆ–å€¼ã€‚</p></blockquote><p>å½“ Angular åˆ›å»ºç»„ä»¶ç±»çš„æ–°å®ä¾‹æ—¶ï¼Œå®ƒä¼šé€šè¿‡æŸ¥çœ‹è¯¥ç»„ä»¶ç±»çš„æ„é€ å‡½æ•°ï¼Œæ¥å†³å®šè¯¥ç»„ä»¶ä¾èµ–å“ªäº›æœåŠ¡æˆ–å…¶å®ƒä¾èµ–é¡¹ã€‚å¦‚ä¸‹ï¼šHeroListComponent çš„æ„é€ å‡½æ•°ä¸­éœ€è¦ HeroService</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(<span class="hljs-keyword">private</span> service: HeroService)</span> <span class="hljs-comment">&#123; &#125;</span></span><br></code></pre></td></tr></table></figure><p>å½“ Angular å‘ç°æŸä¸ªç»„ä»¶ä¾èµ–æŸä¸ªæœåŠ¡æ—¶ï¼Œå®ƒä¼šé¦–å…ˆæ£€æŸ¥æ˜¯å¦è¯¥æ³¨å…¥å™¨ä¸­å·²ç»æœ‰äº†é‚£ä¸ªæœåŠ¡çš„ä»»ä½•ç°æœ‰å®ä¾‹ã€‚å¦‚æœæ‰€è¯·æ±‚çš„æœåŠ¡å°šä¸å­˜åœ¨å®ä¾‹ï¼Œæ³¨å…¥å™¨å°±ä¼šä½¿ç”¨ä»¥å‰æ³¨å†Œçš„æœåŠ¡æä¾›è€…æ¥åˆ¶ä½œä¸€ä¸ªï¼Œå¹¶æŠŠå®ƒåŠ å…¥æ³¨å…¥å™¨ä¸­ï¼Œç„¶åæŠŠè¯¥æœåŠ¡è¿”å›ç»™ Angularã€‚</p><p>å½“æ‰€æœ‰è¯·æ±‚çš„æœåŠ¡å·²è§£æå¹¶è¿”å›æ—¶ï¼ŒAngular å¯ä»¥ç”¨è¿™äº›æœåŠ¡å®ä¾‹ä¸ºå‚æ•°ï¼Œè°ƒç”¨è¯¥ç»„ä»¶çš„æ„é€ å‡½æ•°ã€‚</p><p>æ³¨å…¥è¿‡ç¨‹å¯ä»¥ç”¨ä¸‹æ–¹éå¸¸å½¢è±¡å’Œç»å…¸çš„ä¸€å¼ å›¾æ¥æ¦‚æ‹¬ï¼š</p><p><img src="/img/inject/injector-injects.png" alt=""></p><p>ä¸ªäººç†è§£ï¼šå›¾ä¸­çš„Injectorå°±æ˜¯æ³¨å…¥å™¨ï¼Œå®ƒç®¡ç†ç€å¾ˆå¤šçš„ä¾èµ–ï¼ŒAngularä¸­ã€Œä¾èµ–é¡¹ã€å’Œã€ŒDIä»¤ç‰Œã€ç›¸æ˜ å°„ï¼Œã€ŒDIä»¤ç‰Œã€ä½œä¸ºæ˜ å°„çš„keyï¼Œã€Œä¾èµ–é¡¹ã€ä½œä¸ºæ˜ å°„çš„valueï¼Œå½“å‘ç°æ„é€ å‡½æ•°ä¸­ä¾èµ–HeroServiceæ—¶ï¼Œæ³¨å…¥å™¨å°±ä¼šæŠŠHeroServiceå½“ä½œã€ŒDIä»¤ç‰Œã€å»æ³¨å…¥å™¨ä¸­å»æŸ¥æ‰¾ç›¸åº”çš„ã€Œä¾èµ–é¡¹ã€ï¼Œæ‰¾åˆ°ä¾èµ–é¡¹ä»¥åï¼Œç„¶åå†å»æŸ¥æ‰¾è¯¥ä¾èµ–æœ‰æ²¡æœ‰å·²ç»å®ä¾‹åŒ–å¥½çš„å¯¹è±¡ï¼Œå¦‚æœæœ‰å°±ç›´æ¥è¿”å›è¯¥å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ³¨å…¥å™¨å°±ä¼šæ ¹æ®è¯¥ä¾èµ–çš„ã€Œæä¾›è€…ã€å»åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥è¯´å¯¹è±¡æ˜¯ç”±æ³¨å…¥å™¨æ ¹æ®æä¾›è€…åˆ›å»ºçš„ã€‚ã€ŒæœåŠ¡ã€çš„ã€Œæä¾›è€…å®šä¹‰å¯¹è±¡ã€é»˜è®¤å°±æ˜¯ useClassï¼Œä¹Ÿå°±æ˜¯è¯´æ³¨å…¥å™¨ä¼šé€šè¿‡ new çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤å¤–ã€Œæä¾›è€…å®šä¹‰å¯¹è±¡ã€è¿˜å¯ä»¥æ˜¯ useValue ã€useExistingã€useFactoryç­‰ã€‚</p><h2 id="æä¾›æœåŠ¡çš„ä¸‰ç§æ–¹å¼">æä¾›æœåŠ¡çš„ä¸‰ç§æ–¹å¼</h2><p>å¯¹äºè¦ç”¨åˆ°çš„ä»»ä½•æœåŠ¡ï¼Œä½ å¿…é¡»è‡³å°‘æ³¨å†Œä¸€ä¸ªæä¾›è€…ã€‚æœåŠ¡å¯ä»¥åœ¨è‡ªå·±çš„å…ƒæ•°æ®ä¸­æŠŠè‡ªå·±æ³¨å†Œä¸ºæä¾›è€…ï¼Œè¿™æ ·å¯ä»¥è®©è‡ªå·±éšå¤„å¯ç”¨ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ºç‰¹å®šçš„æ¨¡å—æˆ–ç»„ä»¶æ³¨å†Œæä¾›è€…ã€‚è¦æ³¨å†Œæä¾›è€…ï¼Œå°±è¦åœ¨æœåŠ¡çš„ @Injectable() è£…é¥°å™¨ä¸­æä¾›å®ƒçš„å…ƒæ•°æ®ï¼Œæˆ–è€…åœ¨ @NgModule() æˆ– @Component() çš„å…ƒæ•°æ®ä¸­ã€‚</p><ol><li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAngular CLI çš„ ng generate service å‘½ä»¤ä¼šåœ¨ @Injectable() è£…é¥°å™¨ä¸­æä¾›å…ƒæ•°æ®æ¥æŠŠå®ƒæ³¨å†Œåˆ°æ ¹æ³¨å…¥å™¨ä¸­ã€‚æœ¬æ•™ç¨‹å°±ç”¨è¿™ç§æ–¹æ³•æ³¨å†Œäº† HeroService çš„æä¾›è€…ï¼š</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@Injectable</span>(&#123;<br> providedIn: <span class="hljs-string">&#x27;root&#x27;</span>,<br>&#125;)<br></code></pre></td></tr></table></figure><p>å½“ä½ åœ¨æ ¹ä¸€çº§æä¾›æœåŠ¡æ—¶ï¼ŒAngular ä¼šä¸º HeroService åˆ›å»ºä¸€ä¸ªå•ä¸€çš„å…±äº«å®ä¾‹ï¼Œå¹¶ä¸”æŠŠå®ƒæ³¨å…¥åˆ°ä»»ä½•æƒ³è¦å®ƒçš„ç±»ä¸­ã€‚è¿™ç§åœ¨ @Injectable å…ƒæ•°æ®ä¸­æ³¨å†Œæä¾›è€…çš„æ–¹å¼è¿˜è®© Angular èƒ½å¤Ÿé€šè¿‡ç§»é™¤é‚£äº›ä»æœªè¢«ç”¨è¿‡çš„æœåŠ¡æ¥ä¼˜åŒ–å¤§å°ã€‚</p><ol start="2"><li>å½“ä½ ä½¿ç”¨ç‰¹å®šçš„ NgModule æ³¨å†Œæä¾›è€…æ—¶ï¼Œè¯¥æœåŠ¡çš„åŒä¸€ä¸ªå®ä¾‹å°†ä¼šå¯¹è¯¥ NgModule ä¸­çš„æ‰€æœ‰ç»„ä»¶å¯ç”¨ã€‚è¦æƒ³åœ¨è¿™ä¸€å±‚æ³¨å†Œï¼Œè¯·ç”¨ @NgModule() è£…é¥°å™¨ä¸­çš„ providers å±æ€§ï¼š</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@NgModule</span>(&#123;<br>  providers: [<br>  BackendService,<br>  Logger<br> ],<br> â€¦<br>&#125;)<br></code></pre></td></tr></table></figure><ol start="3"><li>å½“ä½ åœ¨ç»„ä»¶çº§æ³¨å†Œæä¾›è€…æ—¶ï¼Œä½ ä¼šä¸ºè¯¥ç»„ä»¶çš„æ¯ä¸€ä¸ªæ–°å®ä¾‹æä¾›è¯¥æœåŠ¡çš„ä¸€ä¸ªæ–°å®ä¾‹ã€‚è¦åœ¨ç»„ä»¶çº§æ³¨å†Œï¼Œå°±è¦åœ¨ @Component() å…ƒæ•°æ®çš„ providers å±æ€§ä¸­æ³¨å†ŒæœåŠ¡æä¾›è€…ã€‚</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Component</span>(&#123;<br>  <span class="hljs-attribute">selector</span>:    <span class="hljs-string">&#x27;app-hero-list&#x27;</span>,<br>  <span class="hljs-attribute">templateUrl</span>: <span class="hljs-string">&#x27;./hero-list.component.html&#x27;</span>,<br>  <span class="hljs-attribute">providers</span>:  [ HeroService ]<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="å®šä¹‰æä¾›è€…">å®šä¹‰æä¾›è€…</h2><h3 id="ç±»æä¾›è€…">ç±»æä¾›è€…</h3><p>ç±»æä¾›è€…çš„è¯­æ³•å®é™…ä¸Šæ˜¯ä¸€ç§ç®€å†™å½¢å¼ï¼Œå®ƒä¼šæ‰©å±•æˆä¸€ä¸ªç”± Provider æ¥å£å®šä¹‰çš„æä¾›è€…é…ç½®å¯¹è±¡ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µå±•ç¤ºäº† providers ä¸­ç»™å‡ºçš„ç±»ä¼šå¦‚ä½•æ‰©å±•æˆå®Œæ•´çš„æä¾›è€…é…ç½®å¯¹è±¡ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">providers</span>:<span class="hljs-meta"> [Logger]</span><br></code></pre></td></tr></table></figure><p>Angular æŠŠè¿™ä¸ª providers å€¼æ‰©å±•ä¸ºä¸€ä¸ªå®Œæ•´çš„æä¾›è€…å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clojure">[&#123; provide: Logger, useClass: Logger &#125;]<br></code></pre></td></tr></table></figure><p>æ‰©å±•çš„æä¾›è€…é…ç½®æ˜¯ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡å­—é¢é‡ï¼š</p><ul><li><p>provide å±æ€§å­˜æœ‰ä»¤ç‰Œï¼Œå®ƒä½œä¸ºä¸€ä¸ª keyï¼Œåœ¨å®šä½ä¾èµ–å€¼å’Œé…ç½®æ³¨å…¥å™¨æ—¶ä½¿ç”¨ã€‚</p></li><li><p>ç¬¬äºŒä¸ªå±æ€§æ˜¯ä¸€ä¸ªæä¾›è€…å®šä¹‰å¯¹è±¡ï¼Œå®ƒå‘Šè¯‰æ³¨å…¥å™¨è¦å¦‚ä½•åˆ›å»ºä¾èµ–å€¼ã€‚æä¾›è€…å®šä¹‰å¯¹è±¡ä¸­çš„ key å¯ä»¥æ˜¯ useClass â€”â€” å°±åƒè¿™ä¸ªä¾‹å­ä¸­ä¸€æ ·ã€‚ä¹Ÿå¯ä»¥æ˜¯ useExistingã€useValue æˆ– useFactoryã€‚æ¯ä¸€ä¸ª key éƒ½ç”¨äºæä¾›ä¸€ç§ä¸åŒç±»å‹çš„ä¾èµ–ï¼Œæˆ‘ä»¬ç¨åä¼šè®¨è®ºã€‚</p></li></ul><h2 id="åˆ«åç±»æä¾›è€…">åˆ«åç±»æä¾›è€…</h2><p>è¦ä¸ºç±»æä¾›è€…è®¾ç½®åˆ«åï¼Œè¯·åœ¨ providers æ•°ç»„ä¸­ä½¿ç”¨ useExisting å±æ€§æŒ‡å®šåˆ«åå’Œç±»æä¾›è€…ã€‚</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå½“ç»„ä»¶è¯·æ±‚æ–°çš„æˆ–æ—§çš„è®°å½•å™¨æ—¶ï¼Œæ³¨å…¥å™¨éƒ½ä¼šæ³¨å…¥ä¸€ä¸ª NewLogger çš„å®ä¾‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒOldLogger å°±æˆäº† NewLogger çš„åˆ«åã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">[ NewLogger,<br>  <span class="hljs-regexp">//</span> Alias OldLogger w/ reference to NewLogger<br>  &#123; provide: OldLogger, useExisting: NewLogger&#125;]<br></code></pre></td></tr></table></figure><p>è¯·ç¡®ä¿ä½ æ²¡æœ‰ä½¿ç”¨ useClass æ¥æŠŠ OldLogger è®¾ä¸º NewLogger çš„åˆ«åï¼Œå› ä¸ºå¦‚æœè¿™æ ·åšå®ƒå°±ä¼šåˆ›å»ºä¸¤ä¸ªä¸åŒçš„ NewLogger å®ä¾‹ã€‚</p><h2 id="æ³¨å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡">æ³¨å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡</h2><p>å¸¸ç”¨çš„å¯¹è±¡å­—é¢é‡æ˜¯é…ç½®å¯¹è±¡ã€‚ä¸‹åˆ—é…ç½®å¯¹è±¡åŒ…æ‹¬åº”ç”¨çš„æ ‡é¢˜å’Œ Web API çš„ç«¯ç‚¹åœ°å€ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> HERO_DI_CONFIG: AppConfig = &#123;<br>  apiEndpoint: <span class="hljs-string">&#x27;api.heroes.com&#x27;</span>,<br>  title: <span class="hljs-string">&#x27;Dependency Injection&#x27;</span><br>&#125;;<br></code></pre></td></tr></table></figure><p>å®šä¹‰å’Œä½¿ç”¨ä¸€ä¸ª InjectionToken å¯¹è±¡æ¥ä¸ºéç±»çš„ä¾èµ–é€‰æ‹©ä¸€ä¸ªæä¾›è€…ä»¤ç‰Œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; InjectionToken &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> APP_CONFIG = <span class="hljs-keyword">new</span> InjectionToken&lt;AppConfig&gt;(<span class="hljs-string">&#x27;app.config&#x27;</span>);<br></code></pre></td></tr></table></figure><p>æ¥ç€ï¼Œç”¨ APP_CONFIG è¿™ä¸ª InjectionToken å¯¹è±¡åœ¨ç»„ä»¶ä¸­æ³¨å†Œä¾èµ–æä¾›è€…ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">providers:</span> [&#123; <span class="hljs-attr">provide:</span> <span class="hljs-string">APP_CONFIG</span>, <span class="hljs-attr">useValue:</span> <span class="hljs-string">HERO_DI_CONFIG</span> &#125;]<br></code></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå€ŸåŠ©å‚æ•°è£…é¥°å™¨ @Inject()ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªé…ç½®å¯¹è±¡æ³¨å…¥åˆ°æ„é€ å‡½æ•°ä¸­ã€‚</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(@Inject(APP_CONFIG)</span> <span class="hljs-title">config</span>:</span> AppConfig) <span class="hljs-comment">&#123;</span><br><span class="hljs-comment">  this.title = config.title;</span><br><span class="hljs-comment">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="æ¥å£å’Œä¾èµ–æ³¨å…¥">æ¥å£å’Œä¾èµ–æ³¨å…¥</h2><p>è™½ç„¶ TypeScript çš„ AppConfig æ¥å£å¯ä»¥åœ¨ç±»ä¸­æä¾›ç±»å‹æ”¯æŒï¼Œä½†å®ƒåœ¨ä¾èµ–æ³¨å…¥æ—¶å´æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚åœ¨ TypeScript ä¸­ï¼Œæ¥å£æ˜¯ä¸€é¡¹è®¾è®¡æœŸå·¥ä»¶ï¼Œå®ƒæ²¡æœ‰å¯ä¾› DI æ¡†æ¶ä½¿ç”¨çš„è¿è¡Œæ—¶è¡¨ç¤ºå½¢å¼æˆ–ä»¤ç‰Œã€‚</p><p>å½“è½¬è¯‘å™¨æŠŠ TypeScript è½¬æ¢æˆ JavaScript æ—¶ï¼Œæ¥å£å°±ä¼šæ¶ˆå¤±ï¼Œå› ä¸º JavaScript æ²¡æœ‰æ¥å£ã€‚</p><p>ç”±äº Angular åœ¨è¿è¡ŒæœŸæ²¡æœ‰æ¥å£ï¼Œæ‰€ä»¥è¯¥æ¥å£ä¸èƒ½ä½œä¸ºä»¤ç‰Œï¼Œä¹Ÿä¸èƒ½æ³¨å…¥å®ƒã€‚</p><h2 id="ä½¿ç”¨å·¥å‚æä¾›è€…">ä½¿ç”¨å·¥å‚æä¾›è€…</h2><p>è¦æƒ³æ ¹æ®è¿è¡Œå‰å°šä¸å¯ç”¨çš„ä¿¡æ¯åˆ›å»ºå¯å˜çš„ä¾èµ–å€¼ï¼Œå¯ä»¥ä½¿ç”¨å·¥å‚æä¾›è€…ã€‚</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œåªæœ‰æˆæƒç”¨æˆ·æ‰èƒ½çœ‹åˆ° HeroService ä¸­çš„ç§˜å¯†è‹±é›„ã€‚æˆæƒå¯èƒ½åœ¨å•ä¸ªåº”ç”¨ä¼šè¯æœŸé—´å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚æ”¹ç”¨å…¶ä»–ç”¨æˆ·ç™»å½•ã€‚</p><p>è¦æƒ³åœ¨ UserService å’Œ HeroService ä¸­ä¿å­˜æ•æ„Ÿä¿¡æ¯ï¼Œå°±è¦ç»™ HeroService çš„æ„é€ å‡½æ•°ä¼ ä¸€ä¸ªé€»è¾‘æ ‡å¿—æ¥æ§åˆ¶ç§˜å¯†è‹±é›„çš„æ˜¾ç¤ºã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">  <span class="hljs-keyword">private</span> logger: Logger,</span></span><br><span class="hljs-params"><span class="hljs-function">  <span class="hljs-keyword">private</span> isAuthorized: <span class="hljs-built_in">boolean</span></span>)</span> &#123; &#125;<br><br><span class="hljs-function"><span class="hljs-title">getHeroes</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-keyword">const</span> auth = <span class="hljs-built_in">this</span>.isAuthorized ? <span class="hljs-string">&#x27;authorized &#x27;</span> : <span class="hljs-string">&#x27;unauthorized&#x27;</span>;<br>  <span class="hljs-built_in">this</span>.logger.log(<span class="hljs-string">`Getting heroes for <span class="hljs-subst">$&#123;auth&#125;</span> user.`</span>);<br>  <span class="hljs-keyword">return</span> HEROES.filter(<span class="hljs-function"><span class="hljs-params">hero</span> =&gt;</span> <span class="hljs-built_in">this</span>.isAuthorized || !hero.isSecret);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¦å®ç° isAuthorized æ ‡å¿—ï¼Œå¯ä»¥ç”¨å·¥å‚æä¾›è€…æ¥ä¸º HeroService åˆ›å»ºä¸€ä¸ªæ–°çš„ logger å®ä¾‹ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">const heroServiceFactory =<span class="hljs-function"> (<span class="hljs-params">logger</span>: L<span class="hljs-params">ogger</span>, <span class="hljs-params">userService</span>: U<span class="hljs-params">serService</span>) =&gt;</span><br>  <span class="hljs-keyword">new</span> <span class="hljs-constructor">HeroService(<span class="hljs-params">logger</span>, <span class="hljs-params">userService</span>.<span class="hljs-params">user</span>.<span class="hljs-params">isAuthorized</span>)</span>;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å‚å‡½æ•°å¯ä»¥è®¿é—® UserServiceã€‚ä½ å¯ä»¥åŒæ—¶æŠŠ Logger å’Œ UserService æ³¨å…¥åˆ°å·¥å‚æä¾›è€…ä¸­ï¼Œè¿™æ ·æ³¨å…¥å™¨å°±å¯ä»¥æŠŠå®ƒä»¬ä¼ ç»™å·¥å‚å‡½æ•°äº†ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">export</span> <span class="hljs-string">const</span> <span class="hljs-string">heroServiceProvider</span> <span class="hljs-string">=</span><br>  &#123; <span class="hljs-attr">provide:</span> <span class="hljs-string">HeroService</span>,<br>    <span class="hljs-attr">useFactory:</span> <span class="hljs-string">heroServiceFactory</span>,<br>    <span class="hljs-attr">deps:</span> [<span class="hljs-string">Logger</span>, <span class="hljs-string">UserService</span>]<br>  &#125;<span class="hljs-string">;</span><br></code></pre></td></tr></table></figure><ul><li><p>useFactory å­—æ®µæŒ‡å®šè¯¥æä¾›è€…æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œå…¶å®ç°ä»£ç æ˜¯ heroServiceFactory</p></li><li><p>deps å±æ€§æ˜¯ä¸€ä¸ªæä¾›è€…ä»¤ç‰Œæ•°ç»„ã€‚Logger å’Œ UserService ç±»éƒ½æ˜¯è‡ªå·±ç±»æä¾›è€…çš„ä»¤ç‰Œã€‚è¯¥æ³¨å…¥å™¨è§£æäº†è¿™äº›ä»¤ç‰Œï¼Œå¹¶æŠŠç›¸åº”çš„æœåŠ¡æ³¨å…¥åˆ° heroServiceFactory å·¥å‚å‡½æ•°çš„å‚æ•°ä¸­ã€‚</p></li></ul><p>é€šè¿‡æŠŠå·¥å‚æä¾›è€…å¯¼å‡ºä¸ºå˜é‡ heroServiceProviderï¼Œå°±èƒ½è®©å·¥å‚æä¾›è€…å˜å¾—å¯å¤ç”¨ã€‚</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-keyword">import</span> &#123; Component &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; heroServiceProvider &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./hero.service.provider&#x27;</span>;<br><br>@Component(&#123;<br>  selector: <span class="hljs-string">&#x27;app-heroes&#x27;</span>,<br>  providers: [ heroServiceProvider ],<br>  template: `<span class="javascript"></span><br><span class="javascript">    &lt;h2&gt;Heroes&lt;/h2&gt;</span><br><span class="javascript">    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">app-hero-list</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-hero-list</span>&gt;</span></span></span><br><span class="javascript">  </span>`<br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroesComponent</span> &#123; &#125;</span><br></code></pre></td></tr></table></figure><h2 id="å¤šçº§æ³¨å…¥å™¨">å¤šçº§æ³¨å…¥å™¨</h2><p>Angular ä¸­æœ‰ä¸¤ä¸ªæ³¨å…¥å™¨å±‚æ¬¡ç»“æ„ï¼š</p><ul><li><p>ModuleInjector å±‚æ¬¡ç»“æ„ï¼šä½¿ç”¨ @NgModule() æˆ– @Injectable() æ³¨è§£åœ¨æ­¤å±‚æ¬¡ç»“æ„ä¸­é…ç½® ModuleInjectorã€‚</p></li><li><p>ElementInjector å±‚æ¬¡ç»“æ„ï¼šåœ¨æ¯ä¸ª DOM å…ƒç´ ä¸Šéšå¼åˆ›å»ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒElementInjector æ˜¯ç©ºçš„ï¼Œé™¤éä½ åœ¨ @Directive() æˆ– @Component() çš„ providers å±æ€§ä¸­é…ç½®å®ƒã€‚</p></li></ul><h3 id="ModuleInjector">ModuleInjector</h3><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€é…ç½® ModuleInjector ï¼š</p><ul><li><p>ä½¿ç”¨ @Injectable() çš„ providedIn å±æ€§å¼•ç”¨ @NgModule() æˆ– root</p></li><li><p>ä½¿ç”¨ @NgModule() çš„ providers æ•°ç»„</p></li></ul><h4 id="æ‘‡æ ‘ä¼˜åŒ–ä¸-Injectable">æ‘‡æ ‘ä¼˜åŒ–ä¸ @Injectable()</h4><blockquote><p>ä½¿ç”¨ @Injectable() çš„ providedIn å±æ€§ä¼˜äº @NgModule() çš„ providers æ•°ç»„ï¼Œå› ä¸ºä½¿ç”¨ @Injectable() çš„ providedIn æ—¶ï¼Œä¼˜åŒ–å·¥å…·å¯ä»¥è¿›è¡Œæ‘‡æ ‘ä¼˜åŒ–ï¼Œä»è€Œåˆ é™¤ä½ çš„åº”ç”¨ç¨‹åºä¸­æœªä½¿ç”¨çš„æœåŠ¡ï¼Œä»¥å‡å°æ†ç»‘åŒ…å°ºå¯¸ã€‚æ‘‡æ ‘ä¼˜åŒ–å¯¹äºåº“ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºä½¿ç”¨è¯¥åº“çš„åº”ç”¨ç¨‹åºä¸éœ€è¦æ³¨å…¥å®ƒã€‚</p></blockquote><p>ModuleInjector ç”± @NgModule.providers å’Œ NgModule.imports å±æ€§é…ç½®ã€‚ModuleInjector æ˜¯å¯ä»¥é€šè¿‡ NgModule.imports é€’å½’æ‰¾åˆ°çš„æ‰€æœ‰ providers æ•°ç»„çš„æ‰å¹³åŒ–ã€‚</p><p>å­ ModuleInjector æ˜¯åœ¨æƒ°æ€§åŠ è½½å…¶å®ƒ @NgModules æ—¶åˆ›å»ºçš„ã€‚</p><h4 id="å¹³å°æ³¨å…¥å™¨">å¹³å°æ³¨å…¥å™¨</h4><p>åœ¨ root ä¹‹ä¸Šè¿˜æœ‰ä¸¤ä¸ªæ³¨å…¥å™¨ï¼Œä¸€ä¸ªæ˜¯é¢å¤–çš„ ModuleInjectorï¼Œä¸€ä¸ªæ˜¯ NullInjector()ã€‚</p><p>å¦ä¸€ä¸ªé¢å¤–çš„ModuleInjectorè¿™é‡Œä¸ä½œèµ˜è¿°ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»å®˜ç½‘äº†è§£ã€‚</p><p>å±‚æ¬¡ç»“æ„ä¸­çš„ä¸‹ä¸€ä¸ªçˆ¶æ³¨å…¥å™¨æ˜¯ NullInjector()ï¼Œå®ƒæ˜¯æ ‘çš„é¡¶éƒ¨ã€‚å¦‚æœä½ åœ¨æ ‘ä¸­å‘ä¸Šèµ°äº†å¾ˆè¿œï¼Œä»¥è‡³äºè¦åœ¨ NullInjector() ä¸­å¯»æ‰¾æœåŠ¡ï¼Œé‚£ä¹ˆé™¤éä½¿ç”¨ @Optional()ï¼Œå¦åˆ™å°†æ”¶åˆ°é”™è¯¯æ¶ˆæ¯ï¼Œå› ä¸ºæœ€ç»ˆæ‰€æœ‰ä¸œè¥¿éƒ½å°†ä»¥ NullInjector() ç»“æŸå¹¶è¿”å›é”™è¯¯ï¼Œæˆ–è€…å¯¹äº @Optional()ï¼Œè¿”å› nullã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†å‰é¢å„æ®µè½æè¿°çš„ root ModuleInjector åŠå…¶çˆ¶æ³¨å…¥å™¨ä¹‹é—´çš„å…³ç³»ã€‚</p><p><img src="/img/inject/injectors.svg" alt=""></p><h3 id="ElementInjector">ElementInjector</h3><p>Angular ä¼šä¸ºæ¯ä¸ª DOM å…ƒç´ éšå¼åˆ›å»º ElementInjectorã€‚</p><p>å¯ä»¥ç”¨ @Component() è£…é¥°å™¨ä¸­çš„ providers æˆ– viewProviders å±æ€§æ¥é…ç½® ElementInjector ä»¥æä¾›æœåŠ¡ã€‚</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Component</span>(&#123;<br>  â€¦<br>  <span class="hljs-attribute">providers</span>: [&#123; <span class="hljs-attribute">provide</span>: ItemService, <span class="hljs-attribute">useValue</span>: &#123; <span class="hljs-attribute">name</span>: <span class="hljs-string">&#x27;lamp&#x27;</span> &#125; &#125;]<br>&#125;)<br>export class TestComponent<br></code></pre></td></tr></table></figure><h3 id="è§£æè§„åˆ™">è§£æè§„åˆ™</h3><p>å½“ä¸ºç»„ä»¶/æŒ‡ä»¤è§£æä»¤ç‰Œæ—¶ï¼ŒAngular åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µæ¥è§£æå®ƒï¼š</p><ol><li><p>é’ˆå¯¹ ElementInjector å±‚æ¬¡ç»“æ„ï¼ˆå…¶çˆ¶çº§ï¼‰ã€‚</p></li><li><p>é’ˆå¯¹ ModuleInjector å±‚æ¬¡ç»“æ„ï¼ˆå…¶çˆ¶çº§ï¼‰ã€‚</p></li></ol><p>å½“ç»„ä»¶å£°æ˜ä¾èµ–é¡¹æ—¶ï¼ŒAngular ä¼šå°è¯•ä½¿ç”¨å®ƒè‡ªå·±çš„ ElementInjector æ¥æ»¡è¶³è¯¥ä¾èµ–ã€‚ å¦‚æœç»„ä»¶çš„æ³¨å…¥å™¨ç¼ºå°‘æä¾›è€…ï¼Œå®ƒå°†æŠŠè¯·æ±‚ä¼ ç»™å…¶çˆ¶ç»„ä»¶çš„ ElementInjectorã€‚</p><p>è¿™äº›è¯·æ±‚å°†ç»§ç»­è½¬å‘ï¼Œç›´åˆ° Angular æ‰¾åˆ°å¯ä»¥å¤„ç†è¯¥è¯·æ±‚çš„æ³¨å…¥å™¨æˆ–ç”¨å®Œç¥–å…ˆ ElementInjectorã€‚</p><p>å¦‚æœ Angular åœ¨ä»»ä½• ElementInjector ä¸­éƒ½æ‰¾ä¸åˆ°æä¾›è€…ï¼Œå®ƒå°†è¿”å›åˆ°å‘èµ·è¯·æ±‚çš„å…ƒç´ ï¼Œå¹¶åœ¨ ModuleInjector å±‚æ¬¡ç»“æ„ä¸­è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœ Angular ä»ç„¶æ‰¾ä¸åˆ°æä¾›è€…ï¼Œå®ƒå°†å¼•å‘é”™è¯¯ã€‚</p><p>å¦‚æœä½ å·²åœ¨ä¸åŒçº§åˆ«æ³¨å†Œäº†ç›¸åŒ DI ä»¤ç‰Œçš„æä¾›è€…ï¼Œåˆ™ Angular ä¼šç”¨é‡åˆ°çš„ç¬¬ä¸€ä¸ªæ¥è§£æè¯¥ä¾èµ–ã€‚æ¯”å¦‚ï¼Œå¦‚æœæä¾›è€…å·²ç»åœ¨éœ€è¦æ­¤æœåŠ¡çš„ç»„ä»¶ä¸­æœ¬åœ°æ³¨å†Œäº†ï¼Œåˆ™ Angular ä¸ä¼šå†å¯»æ‰¾åŒä¸€æœåŠ¡çš„å…¶å®ƒæä¾›è€…ã€‚</p><h3 id="è§£æä¿®é¥°ç¬¦">è§£æä¿®é¥°ç¬¦</h3><p>å¯ä»¥ä½¿ç”¨ @Optional()ï¼Œ@Self()ï¼Œ@SkipSelf() å’Œ @Host() æ¥ä¿®é¥° Angular çš„è§£æè¡Œä¸ºã€‚ä» @angular/core å¯¼å…¥å®ƒä»¬ï¼Œå¹¶åœ¨æ³¨å…¥æœåŠ¡æ—¶åœ¨ç»„ä»¶ç±»æ„é€ å‡½æ•°ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><h4 id="ä¿®é¥°ç¬¦çš„ç±»å‹">ä¿®é¥°ç¬¦çš„ç±»å‹</h4><p>è§£æä¿®é¥°ç¬¦åˆ†ä¸ºä¸‰ç±»ï¼š</p><ul><li><p>å¦‚æœ Angular æ‰¾ä¸åˆ°ä½ è¦çš„ä¸œè¥¿è¯¥æ€ä¹ˆåŠï¼Œç”¨ @Optional()</p></li><li><p>ä»å“ªé‡Œå¼€å§‹å¯»æ‰¾ï¼Œç”¨ @SkipSelf()</p></li><li><p>åˆ°å“ªé‡Œåœæ­¢å¯»æ‰¾ï¼Œç”¨ @Host() å’Œ @Self()</p></li></ul><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAngular å§‹ç»ˆä»å½“å‰çš„ Injector å¼€å§‹ï¼Œå¹¶ä¸€ç›´å‘ä¸Šæœç´¢ã€‚ä¿®é¥°ç¬¦ä½¿ä½ å¯ä»¥æ›´æ”¹å¼€å§‹ï¼ˆé»˜è®¤æ˜¯è‡ªå·±ï¼‰æˆ–ç»“æŸä½ç½®ã€‚</p><p>å¦å¤–ï¼Œä½ å¯ä»¥ç»„åˆé™¤ @Host() å’Œ @Self() ä¹‹å¤–çš„æ‰€æœ‰ä¿®é¥°ç¬¦ï¼Œå½“ç„¶è¿˜æœ‰ @SkipSelf() å’Œ @Self()ã€‚</p><h4 id="Optional">@Optional()</h4><p>@Optional() å…è®¸ Angular å°†ä½ æ³¨å…¥çš„æœåŠ¡è§†ä¸ºå¯é€‰æœåŠ¡ã€‚è¿™æ ·ï¼Œå¦‚æœæ— æ³•åœ¨è¿è¡Œæ—¶è§£æå®ƒï¼ŒAngular åªä¼šå°†æœåŠ¡è§£æä¸º nullï¼Œè€Œä¸ä¼šæŠ›å‡ºé”™è¯¯ã€‚åœ¨ä¸‹é¢çš„èŒƒä¾‹ä¸­ï¼ŒæœåŠ¡ OptionalService æ²¡æœ‰åœ¨ @NgModule() æˆ–ç»„ä»¶ç±»ä¸­æä¾›ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰åœ¨åº”ç”¨ä¸­çš„ä»»ä½•åœ°æ–¹ã€‚</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">export</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">OptionalComponent</span> &#123;<br>  <span class="hljs-selector-tag">constructor</span>(<span class="hljs-variable">@Optional</span>() public optional?: OptionalService) &#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="Self">@Self()</h4><p>ä½¿ç”¨ @Self() è®© Angular ä»…æŸ¥çœ‹å½“å‰ç»„ä»¶æˆ–æŒ‡ä»¤çš„ ElementInjectorã€‚</p><p>@Self() çš„ä¸€ä¸ªå¥½ä¾‹å­æ˜¯è¦æ³¨å…¥æŸä¸ªæœåŠ¡ï¼Œä½†åªæœ‰å½“è¯¥æœåŠ¡åœ¨å½“å‰å®¿ä¸»å…ƒç´ ä¸Šå¯ç”¨æ—¶æ‰è¡Œã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µä¸‹å‡ºé”™ï¼Œè¯·å°† @Self() ä¸ @Optional() ç»“åˆä½¿ç”¨ã€‚</p><h4 id="SkipSelf">@SkipSelf()</h4><p>@SkipSelf() ä¸ @Self() ç›¸åã€‚ä½¿ç”¨ @SkipSelf()ï¼ŒAngular åœ¨çˆ¶ ElementInjector ä¸­è€Œä¸æ˜¯å½“å‰ ElementInjector ä¸­å¼€å§‹æœç´¢æœåŠ¡ã€‚</p><h4 id="Host">@Host()</h4><p>@Host() ä½¿ä½ å¯ä»¥åœ¨æœç´¢æä¾›è€…æ—¶å°†å½“å‰ç»„ä»¶æŒ‡å®šä¸ºæ³¨å…¥å™¨æ ‘çš„æœ€åä¸€ç«™ã€‚å³ä½¿æ ‘çš„æ›´ä¸Šçº§æœ‰ä¸€ä¸ªæœåŠ¡å®ä¾‹ï¼ŒAngular ä¹Ÿä¸ä¼šç»§ç»­å¯»æ‰¾ã€‚</p><h2 id="æœ€å">æœ€å</h2><p>ç”±äºangularçš„ä¾èµ–æ³¨å…¥çŸ¥è¯†ä½“ç³»å®åœ¨æ˜¯è¿‡äºåºå¤§ï¼Œæœ¬æ–‡ä¹Ÿä»…ä»…æ˜¯äº†è§£äº†ä¸‹å®ƒçš„åŸºç¡€ç”¨æ³•ï¼Œä½†æ˜¯æŒæ¡äº†è¿™äº›ä¹Ÿè¶³å¤Ÿæˆ‘ä»¬åœ¨å¹³å¸¸çš„å¼€å‘ä¸­ä½¿ç”¨äº†ï¼Œå½“ç„¶åªå­¦ä¹ ç”¨æ³•å’ŒçœŸæ­£å®è·µè¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ï¼Œæœ‰æœºä¼šè¿˜æ˜¯è¦å¤šå®è·µï¼Œé™¤æ­¤ä¹‹å¤–angularè¿˜æœ‰å¾ˆå¤šä¾èµ–æ³¨å…¥çš„é«˜çº§å®è·µï¼Œç­‰ä»¥åæœ‰æœºä¼šå­¦ä¹ å®è·µä»¥åä¼šå†æ¥è¡¥å……æ–‡ç« ã€‚æœ€åï¼Œangularå®˜ç½‘æ–‡æ¡£yydsï¼</p>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>angular</tag>
      
      <tag>ä¾èµ–æ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Reactå­¦ä¹ ç¬”è®°-åŸºç¡€è¯­æ³•</title>
    <link href="/posts/354b326f/"/>
    <url>/posts/354b326f/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºngå†™çš„æ¯ç‡¥æ— å‘³ï¼Œæ‰€ä»¥ä¾¿è¶ç€æ™šä¸Šæ— èŠæ—¶é—´å­¦ä¹ reactï¼Œå·æ­»ä½ ä»¬ï¼</p><p>æ­¤ç¬”è®°æ˜¯è®°å½•å­¦ä¹ reactçš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦å­¦åˆ°äº†åˆ›å»ºreactç»„ä»¶çš„æ–¹å¼ã€jsxçš„åŸºç¡€è¯­æ³•ä»¥åŠreactä¸­çš„thisæŒ‡å‘é—®é¢˜ã€‚</p><span id="more"></span><h3 id="åˆ›å»ºreactç»„ä»¶çš„æ–¹å¼">åˆ›å»ºreactç»„ä»¶çš„æ–¹å¼</h3><p>æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åˆ›å»ºç»„ä»¶ï¼šå‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><pre><code class="hljs scala"><span class="hljs-comment">// å‡½æ•°å¼</span><br>function <span class="hljs-type">Welcome</span>(props) &#123;<br>  <span class="hljs-keyword">return</span> &lt;h1&gt;<span class="hljs-type">Hello</span>, &#123;props.name&#125;&lt;/h1&gt;;<br>&#125;<br><br><span class="hljs-comment">// ç±»ç»„ä»¶</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcom</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;<br>  render() &#123;<br>    <span class="hljs-keyword">return</span> &lt;h1&gt;<span class="hljs-type">Hello</span>, &#123;<span class="hljs-keyword">this</span>.props.name&#125;&lt;/h1&gt;;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åœ¨ä¸è€ƒè™‘hooksä¹‹å‰ï¼Œç±»ç»„ä»¶å°±æ˜¯æ¯”å‡½æ•°ç»„ä»¶å¤šäº†stateï¼ˆçŠ¶æ€ï¼‰åŠŸèƒ½ï¼Œé€‚åˆå¤æ‚åŠŸèƒ½ï¼Œå½“ç„¶hookså°±ç­‰ä»¥åå­¦åˆ°å†è¯´å§ã€‚</p><h3 id="JSX">JSX</h3><p>åœ¨reactä¸­ä½¿ç”¨jsxæ¥æ„å»ºç•Œé¢ï¼Œæœ€ç»ˆç”±babelç¼–è¯‘å™¨è½¬ä¸ºæ™®é€šçš„jsä»£ç ã€‚</p><p>JSXå…¨ç§°æ˜¯JavaScript XML æ˜¯å¯¹JavaScriptçš„ä¸€ç§æ‰©å±•ã€‚ä¸‹é¢æ˜¯å‡ ç§è¯­æ³•ï¼š</p><ol><li><p>å®šä¹‰è™šæ‹Ÿdomæ—¶ï¼Œä¸è¦å†™å¼•å·ã€‚</p></li><li><p>æ ‡ç­¾ä¸­æ··å…¥jsè¡¨è¾¾å¼æ—¶è¦ç”¨{}ã€‚</p></li><li><p>æ ·å¼çš„ç±»åä¸è¦ç”¨classï¼Œè¦æ¢æˆclassNameã€‚</p></li><li><p>å†…è”æ ·å¼ï¼Œè¦ç”¨{{key: value}}çš„å½¢å¼å»å†™ã€‚</p></li><li><p>åªèƒ½æœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾ï¼Œä¸”æ ‡ç­¾å¿…é¡»é—­åˆã€‚</p></li><li><p>æ ‡ç­¾é¦–å­—æ¯ï¼šå¦‚æœæ˜¯å¤§å†™ï¼Œåˆ™babelä¼šä»¥ç»„ä»¶å»è§£æï¼Œå¦åˆ™ä¼šä»¥HTMLæ ‡ç­¾å»è§£æã€‚</p></li><li><p>ç‚¹å‡»äº‹ä»¶è¦å†™æˆ onClick={this.handleClick}çš„å½¢å¼ï¼ŒonClické©¼å³°å†™æ³•ã€‚</p></li></ol><h3 id="reactä¸­çš„thisæŒ‡å‘é—®é¢˜">reactä¸­çš„thisæŒ‡å‘é—®é¢˜</h3><p>å…ˆçœ‹ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">super</span>();<br>    <span class="hljs-built_in">this</span>.state = &#123;<span class="hljs-attr">frameWork</span>: [<span class="hljs-string">&#x27;Angular&#x27;</span>,<span class="hljs-string">&#x27;React&#x27;</span>,<span class="hljs-string">&#x27;Vue&#x27;</span>]&#125;;<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> &#123;<br>   <span class="hljs-keyword">return</span> (<br>       <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#123;</span>&#x27;<span class="hljs-attr">main</span>&#x27;&#125;&gt;</span></span><br><span class="xml">           <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;fontSize:</span>&#x27;<span class="hljs-attr">25px</span>&#x27;,<span class="hljs-attr">fontWeight:</span> &#x27;<span class="hljs-attr">bold</span>&#x27;&#125;&#125;&gt;</span>å‰ç«¯ä¸‰å¤§æ¡†æ¶<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="xml">           <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="xml">               &#123;this.state.frameWork.map((item,index) =&gt;</span><br><span class="xml">                   (<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index&#125;</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#123;</span>&#x27;<span class="hljs-attr">list</span>&#x27;&#125; <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;item&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>))&#125;</span><br><span class="xml">           <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="xml">       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>   )<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-title">handleClick</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-comment">// æ­¤å¤„æ‰“å°çš„thisä¼šæ˜¯undefinedï¼</span><br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ‰“å°çš„thisçš„undefinedçš„åŸå› å¦‚ä¸‹ï¼š</p><ol><li><p>åœ¨reactä¸­çš„ç‚¹å‡»äº‹ä»¶å¹¶ä¸æ˜¯ç”±ç»„ä»¶ç±»çš„å®ä¾‹ç›´æ¥è°ƒç”¨çš„ï¼Œè€Œæ˜¯ç”±windowè°ƒç”¨çš„ï¼Œä¸Šé¢çš„ä»£ç ä¸­çš„onClickæ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œå¹¶æ²¡æœ‰è¿è¡ŒhandleClickæ–¹æ³•ï¼Œè€Œæ˜¯ç”±windowè°ƒç”¨çš„ï¼Œç›¸å½“äº window.handleClick()</p></li><li><p>handleClickæ–¹æ³•æ˜¯ç±»ä¸­çš„å®ä¾‹æ–¹æ³•ï¼Œåœ¨ç±»çš„å®ä¾‹æ–¹æ³•å†…éƒ¨ä¼šé»˜è®¤å¯ç”¨â€™ use strict 'ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œæ–¹æ³•å†…éƒ¨çš„thiså°±å˜æˆäº†undefinedã€‚</p></li></ol><p>çŸ¥é“äº†åŸå› ä»¥åè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>åˆ©ç”¨bindæ–¹æ³•ï¼Œæ˜¾ç¤ºçš„æ”¹å˜thisæŒ‡å‘ã€‚åœ¨constructæ„é€ æ–¹æ³•ä¸­åŠ å…¥ï¼š</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// è¿™é‡Œçš„thisæŒ‡çš„æ˜¯ç»„ä»¶ç±»çš„å®ä¾‹å¯¹è±¡</span><br><span class="hljs-keyword">this</span>.handleClick = <span class="hljs-keyword">this</span>.handleClick.bind(<span class="hljs-keyword">this</span>);<br></code></pre></td></tr></table></figure><ol start="2"><li>åˆ©ç”¨ES6çš„ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°ä¸­æ˜¯æ²¡æœ‰thisçš„ï¼Œå†…éƒ¨çš„thisæ˜¯æŒ‡å®ƒä¸Šä¸€å±‚çš„ä½œç”¨åŸŸä¸­çš„thisã€‚</li></ol><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-regexp">//</span> æŠŠå‡½æ•°æ”¹é€ æˆç®­å¤´å‡½æ•°<br><span class="hljs-function"> <span class="hljs-title">handleClick</span> = <span class="hljs-params">()</span> =&gt;</span> &#123;<br>   <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>);<br> &#125;<br></code></pre></td></tr></table></figure><h3 id="æ€»ç»“">æ€»ç»“</h3><p>æ€»ç»“ä¸€ä¸‹ç”¨åˆ°çš„jsçš„çŸ¥è¯†ç‚¹ï¼š</p><ol><li><p>åŸå‹ä¸åŸå‹é“¾ï¼ˆç±»çš„ç»§æ‰¿ï¼‰</p></li><li><p>thisçš„æŒ‡å‘é—®é¢˜ï¼ˆç®­å¤´å‡½æ•°ä¸­çš„thisï¼‰</p></li><li><p>jsä¸­çš„ä¸¥æ ¼æ¨¡å¼</p></li><li><p>æ˜¾å¼æ”¹å˜thisçš„æŒ‡å‘çš„æ–¹æ³•ï¼ˆbindã€callã€applyçš„åŒºåˆ«ï¼‰</p></li></ol><p>ä»¥ä¸Šã€‚ç”±äºç¬”è€…æ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰é”™è¯¯æ•¬è¯·æŒ‡æ­£ï¼Œæ¬¢è¿è¯„è®ºåŒºç•™è¨€äº¤æµ~</p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>react</tag>
      
      <tag>reactåŸºç¡€è¯­æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Angularä¸­é˜²æŠ–çš„å®ç°</title>
    <link href="/posts/445dfd0e/"/>
    <url>/posts/445dfd0e/</url>
    
    <content type="html"><![CDATA[<p>åœ¨angularä¸­çš„é˜²æŠ–ä¸»è¦æ˜¯åˆ©ç”¨äº†rxjsä¸­çš„debounceæ“ä½œç¬¦ï¼Œéå¸¸ç®€æ´æ–¹ä¾¿ï¼</p><span id="more"></span><p>ä¸‹é¢ä¸»è¦æ˜¯ä»‹ç»å…¶ä¸‰ç§å†™æ³•ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼Œä¸å°è£…æŒ‡ä»¤çš„é˜²æŠ–å’Œå°è£…æˆæŒ‡ä»¤çš„é˜²æŠ–ï¼Œå…¶ä¸­å°è£…æˆæŒ‡ä»¤çš„é˜²æŠ–åˆæœ‰ä¸¤ç§å†™æ³•ï¼šåˆ©ç”¨@HostListenerè£…é¥°å™¨å’ŒRenderer2.listenæ–¹æ³•ã€‚</p><h3 id="ä¸å°è£…æŒ‡ä»¤çš„é˜²æŠ–">ä¸å°è£…æŒ‡ä»¤çš„é˜²æŠ–</h3><p>html</p><figure class="highlight handlebars"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;syn-margin-24&quot;</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml">    é»˜è®¤æ—¶é—´500msï¼Œåªæœ‰500msä»¥å†…æ²¡æœ‰äº‹ä»¶è§¦å‘æ‰ä¼šæ‰§è¡Œã€‚</span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;syn-margin-24 label-font&quot;</span>&gt;</span></span><br><span class="xml">    </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">total</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">nz-button</span> <span class="hljs-attr">nzType</span>=<span class="hljs-string">&quot;primary&quot;</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">&quot;add($event)&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">nz-icon</span> <span class="hljs-attr">nzType</span>=<span class="hljs-string">&quot;plus&quot;</span> <span class="hljs-attr">nzTheme</span>=<span class="hljs-string">&quot;outline&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span></span><br><span class="xml">    Add</span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>ts</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; debounceTime &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs/operators&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; Component,OnDestroy&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; Subscription, Subject &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs&#x27;</span>;<br><br><span class="hljs-meta">@Component</span>(&#123;<br>  <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;syn-debounce&#x27;</span>,<br>  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">&#x27;./debounce.component.html&#x27;</span>,<br>  <span class="hljs-attr">styleUrls</span>: [<span class="hljs-string">&#x27;./debounce.component.scss&#x27;</span>]<br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DebounceComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnDestroy</span></span>&#123;<br>  <span class="hljs-keyword">public</span> total: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">public</span> debounceTime: <span class="hljs-built_in">number</span> = <span class="hljs-number">500</span>;<br>  <span class="hljs-keyword">public</span> subscription = <span class="hljs-keyword">new</span> Subscription();<br>  <span class="hljs-keyword">public</span> subject$ = <span class="hljs-keyword">new</span> Subject();<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.subscription = <span class="hljs-built_in">this</span>.subject$.pipe(debounceTime(<span class="hljs-built_in">this</span>.debounceTime)).subscribe(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-built_in">this</span>.total+=<span class="hljs-number">1</span>);<br>   &#125;<br>  <span class="hljs-function"><span class="hljs-title">add</span>(<span class="hljs-params">$event: MouseEvent</span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.subject$.next($event);<br>  &#125;<br>  ngOnDestroy(): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-built_in">this</span>.subscription.unsubscribe();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå›¾</p><p><img src="/img/debounce/article-1.gif" alt=""></p><p>å®šä¹‰äº†ä¸€ä¸ªâ€œä¸»ä½“â€Subjectï¼Œå®ƒæ—¢æ˜¯è§‚å¯Ÿè€…ï¼Œä¹Ÿå¯ä»¥æ˜¯è®¢é˜…è€…ï¼Œæ¯æ¬¡ç‚¹å‡»äº‹ä»¶æ—¶è°ƒç”¨addæ–¹æ³•ï¼Œç„¶åä½¿ç”¨nextæ–¹æ³•å‘é€äº‹ä»¶ï¼Œç„¶åç”±äºsubject$åŒæ—¶subscribe(è®¢é˜…)äº†äº‹ä»¶ï¼Œæ‰€ä»¥ä¼šç»è¿‡rxjsçš„debounceè¿ç®—ç¬¦çš„å¤„ç†ï¼Œå…¶æ¥æ”¶ä¸€ä¸ªnumberç±»å‹çš„å€¼ï¼Œå•ä½msï¼Œå°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„é˜²æŠ–æ—¶é—´ã€‚</p><h3 id="æŒ‡ä»¤-HostListener">æŒ‡ä»¤-@HostListener</h3><p>åœ¨å®é™…çš„é¡¹ç›®ä¸­ç”¨åˆ°é˜²æŠ–çš„åœ°æ–¹è‚¯å®šä¸åªæœ‰ä¸€å¤„ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬åº”è¯¥å°è£…å‡ºä¸€ä¸ªé˜²æŠ–çš„æŒ‡ä»¤ä½¿ç”¨,åœ¨ngä¸­ç›‘å¬domäº‹ä»¶çš„æ–¹æ³•æˆ‘æ‰€äº†è§£çš„æœ‰ä¸¤ç§ï¼š@HostListenerç›‘å¬å’ŒRenderer2.listenæ–¹æ³•ã€‚æ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨äº†rxjsï¼Œåªä¸è¿‡å°±æ˜¯ç›‘å¬å…ƒç´ äº‹ä»¶çš„å†™æ³•ä¸åŒè€Œå·²ã€‚</p><p>ts</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; Directive, EventEmitter, HostListener, Input, OnDestroy, OnInit, Output &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; Subject, Subscription &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; debounceTime &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs/operators&#x27;</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description </span>åŸºäºrxjsçš„debounceTimeæ“ä½œç¬¦çš„é˜²æŠ–</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Directive</span>(&#123;<br>  <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;[synDebounceClick]&#x27;</span><br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DebounceClickDirective</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span>, <span class="hljs-title">OnDestroy</span> </span>&#123;<br>  <span class="hljs-meta">@Input</span>() debounceTime = <span class="hljs-number">500</span>;<br>  <span class="hljs-meta">@Output</span>(<span class="hljs-string">&#x27;synDebounceClick&#x27;</span>) debounceClick = <span class="hljs-keyword">new</span> EventEmitter();<br>  <span class="hljs-keyword">private</span> subject$ = <span class="hljs-keyword">new</span> Subject();<br>  <span class="hljs-keyword">private</span> subscription!: Subscription;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123; &#125;<br>  ngOnInit(): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-built_in">this</span>.subscription = <span class="hljs-built_in">this</span>.subject$.pipe(<br>      debounceTime(<span class="hljs-built_in">this</span>.debounceTime)<br>    ).subscribe(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-built_in">this</span>.debounceClick.emit(e))<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-title">ngOnDestroy</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.subscription.unsubscribe();<br>  &#125;<br>  <span class="hljs-meta">@HostListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,[<span class="hljs-string">&#x27;$event&#x27;</span>])<br>  <span class="hljs-function"><span class="hljs-title">clickEvent</span>(<span class="hljs-params">event: <span class="hljs-built_in">any</span></span>)</span> &#123;<br>    event.preventDefault();<br>    event.stopPropagation();<br>    <span class="hljs-built_in">this</span>.subject$.next(event);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¼å…¥ç›¸åº”çš„moduleåç„¶ååœ¨HTMLæ¨¡æ¿ä¸­ä½¿ç”¨å³å¯</p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs hsp">&lt;<span class="hljs-keyword">button</span> nz-<span class="hljs-keyword">button</span> nzType=<span class="hljs-string">&quot;primary&quot;</span> (synDebounceClick)=<span class="hljs-string">&quot;add()&quot;</span>&gt;Primary <span class="hljs-keyword">Button</span>&lt;/<span class="hljs-keyword">button</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="æŒ‡ä»¤-Renderer2-listen">æŒ‡ä»¤-Renderer2.listen</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; debounceTime &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs/operators&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; Subject, Subscription &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; Directive, ElementRef, Renderer2, OnInit, Input, Output, EventEmitter, OnDestroy &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><br><span class="hljs-meta">@Directive</span>(&#123;<br>  <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;[synDebounceRendererClick]&#x27;</span><br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DebounceRendererDirective</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span>, <span class="hljs-title">OnDestroy</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> subject$ = <span class="hljs-keyword">new</span> Subject();<br>  <span class="hljs-keyword">private</span> subscription!: Subscription;<br>  <span class="hljs-meta">@Input</span>() debounceTime: <span class="hljs-built_in">number</span> = <span class="hljs-number">500</span>;<br>  <span class="hljs-meta">@Output</span>(<span class="hljs-string">&#x27;synDebounceRendererClick&#x27;</span>) synDebounceRendererClick = <span class="hljs-keyword">new</span> EventEmitter();<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> _elementRef: ElementRef, <span class="hljs-keyword">private</span> _renderer2: Renderer2</span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.subscription = <span class="hljs-built_in">this</span>.subject$.pipe(debounceTime(<span class="hljs-built_in">this</span>.debounceTime))<br>    .subscribe(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-built_in">this</span>.synDebounceRendererClick.emit());<br>  &#125;<br><br>  ngOnInit(): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-built_in">this</span>._renderer2.listen(<span class="hljs-built_in">this</span>._elementRef.nativeElement,<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>      e.stopPropagation();<br>      e.preventDefault();<br>      <span class="hljs-built_in">this</span>.subject$.next(e);<br>    &#125;);<br>  &#125;<br>  ngOnDestroy(): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-built_in">this</span>.subscription.unsubscribe();<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>html</p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs hsp">&lt;<span class="hljs-keyword">button</span> nz-<span class="hljs-keyword">button</span> nzType=<span class="hljs-string">&quot;primary&quot;</span> (synDebounceRendererClick)=<span class="hljs-string">&quot;add()&quot;</span>&gt;Primary <span class="hljs-keyword">Button</span>&lt;/<span class="hljs-keyword">button</span>&gt;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯æˆ‘æ‰€çŸ¥é“çš„ä¸‰ç§å†™æ³•ï¼Œè‡³äº@HostListenerå’ŒRenderer2.listen()æœ‰ä»€ä¹ˆåŒºåˆ«æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šå¤šæ–¹æŸ¥é˜…ä¹Ÿæ²¡æœ‰å¾—åˆ°å…·ä½“çš„ç»“æœï¼Œæˆ‘æ‰€äº†è§£çš„æ˜¯@HostListeneråªèƒ½ç›‘å¬å®¿ä¸»å…ƒç´ ï¼Œè€ŒRenderer2.listen()å¯ä»¥ç›‘å¬ä»»æ„å…ƒç´ ï¼Œå¦‚æœè¿˜æœ‰å…¶å®ƒä¸åŒè¯·åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼</p><p>ç¬”è€…æ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰é”™è¯¯æ•¬è¯·æŒ‡æ­£ï¼Œä¸æ˜ç™½çš„åœ°æ–¹æ¬¢è¿è¯„è®ºåŒºç•™è¨€äº¤æµ~</p>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>angular</tag>
      
      <tag>é˜²æŠ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javascript Element.getBoundingClientRect API</title>
    <link href="/posts/b6e78c84/"/>
    <url>/posts/b6e78c84/</url>
    
    <content type="html"><![CDATA[<p>æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°ä¸€ä¸ªéœ€æ±‚æ˜¯éœ€è¦è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç”¨åˆ°äº† Element.getBoundingClientRect() æ–¹æ³•ã€‚</p><span id="more"></span><h3 id="Element-getBoundingClientRect-ä»‹ç»">Element.getBoundingClientRect() ä»‹ç»</h3><p>çœ‹ä¸€ä¸‹mdnçš„è§£é‡Šï¼š</p><blockquote><p>The Element.getBoundingClientRect() method returns a DOMRect object providing information about the size of an element and its position relative to the viewport.</p></blockquote><p>è¯´çš„æ˜¯è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªDOMRectå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­ä¼šåŒ…å«å½“å‰domå…ƒç´ çš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚ç›¸å¯¹äºè§†çª—çš„ä½ç½®ã€å®½é«˜ç­‰ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œè¿”å›çš„å…ƒç´ çš„å®½é«˜æ˜¯åŒ…å«å…ƒç´ çš„border-widthå’Œpaddingçš„ï¼Œå› ä¸ºç›’å­é»˜è®¤çš„æ˜¯æ ‡å‡†ç›’æ¨¡å‹ï¼ˆstandard boxï¼‰ï¼Œå¦‚æœè®¾ç½®äº†box-sizingï¼šborder-boxçš„è¯ï¼Œåˆ™è·å–åˆ°çš„å®½é«˜åªåŒ…å«å…ƒç´ å†…å®¹çš„å®½é«˜ã€‚</p><h4 id="DOMRectå¯¹è±¡">DOMRectå¯¹è±¡</h4><p>DOMRectå¯¹è±¡æè¿°äº†ä¸€ä¸ªçŸ©å½¢çš„å¤§å°å’Œä½ç½®ï¼Œå±æ€§éƒ½æ˜¯åªè¯»çš„ã€‚</p><p>é€šè¿‡mdnä¸Šçš„ä¸€ä¸ªdemoçœ‹ä¸€ä¸‹éƒ½æœ‰å“ªäº›å±æ€§å§:</p><p>html</p><figure class="highlight apache"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;div&gt;</span><span class="hljs-section">&lt;/div&gt;</span><br></code></pre></td></tr></table></figure><p>css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">div</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>  <span class="hljs-attribute">background</span>: purple;<br>&#125;<br></code></pre></td></tr></table></figure><p>javascript</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs qml"><span class="hljs-keyword">let</span> elem = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;div&#x27;</span>);<br><span class="hljs-keyword">let</span> <span class="hljs-built_in">rect</span> = elem.getBoundingClientRect();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">rect</span>) &#123;<br>  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">rect</span>[key] !== <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>    <span class="hljs-keyword">let</span> para = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;p&#x27;</span>);<br>    para.textContent  = <span class="hljs-string">`<span class="hljs-subst">$&#123; key &#125;</span> : <span class="hljs-subst">$&#123; rect[key] &#125;</span>`</span>;<br>    <span class="hljs-built_in">document</span>.body.appendChild(para);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><a href="https://codepen.io/yanglusen/pen/YzEVGgq">ä¼ é€é—¨</a></p><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/img/calculate/result.png" alt=""></p><p>è¿™é‡Œçš„widthå±æ€§æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„å…ƒç´ çš„å®½åº¦ã€‚</p><p>è¿™é‡Œè§£é‡Šä¸‹ï¼Œä»£ç é‡Œæ²¡æœ‰è®¾ç½®margin:8px,ä¸ºä»€ä¹ˆä¼šæœ‰8åƒç´ çš„marginå‘¢ï¼Œæ˜¯ä»¥ä¸ºcodePenè¿™ä¸ªåœ¨çº¿ç¼–è¾‘å™¨çš„bodyæœ‰é»˜è®¤çš„8pxçš„marginã€‚</p><h3 id="æœ€ç»ˆä»£ç ">æœ€ç»ˆä»£ç </h3><p>å…¶å®çŸ¥é“äº†å…³é”®çš„æ–¹æ³•ä»£ç ä¹Ÿå°±å‡ºæ¥äº†ï¼Œå¦‚ä¸‹è¿™æ˜¯tsçš„å†™æ³•ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è®¡ç®—å­—ç¬¦ä¸²çš„åƒç´ é•¿åº¦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>str è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>fontSize å­—ä½“å¤§å°</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns </span>è¾“å…¥å­—ç¬¦ä¸²çš„åƒç´ é•¿åº¦</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> getTextWidth(str: <span class="hljs-built_in">string</span>,<span class="hljs-attr">fontSize</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">number</span> &#123;<br> <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;<br> <span class="hljs-keyword">const</span> ele = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;div&#x27;</span>);<br> ele.style.position = <span class="hljs-string">&#x27;absolute&#x27;</span>;<br> ele.style.whiteSpace = <span class="hljs-string">&#x27;nowrap&#x27;</span>;<br> ele.style.fontSize = fontSize;<br> ele.style.fontFamily = <span class="hljs-string">&#x27;inherit&#x27;</span>;<br> ele.style.opacity = <span class="hljs-string">&#x27;0&#x27;</span>;<br> ele.innerText = str;<br> <span class="hljs-built_in">document</span>.body.append(ele);<br> result = ele.getBoundingClientRect().width;<br> <span class="hljs-built_in">document</span>.body.removeChild(ele);<br> <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²çš„å­—ä½“æ ·å¼å¦‚fontFamilyã€fontSizeç­‰éƒ½ä¼šå½±å“å…¶å®½åº¦çš„ï¼Œå› ä¸ºæˆ‘çš„éœ€æ±‚ä¸­å­—ä½“éƒ½æ˜¯Chromeé»˜è®¤çš„ï¼Œåªæœ‰å¤§å°ä¼šä¸åŒï¼Œæ‰€ä»¥å•ç‹¬æŠŠå­—ä½“å¤§å°ä½œä¸ºå½¢å‚æäº†å‡ºæ¥ã€‚</p><p>ç¬”è€…æ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰é”™è¯¯æ•¬è¯·æŒ‡æ­£ï¼Œä¸æ˜ç™½çš„åœ°æ–¹ä¹Ÿå¯è¯„è®ºåŒºç•™è¨€äº¤æµ~</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ng-zorroä¸­å®ç°ä¸¤ä¸ªtableåŒæ­¥æ»šåŠ¨æ•ˆæœ</title>
    <link href="/posts/1f09b34d/"/>
    <url>/posts/1f09b34d/</url>
    
    <content type="html"><![CDATA[<p>æŸå¤©ä¸‹åˆï¼ŒåŒäº‹å‘æˆ‘è¯·æ•™äº†ä¸€ä¸ªé—®é¢˜ï¼Œéœ€æ±‚æ˜¯æœ‰ä¸¤ä¸ªtableï¼Œå½“tableå­˜åœ¨æ»šåŠ¨æ¡æ—¶ï¼Œåœ¨æŸä¸€ä¸ªtableä¸Šæ»šåŠ¨ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªtableä¹Ÿè¦åŒæ­¥æ»šåŠ¨ï¼Œå·§çš„æ˜¯æˆ‘ä¹Ÿä¸ä¼šï¼Œä½†æ˜¯æˆ‘é—²ç€æ²¡äº‹ï¼Œå¸®ç€ç ”ç©¶äº†ä¸€ä¸‹ã€‚</p><span id="more"></span><p>æŠ€æœ¯æ ˆæ˜¯ï¼š angular8 + ng-zorroç»„ä»¶åº“</p><p>å…ˆçœ‹æ•ˆæœå’Œä»£ç ï¼š</p><p><img src="/img/ng-zorro-scroll/scroll.gif" alt=""></p><p>htmlä»£ç </p><figure class="highlight handlebars"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;syn-margin-left-24&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: flex;&quot;</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">nz-table</span> [<span class="hljs-attr">nzData</span>]=<span class="hljs-string">&quot;leftData&quot;</span>  [<span class="hljs-attr">nzScroll</span>]=<span class="hljs-string">&quot;&#123;y: &#x27;300px&#x27;&#125;&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 95%;&quot;</span> [<span class="hljs-attr">nzShowPagination</span>]=<span class="hljs-string">false</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">th</span> &gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">th</span> &gt;</span>Age<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">th</span> &gt;</span>Address<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">&quot;let data of leftData&quot;</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">data.name</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">data.age</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">data.address</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">nz-table</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">nz-table</span> [<span class="hljs-attr">nzData</span>]=<span class="hljs-string">&quot;rightData&quot;</span> [<span class="hljs-attr">nzScroll</span>]=<span class="hljs-string">&quot;&#123;y: &#x27;300px&#x27;&#125;&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 95%;&quot;</span> [<span class="hljs-attr">nzShowPagination</span>]=<span class="hljs-string">false</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Age<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Address<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">&quot;let data of rightData&quot;</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">data.name</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">data.age</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">data.address</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">nz-table</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>tsä»£ç </p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; StorageUtil &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./../shared/utils/storage-util&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; AfterViewInit, Component &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>  name?: <span class="hljs-built_in">string</span>;<br>  age?: <span class="hljs-built_in">number</span>;<br>  address?: <span class="hljs-built_in">string</span>;<br>&#125;<br><span class="hljs-meta">@Component</span>(&#123;<br>  <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;app-dashboard&#x27;</span>,<br>  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">&#x27;./dashboard.component.html&#x27;</span>,<br>  <span class="hljs-attr">styleUrls</span>: [<span class="hljs-string">&#x27;./dashboard.component.scss&#x27;</span>]<br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DashboardComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">AfterViewInit</span> </span>&#123;<br>  <span class="hljs-attr">leftData</span>: Person[] = <span class="hljs-built_in">this</span>.generateItems(<span class="hljs-string">&#x27;Edward King&#x27;</span>,<span class="hljs-number">32</span>,<span class="hljs-string">&#x27;London, Park Lane no.&#x27;</span>,<span class="hljs-number">25</span>);<br>  rightData: Person[] = <span class="hljs-built_in">this</span>.generateItems(<span class="hljs-string">&#x27;John Brown&#x27;</span>,<span class="hljs-number">42</span>,<span class="hljs-string">&#x27;New York No. 1 Lake Park&#x27;</span>,<span class="hljs-number">15</span>);<br>  ngAfterViewInit(): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&#x27;.ant-table-body&#x27;</span>);<br>    <span class="hljs-keyword">const</span> leftTable = element[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">const</span> rightTable = element[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">const</span> scale = (leftTable.scrollHeight - leftTable.clientHeight) / (rightTable.scrollHeight - rightTable.clientHeight);<br>    <span class="hljs-keyword">if</span> (leftTable?.scrollHeight &amp;&amp; leftTable.clientHeight &amp;&amp; leftTable?.scrollHeight &amp;&amp; leftTable.clientHeight) &#123;<br>      <span class="hljs-keyword">let</span> flag = <span class="hljs-literal">true</span>;<br>      leftTable.addEventListener(<span class="hljs-string">&#x27;mouseover&#x27;</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>        flag = <span class="hljs-literal">false</span>;<br>        leftTable.addEventListener(<span class="hljs-string">&#x27;scroll&#x27;</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>          <span class="hljs-keyword">if</span> (!flag) &#123;<br>            rightTable.scrollTop = leftTable.scrollTop / scale;<br>            rightTable.scrollLeft = leftTable.scrollLeft;<br>          &#125;<br>        &#125;)<br>      &#125;);<br>      rightTable.addEventListener(<span class="hljs-string">&#x27;mouseover&#x27;</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>        flag = <span class="hljs-literal">true</span>;<br>        rightTable.addEventListener(<span class="hljs-string">&#x27;scroll&#x27;</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>          <span class="hljs-keyword">if</span> (flag) &#123;<br>            leftTable.scrollTop = rightTable.scrollTop * scale;<br>            leftTable.scrollLeft = rightTable.scrollLeft;<br>          &#125;<br>        &#125;)<br>      &#125;);<br>    &#125;<br>  &#125;<br>  generateItems(name: <span class="hljs-built_in">string</span>,<span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>,<span class="hljs-attr">address</span>: <span class="hljs-built_in">string</span>,<span class="hljs-attr">size</span>: <span class="hljs-built_in">number</span>): Person[] &#123;<br>    <span class="hljs-keyword">const</span> res: Person[] = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>      res.push(<br>        &#123;<br>         <span class="hljs-attr">name</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;name&#125;</span><span class="hljs-subst">$&#123;i&#125;</span>`</span>,<br>         <span class="hljs-attr">age</span>: age + i,<br>         <span class="hljs-attr">address</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;address&#125;</span><span class="hljs-subst">$&#123;i&#125;</span>`</span><br>        &#125;<br>      )<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>çœ‹tsä»£ç çš„ç¬¬23è¡Œï¼ŒquerySelectAll()æ–¹æ³•å¯ä»¥è·å–æ‰€æœ‰classåä¸º&quot;ant-table-body&quot;çš„å…ƒç´ ï¼Œè¿™ä¸ªclassæ˜¯ng-zorroæ¡†æ¶å†…éƒ¨çš„ç±»ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨çš„å®¡æŸ¥å…ƒç´ çœ‹åˆ°ï¼š</p><p><img src="/img/ng-zorro-scroll/ng-zorro-scroll-1.png" alt=""></p><p>å¯èƒ½ä½ ä¼šæœ‰ç–‘é—®ä¸ºä»€ä¹ˆæˆ‘ä¼šæ‰¾è¿™ä¸ªclasså‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¦ç›‘å¬å­˜åœ¨æ»šåŠ¨æ¡çš„å®¹å™¨çš„scrolläº‹ä»¶ï¼Œæ‰€ä»¥è‡ªç„¶çš„è¦æ‰¾åˆ°è¿™ä¸ªå®¹å™¨ã€‚</p><p>ç°åœ¨å·²ç»æŠŠDomæ‰¾å‡ºæ¥äº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è®¾ç½®è®©ä¸¤ä¸ªtableçš„scrollTopå’ŒscrollLeftçš„å€¼ç›¸åŒå³å¯ã€‚</p><p>æœ‰ä¸¤ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p><ol><li><p>ä¸Šé¢çš„ä»£ç æˆ‘ä»¬è®¾ç½®äº†ä¸ªflagå€¼ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å·¦å³ä¸¤ä¸ªtableç›¸äº’èµ‹å€¼å¯¼è‡´æ»‘åŠ¨ç¼“æ…¢ï¼ŒåŒæ—¶ä¹Ÿå¯å‡å°‘æµè§ˆå™¨çš„æ€§èƒ½æ¶ˆè€—ï¼Œä½ å¯ä»¥å»æ‰flagå­—æ®µçœ‹çœ‹ï¼Œæ»‘åŠ¨ä¼šå˜å¡ã€‚</p></li><li><p>scaleå€¼æ˜¯ä¸ºäº†é˜²æ­¢ä¸¤ä¸ªtableçš„é«˜åº¦ä¸ä¸€æ ·è®¾ç½®çš„ï¼Œè¿™æ ·çš„è¯æ»‘åŠ¨çš„æ—¶å€™ä¸¤ä¸ªtableä¼šåŒæ—¶åˆ°è¾¾åº•éƒ¨æˆ–é¡¶éƒ¨ã€‚å¦‚æœä¸¤ä¸ªtableçš„é«˜åº¦ç›¸åŒé‚£scaleå°±æ²¡å•¥æ„ä¹‰äº†ï¼ŒåŠ ä¸åŠ éƒ½ä¸€æ ·ã€‚</p></li></ol><p>å®Œæ•´çš„æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li><p>æ‰¾åˆ°å…³é”®ç‚¹ï¼Œä½¿ä¸¤ä¸ªtableåŒæ­¥æ»šåŠ¨çš„å…³é”®å°±æ˜¯æ‰¾åˆ°å¹¶è®¾ç½®ä¸¤ä¸ªtableæ»šåŠ¨åŒºåŸŸçš„scrollTopã€scrollLeftçš„å€¼ç›¸åŒå³å¯ã€‚</p></li><li><p>å› ä¸ºç”¨çš„æ˜¯ng-zorroæ¡†æ¶ï¼Œæ‰€ä»¥é€šè¿‡å®¡æŸ¥å…ƒç´ å®šä½åˆ°æŸä¸ªdivã€‚</p></li><li><p>é€šè¿‡querySelectorAll()æ–¹æ³•è·å–ä¸¤ä¸ªtableçš„domå¯¹è±¡ï¼Œè·å–domå¯¹è±¡çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œåœ¨è¿™é‡Œåªèƒ½ç”¨querySelectorAll()æ–¹æ³•ã€‚</p></li><li><p>æ·»åŠ ç›‘å¬äº‹ä»¶ï¼Œå…ˆç›‘å¬mouseoverå†ç›‘å¬scrolläº‹ä»¶ã€‚</p></li><li><p>è®¾ç½®ä¸¤ä¸ªå®¹å™¨çš„scrollTopå’ŒscrollLeftçš„å€¼ç›¸åŒã€‚</p></li><li><p>è€ƒè™‘åæ€æœ‰æ²¡æœ‰é—®é¢˜ï¼Œæ¯”å¦‚ä¸¤ä¸ªtableé«˜åº¦ä¸ä¸€æ ·ç­‰ï¼Œç„¶åå†æƒ³æ€ä¹ˆå®Œå–„ã€‚</p></li></ol><p>è§£å†³è¯¥é—®é¢˜ç”¨åˆ°äº†å¾ˆå¤šåŸºç¡€çš„jsçš„çŸ¥è¯†ï¼Œæ¯”å¦‚åŸç”Ÿçš„é¼ æ ‡ç›‘å¬äº‹ä»¶ï¼Œmouseoverã€scrollç­‰ï¼Œè¿˜æœ‰scrollTopã€scrollHeighã€clientHeightç­‰å±æ€§çš„ç†è§£ï¼Œç”±æ­¤çœ‹å‡ºæœ‰ä¸€ä¸ªå¥½çš„åŸºç¡€è¿˜æ˜¯æŒºé‡è¦çš„ï¼</p><p>ä»¥ä¸Šã€‚ç¬”è€…æ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰é”™è¯¯æ•¬è¯·æŒ‡æ­£ï¼Œä¸æ˜ç™½çš„åœ°æ–¹ä¹Ÿå¯è¯„è®ºåŒºç•™è¨€äº¤æµ~</p>]]></content>
    
    
    <categories>
      
      <category>Angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>angular</tag>
      
      <tag>ng-zorro</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cssä¸­çš„repeatå‡½æ•°çš„ç”¨æ³•</title>
    <link href="/posts/ad542c12/"/>
    <url>/posts/ad542c12/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å­¦ä¹ cssçš„è¿‡ç¨‹ä¸­å‘ç°cssæ˜¯çœŸçš„éš¾ï¼Œå¯èƒ½æŸä¸€ä¸ªå±æ€§å°±å¾—å»æ·±ç©¶åŠå¤©ï¼Œä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œï¼Œé‡åˆ°ä¸ä¼šçš„ä¸”è§‰ç€æœ‰æ·±åº¦çš„é—®é¢˜å°½é‡å­¦ä¹ è®°å½•ä¸€ä¸‹å§ã€‚ä»Šå¤©æ¥çœ‹ä¸€ä¸‹cssä¸­çš„repeat()å‡½æ•°ã€‚</p><span id="more"></span><h3 id="å®šä¹‰">å®šä¹‰</h3><p>å…ˆçœ‹MDNçš„å®šä¹‰å§ï¼š</p><blockquote><p>CSS repeat() å‡½æ•°è¡¨ç¤ºè½¨é“åˆ—è¡¨çš„é‡å¤ç‰‡æ®µï¼Œå…è®¸ä»¥æ›´ç´§å‡‘çš„å½¢å¼å†™å…¥å¤§é‡æ˜¾ç¤ºé‡å¤æ¨¡å¼çš„åˆ—æˆ–è¡Œã€‚è¯¥å‡½æ•°å¯ä»¥ç”¨äº CSS Grid å±æ€§ä¸­ grid-template-columns å’Œ grid-template-rows.</p></blockquote><p>æˆ‘ä¸ªäººçš„ç†è§£: gridå¸ƒå±€ä¸­grid-template-columns å’Œ grid-template-rows ä¸¤ä¸ªå±æ€§åˆ†åˆ«æ˜¯å®šä¹‰ç½‘æ ¼çš„åˆ—æ•°å’Œè¡Œæ•°ï¼Œå¦‚æœå®šä¹‰å¤§é‡çš„é‡å¤å®½åº¦çš„è¡Œæˆ–åˆ—å°±å¯ä»¥ç”¨åˆ°è¿™ä¸ªå‡½æ•°ç®€åŒ–äº†ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><pre><code class="hljs css">grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-number">100px</span> <span class="hljs-number">100px</span> <span class="hljs-number">100px</span>;<br><br>// ç­‰åŒäº<br><br>grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">3</span>,<span class="hljs-number">100px</span>);<br></code></pre></td></tr></table></figure><h3 id="å–å€¼">å–å€¼</h3><p>å®šä¹‰å…¶å®ä¸éš¾ï¼Œé‡ç‚¹æ˜¯å®ƒçš„è¯­æ³•å’Œä½¿ç”¨ï¼Œå°¤å…¶æ˜¯å½“å®ƒä¸å…³é”®å­—ç»“åˆæ—¶ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚</p><p>repeatå‡½æ•°æ‰€æœ‰çš„å–å€¼å¦‚ä¸‹ï¼š</p><ol><li><p>æ­£æ•´æ•°é•¿åº¦ã€‚å¦‚ 100pxã€10vwç­‰</p></li><li><p>ç™¾åˆ†æ¯”ï¼Œç›¸å¯¹äºç½‘æ ¼å®¹å™¨å—çš„å¤§å°çš„ç™¾åˆ†æ¯”ã€‚å¦‚ 10%</p></li><li><p>å¸¦æœ‰ fr å•ä½çš„éè´Ÿå°ºå¯¸æŒ‡å®šè½¨é“çš„å¼¹æ€§ç³»æ•°ã€‚ å¦‚ 1fr</p></li><li><p>max-content å…³é”®å­—ï¼Œä»£è¡¨å æ®ç½‘æ ¼è½¨é“çš„ç½‘æ ¼é¡¹ç›®æ‰€åˆ†é…çš„æœ€å¤§å†…å®¹åŒºåŸŸçš„æœ€å¤§å€¼ã€‚</p></li><li><p>min-content å…³é”®å­—ï¼Œä»£è¡¨å æ®ç½‘æ ¼è½¨é“çš„ç½‘æ ¼é¡¹ç›®æ‰€åˆ†é…çš„æœ€å°å†…å®¹åŒºåŸŸçš„æœ€å°å€¼ã€‚</p></li><li><p>auto å…³é”®å­—ï¼Œä½œä¸ºæœ€å¤§å€¼ï¼Œç­‰åŒäº max-contentã€‚ä½œä¸ºæœ€å°å€¼ï¼Œå®ƒä»£è¡¨å æ®ç½‘æ ¼è½¨é“çš„ç½‘æ ¼é¡¹ç›®çš„æœ€å°å°ºå¯¸çš„æœ€å¤§å€¼ ï¼ˆå¦‚åŒmin-width/min-heightæ‰€æŒ‡å®šçš„)ï¼‰ã€‚</p></li><li><p>auto-fill å…³é”®å­—ï¼Œå†…å®¹è‡ªåŠ¨å¡«å……ï¼Œå…·ä½“è§£é‡Šå’Œä¸‹é¢çš„auto-fitå…³é”®å­—ä¸€èµ·è¯´ã€‚</p></li><li><p>auto-fit å…³é”®è¯ï¼Œå†…å®¹è‡ªåŠ¨é€‚åº”ã€‚</p></li></ol><h3 id="Demo">Demo</h3><ol><li>ç½‘æ ¼åˆ’åˆ†æˆ4åˆ—ï¼Œæ¯”ä¾‹ä¸º1:1:1:1</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">repeat</span>(<span class="hljs-number">4</span>,<span class="hljs-number">1</span>fr);<br></code></pre></td></tr></table></figure><p><img src="/img/repeat/repeat-demo-1.png" alt=""></p><p><a href="https://codepen.io/yanglusen/pen/PoJXdgj">Demoä¼ é€é—¨</a></p><ol start="2"><li>ä½¿ç”¨å…³é”®å­— min-content/max-content</li></ol><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><span class="hljs-built_in">repeat</span>(<span class="hljs-number">4</span>,<span class="hljs-built_in">min</span>-content);<br><br><span class="hljs-built_in">repeat</span>(<span class="hljs-number">4</span>,<span class="hljs-built_in">max</span>-content);<br></code></pre></td></tr></table></figure><p>1ï¼‰å…ˆçœ‹min-contentçš„ä»£ç å’Œç¤ºä¾‹å›¾ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;grid-containter&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">input</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>grid grid grid grid grid grid grid grid grid grid<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æµ‹è¯•<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>AAAAAAAAAAAAAAAAAA<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>AAAAAAAAAAAAAAAAAA<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>AAAAAAA BBBBBB<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>cc<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æµ‹è¯•<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>AAAAA<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>cc<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.grid-containter</span> &#123;<br>  <span class="hljs-attribute">padding</span>: <span class="hljs-number">2px</span>;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">50vw</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">220px</span>;<br>  <span class="hljs-attribute">border</span>: solid <span class="hljs-number">2px</span> <span class="hljs-number">#000</span>;<br>  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>  <span class="hljs-attribute">display</span>: grid;<br>  grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">4</span>,min-content);<br>  place-items: center;<br>  gap: <span class="hljs-number">5px</span>;<br>&#125;<br><span class="hljs-selector-class">.item</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>  <span class="hljs-attribute">border</span>: solid <span class="hljs-number">1px</span> transparent;<br>  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#F89427</span>;<br>  <span class="hljs-attribute">display</span>:flex;<br>  <span class="hljs-attribute">flex-direction</span>: column;<br>  <span class="hljs-attribute">justify-content</span>: center;<br>  <span class="hljs-attribute">align-items</span>: center;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹å›¾ï¼š</p><p><img src="/img/repeat/repeat-demo-2.png" alt=""></p><p><a href="https://codepen.io/yanglusen/pen/YzrdJOE">Demoä¼ é€é—¨</a></p><p><strong>å¯¹äºmin-contentè¿™ä¸ªå…³é”®è¯æˆ‘ä¸ªäººè§‰ç€æ˜¯ä¸å¤ªå¥½ç†è§£çš„ï¼Œå¦‚æœçœ‹å®Œä»£ç å’Œç¤ºä¾‹å›¾æœ‰ç–‘é—®çš„è¯å¯åˆ°æ–‡æœ«çœ‹å¯¹äºè¿™ä¸ªå…³é”®è¯çš„å•ç‹¬åˆ†æã€‚</strong></p><p>2ï¼‰å†çœ‹max-contentçš„ä»£ç å’Œç¤ºä¾‹å›¾</p><p>ä»£ç åªéœ€è¦æ”¹åŠ¨cssä¸­çš„ä¸€è¡Œï¼ŒæŠŠ min-content æ›¿æ¢æˆ max-content</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">grid</span>-template-<span class="hljs-built_in">columns</span>: repeat(<span class="hljs-number">4</span>,<span class="hljs-built_in">max</span>-<span class="hljs-built_in">content</span>);<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹å›¾</p><p><img src="/img/repeat/repeat-demo-2-2.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªdivçš„å®½åº¦å˜å¤§äº†ï¼Œæ˜¯å› ä¸ºæ­¤max-contentå–å¾—æ˜¯ç¬¬ä¸€ä¸ªpæ ‡ç­¾çš„å®½åº¦ä½œä¸ºdivçš„å®½åº¦ã€‚è€Œmin-contentå–å¾—æ˜¯æœ€åä¸€ä¸ªpæ ‡ç­¾çš„å®½åº¦ã€‚</p><p>3.å›ºå®šæŸåˆ—å®½åº¦ï¼Œå…¶å®ƒåˆ—æŒ‰æ¯”ä¾‹å¹³åˆ†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">grid</span>-template-columns: <span class="hljs-number">400</span>px repeat(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>fr);<br></code></pre></td></tr></table></figure><p><img src="/img/repeat/repeat-demo-3.png" alt=""></p><p><a href="https://codepen.io/yanglusen/pen/bGoOQLN">Demoä¼ é€é—¨</a></p><ol start="4"><li>ä½¿ç”¨minmaxå‡½æ•°ï¼Œè®¾ç½®åˆ—çš„æœ€å¤§ã€æœ€å°å€¼</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">4</span>, <span class="hljs-built_in">minmax</span>(<span class="hljs-number">100px</span>, <span class="hljs-number">1</span>fr));<br></code></pre></td></tr></table></figure><ol start="4"><li>ä½¿ç”¨å…³é”®å­— auto-fill/auto-fit</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-built_in">repeat</span>(auto-fill, <span class="hljs-built_in">minmax</span>(<span class="hljs-number">100px</span>, <span class="hljs-number">1</span>fr));<br><br>grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-built_in">repeat</span>(auto-fit, <span class="hljs-built_in">minmax</span>(<span class="hljs-number">100px</span>, <span class="hljs-number">1</span>fr));<br></code></pre></td></tr></table></figure><p>auto-fill</p><p><img src="/img/repeat/repeat-demo-4.png" alt=""></p><p>auto-fit</p><p><img src="/img/repeat/repeat-demo-5.png" alt=""></p><p>auto-fillå’Œauto-fitçš„åŒºåˆ«ä»å®ƒä»¬çš„åå­—ä¸Šå°±èƒ½çœ‹å‡ºæ¥ï¼Œä¸€ä¸ªæ˜¯è‡ªåŠ¨å¡«å……ï¼Œä¸€ä¸ªæ˜¯è‡ªåŠ¨é€‚åº”ï¼Œçœ‹ä¸€ä¸‹å›½å¤–å¤§ä½¬çš„è§£é‡Šï¼š</p><blockquote><p>auto-fill: å¡«å……å°½å¯èƒ½å¤šçš„åˆ—ã€‚å› æ­¤ï¼Œåªè¦æ–°åˆ—å¯ä»¥å®¹çº³ï¼Œå®ƒå°±ä¼šåˆ›å»ºéšå¼åˆ—ï¼Œå› ä¸ºå®ƒè¯•å›¾ç”¨å°½å¯èƒ½å¤šçš„åˆ—å¡«å……è¡Œã€‚æ–°æ·»åŠ çš„åˆ—å¯ä»¥ä¹Ÿå¯èƒ½æ˜¯ç©ºçš„ï¼Œä½†å®ƒä»¬ä»å°†å æ®è¡Œä¸­çš„æŒ‡å®šç©ºé—´ã€‚</p></blockquote><blockquote><p>auto-fit: é€‚åˆå½“å‰å¯ç”¨åˆ—çš„ç©ºé—´æ‰©å¤§ï¼Œä»¥ä¾¿ä»–ä»¬å ç”¨ä»»ä½•å¯ç”¨çš„ç©ºé—´ã€‚æµè§ˆå™¨åœ¨ç”¨é¢å¤–çš„åˆ—å¡«å……è¿™äº›é¢å¤–çš„ç©ºé—´ä¹‹å(å¦‚è‡ªåŠ¨å¡«å……) ï¼Œç„¶åæŠ˜å ç©ºçš„åˆ—ã€‚</p></blockquote><p><a href="https://codepen.io/yanglusen/pen/poWYPKq">Demoä¼ é€é—¨</a></p><p><img src="/img/repeat/repeat-demo-4-1.png" alt=""></p><p>å¦‚ä¸Šå›¾ï¼šå½“å®¹å™¨ç©ºé—´å……è¶³æ—¶ï¼Œauto-fillä¼šéšå¼çš„åˆ›å»ºæ›´å¤šçš„åˆ—ã€‚</p><h3 id="min-contentå…³é”®è¯">min-contentå…³é”®è¯</h3><p>ä¸ºä»€ä¹ˆæŠŠmin-contentå…³é”®è¯å•ç‹¬æ‹¿å‡ºæ¥è¯´ï¼Œæˆ‘æŸ¥äº†å¾ˆå¤šèµ„æ–™å¹¶æ²¡æœ‰å¾ˆå¥½çš„è§£é‡Šåˆ°ä½ï¼Œè€Œä¸”æˆ‘å‘ç°ç½‘ä¸Šè¿˜æœ‰ä¸€äº›å…³äºå®ƒçš„demoçš„ç†è§£æ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥ç‰¹æ­¤è§£é‡Šä¸€ä¸‹æˆ‘çš„ç†è§£ï¼š</p><p>çœ‹MDNçš„è§£é‡Šï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">The <span class="hljs-built_in">min</span>-content sizing keyword represents <span class="hljs-keyword">the</span> intrinsic minimum width <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> content. For <span class="hljs-keyword">text</span> content this means that <span class="hljs-keyword">the</span> content will take all soft-wrapping opportunities, becoming <span class="hljs-keyword">as</span> small <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> longest <span class="hljs-built_in">word</span>.<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯è‹±æ–‡ç‰ˆçš„ï¼Œä¸ºä»€ä¹ˆä¸çœ‹ä¸­æ–‡ç‰ˆçš„å‘¢ï¼Ÿå› ä¸ºä¸­æ–‡ç‰ˆçš„å†…å®¹æ²¡æœ‰åŠæ—¶æ›´æ–°ï¼Œè‡³å°‘æˆªæ­¢åˆ°æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™æ˜¯æ²¡æœ‰çš„ã€‚</p><p>å¤§æ¦‚çš„æ„æ€å°±æ˜¯min-content å…³é”®å­—è¡¨ç¤ºå†…å®¹å›ºæœ‰çš„æœ€å°å®½åº¦ï¼Œå¯¹äºæ–‡æœ¬è€Œè¨€ï¼Œæœ€å°å®½åº¦åˆ™æ˜¯æœ€é•¿å•è¯çš„å®½åº¦ã€‚æ‡‚äº†å—ï¼Ÿå¦‚æœä¸€ä¸ªå®¹å™¨å†…çš„å†…å®¹æ˜¯æ–‡æœ¬ï¼Œå¦‚æœç”¨äº†min-contentå…³é”®å­—ï¼Œé‚£ä¹ˆè¯¥å®¹å™¨çš„å®½åº¦åˆ™å–å®¹å™¨å†…å•è¯æœ€é•¿çš„æ–‡æœ¬çš„å®½åº¦ï¼Œè€Œä¸æ˜¯å•è¯æœ€çŸ­çš„é‚£ä¸ªï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘å°±æ˜¯ï¼Œå¯¹äºä¸­æ–‡è€Œè¨€ï¼Œä¸€ä¸ªå­—å°±æ˜¯ä¸€ä¸ªâ€œè¯â€ï¼Œè€Œå¯¹äºè‹±æ–‡å’Œæ•°å­—ï¼Œåˆ™æ˜¯æ ¹æ®ç©ºæ ¼æ¥åŒºåˆ†ä¸€ä¸ªè¯çš„ã€‚æ¯”å¦‚ &quot;HelloWorld&quot;è¿™æ˜¯ä¸€ä¸ªè¯ã€‚</p><p>å†çœ‹ä¸Šæ–‡ä¸­çš„ä¾‹å­å°±å¯ä»¥ç†è§£äº†å§ï¼Ÿ</p><p>ä»¥ä¸Šï¼Œè™½ç„¶æ–‡ç« æ ‡é¢˜æ˜¯repeatå‡½æ•°ï¼Œä½†æ˜¯å¹¶ä¸åªæ˜¯è®²äº†repeatå‡½æ•°ï¼Œç¬”è€…æ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰é”™è¯¯æ•¬è¯·æŒ‡æ­£ï¼Œä¸æ˜ç™½çš„åœ°æ–¹ä¹Ÿå¯è¯„è®ºåŒºç•™è¨€äº¤æµ~</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://css-tricks.com/auto-sizing-columns-css-grid-auto-fill-vs-auto-fit/">Auto-Sizing Columns in CSS Grid: <code>auto-fill</code> vs <code>auto-fit</code></a></p><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/min-content">MDN min-content</a></p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
      <tag>repeat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cssä¸­çš„linear-gradientå‡½æ•°çš„ç”¨æ³•</title>
    <link href="/posts/147173af/"/>
    <url>/posts/147173af/</url>
    
    <content type="html"><![CDATA[<p>æ—¥å¸¸å·¥ä½œä¸­ç”¨åˆ°äº†æ¸å˜è‰²ï¼Œä½†æ˜¯ä»…é™äºäº†è§£å®ç°ç®€å•çš„æ•ˆæœï¼Œæ‰€ä»¥è¶ç€æœ‰ç©ºå¥½å¥½å­¦ä¹ ä¸€ç•ªã€‚</p><span id="more"></span><h3 id="å®šä¹‰">å®šä¹‰</h3><p>MDNçš„è§£é‡Šï¼š</p><blockquote><p>CSS linear-gradient() å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªè¡¨ç¤ºä¸¤ç§æˆ–å¤šç§é¢œè‰²çº¿æ€§æ¸å˜çš„å›¾ç‰‡ã€‚å…¶ç»“æœå±äº&lt;gradient&gt;æ•°æ®ç±»å‹ï¼Œæ˜¯ä¸€ç§ç‰¹åˆ«çš„&lt;image&gt;æ•°æ®ç±»å‹ã€‚</p></blockquote><p>linear-gradientå…¶å®å°±æ˜¯ç›¸å½“äºbackground-imageï¼Œå®ƒåˆ›å»ºçš„æ˜¯èƒŒæ™¯å›¾ç‰‡è€ŒéèƒŒæ™¯è‰²ã€‚</p><h4 id="æ¸å˜è§’åº¦">æ¸å˜è§’åº¦</h4><p>æ¸å˜è§’åº¦æ˜¯ä¸æ¸å˜å®¹å™¨ä¸­å¿ƒç‚¹çš„å‚çº¿å½¢æˆçš„è§’åº¦ã€‚</p><h4 id="æ¸å˜çº¿">æ¸å˜çº¿</h4><blockquote><p>æ¸å˜çº¿ç”±åŒ…å«æ¸å˜å›¾å½¢çš„å®¹å™¨çš„ä¸­å¿ƒç‚¹å’Œä¸€ä¸ªè§’åº¦æ¥å®šä¹‰çš„ã€‚æ¸å˜çº¿ä¸Šçš„é¢œè‰²å€¼æ˜¯ç”±ä¸åŒçš„ç‚¹æ¥å®šä¹‰ï¼ŒåŒ…æ‹¬èµ·å§‹ç‚¹ï¼Œç»ˆç‚¹ï¼Œä»¥åŠä¸¤è€…ä¹‹é—´çš„å¯é€‰çš„ä¸­é—´ç‚¹ï¼ˆä¸­é—´ç‚¹å¯ä»¥æœ‰å¤šä¸ªï¼‰</p></blockquote><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="/img/linear-gradient/gradient-1.png" alt=""></p><p>ç‚¹Cä¸ºæ¸å˜å®¹å™¨çš„ä¸­å¿ƒç‚¹ï¼Œè§’åº¦Aæ˜¯ä¸è¿‡Cç‚¹çš„å‚çº¿å½¢æˆçš„è§’åº¦ï¼Œç©¿è¿‡ä¸­å¿ƒç‚¹å½¢æˆæ¸å˜è§’çš„è¿™æ¡çº¿å°±å«åšæ¸å˜è§’åº¦ã€‚</p><p><strong>æ¸å˜çº¿å’Œæ¸å˜è§’åº¦ç›¸è¾…ç›¸æˆï¼Œå®ƒä»¬ä¹‹é—´å¯ä»¥æ ¹æ®å½¼æ­¤äº’ç›¸è®¡ç®—å¾—åˆ°ã€‚</strong></p><h4 id="èµ·å§‹ç‚¹">èµ·å§‹ç‚¹</h4><blockquote><p>èµ·å§‹ç‚¹æ˜¯æ¸å˜çº¿ä¸Šä»£è¡¨èµ·å§‹é¢œè‰²å€¼çš„ç‚¹ã€‚èµ·å§‹ç‚¹ç”±æ¸å˜çº¿å’Œè¿‡å®¹å™¨é¡¶ç‚¹çš„å‚ç›´çº¿ä¹‹é—´çš„äº¤å‰ç‚¹æ¥å®šä¹‰ã€‚ï¼ˆå‚ç›´çº¿è·Ÿæ¸å˜çº¿åœ¨åŒä¸€è±¡é™å†…ï¼‰</p></blockquote><h4 id="ç»ˆç‚¹">ç»ˆç‚¹</h4><blockquote><p>ç»ˆç‚¹æ˜¯æ¸å˜çº¿ä¸Šä»£è¡¨æœ€ç»ˆé¢œè‰²å€¼çš„ç‚¹ã€‚ç»ˆç‚¹ä¹Ÿæ˜¯ç”±æ¸å˜çº¿å’Œä»æœ€è¿‘çš„é¡¶ç‚¹å‘å‡ºçš„å‚ç›´çº¿ä¹‹é—´çš„äº¤å‰ç‚¹å®šä¹‰çš„ï¼Œç„¶è€Œä»èµ·å§‹ç‚¹çš„å¯¹ç§°ç‚¹æ¥å®šä¹‰ç»ˆç‚¹æ˜¯æ›´å®¹æ˜“ç†è§£çš„ä¸€ç§æ–¹å¼ï¼Œå› ä¸ºç»ˆç‚¹æ˜¯èµ·ç‚¹å…³äºå®¹å™¨çš„ä¸­å¿ƒç‚¹çš„åå°„ç‚¹ã€‚</p></blockquote><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="/img/linear-gradient/gradient-2.png" alt=""></p><h3 id="è¯­æ³•">è¯­æ³•</h3><p>å…ˆçœ‹MDNï¼š</p><p><img src="/img/linear-gradient/gradient-3.png" alt=""></p><blockquote><p><strong>&lt;side-or-corner&gt;</strong><br>æè¿°æ¸å˜çº¿çš„èµ·å§‹ç‚¹ä½ç½®ã€‚å®ƒåŒ…å«toå’Œä¸¤ä¸ªå…³é”®è¯ï¼šç¬¬ä¸€ä¸ªæŒ‡å‡ºæ°´å¹³ä½ç½®left or rightï¼Œç¬¬äºŒä¸ªæŒ‡å‡ºå‚ç›´ä½ç½®top or bottomã€‚å…³é”®è¯çš„å…ˆåé¡ºåºæ— å½±å“ï¼Œä¸”éƒ½æ˜¯å¯é€‰çš„ã€‚<br>to top, to bottom, to left å’Œ to rightè¿™äº›å€¼ä¼šè¢«è½¬æ¢æˆè§’åº¦0åº¦ã€180åº¦ã€270åº¦å’Œ90åº¦ã€‚å…¶ä½™å€¼ä¼šè¢«è½¬æ¢ä¸ºä¸€ä¸ªä»¥å‘é¡¶éƒ¨ä¸­å¤®æ–¹å‘ä¸ºèµ·ç‚¹é¡ºæ—¶é’ˆæ—‹è½¬çš„è§’åº¦ã€‚æ¸å˜çº¿çš„ç»“æŸç‚¹ä¸å…¶èµ·ç‚¹ä¸­å¿ƒå¯¹ç§°ã€‚</p></blockquote><blockquote><p><strong>&lt;angle&gt;</strong><br>ç”¨è§’åº¦å€¼æŒ‡å®šæ¸å˜çš„æ–¹å‘ï¼ˆæˆ–è§’åº¦ï¼‰ã€‚è§’åº¦é¡ºæ—¶é’ˆå¢åŠ ã€‚</p></blockquote><blockquote><p><strong>&lt;linear-color-stop&gt;</strong><br>ç”±ä¸€ä¸ª<color>å€¼ç»„æˆï¼Œå¹¶ä¸”è·Ÿéšç€ä¸€ä¸ªå¯é€‰çš„ç»ˆç‚¹ä½ç½®ï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªç™¾åˆ†æ¯”å€¼æˆ–è€…æ˜¯æ²¿ç€æ¸å˜è½´çš„<length>ï¼‰</p></blockquote><blockquote><p><strong>&lt;color-hint&gt;</strong><br>é¢œè‰²ä¸­è½¬ç‚¹æ˜¯ä¸€ä¸ªæ’å€¼æç¤ºï¼Œå®ƒå®šä¹‰äº†åœ¨ç›¸é‚»é¢œè‰²ä¹‹é—´æ¸å˜å¦‚ä½•è¿›è¡Œã€‚é•¿åº¦å®šä¹‰äº†åœ¨ä¸¤ç§é¢œè‰²ä¹‹é—´çš„å“ªä¸ªç‚¹åœæ­¢æ¸å˜é¢œè‰²åº”è¯¥è¾¾åˆ°é¢œè‰²è¿‡æ¸¡çš„ä¸­ç‚¹ã€‚å¦‚æœçœç•¥ï¼Œé¢œè‰²è½¬æ¢çš„ä¸­ç‚¹æ˜¯ä¸¤ä¸ªé¢œè‰²åœæ­¢ä¹‹é—´çš„ä¸­ç‚¹ã€‚</p></blockquote><p>å¤ªå¤šï¼Ÿçœ‹ä¸æ‡‚ï¼Ÿæ²¡å…³ç³»ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Value_definition_syntax">æ•™ä½ è¯»æ‡‚MDNä¸Šçš„CSSè¯­æ³•</a></p><p>ç®€å•çš„æ€»ç»“ä¸€ä¸‹è¯­æ³•ï¼š</p><table><thead><tr><th>å€¼</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td>æ–¹å‘</td><td style="text-align:center">å®šä¹‰æ¸å˜è‰²çš„æ¸å˜æ–¹å‘ï¼ˆè§’åº¦ï¼‰,å…¶å€¼å¯é€‰ï¼Œé»˜è®¤å€¼æ˜¯180degï¼ˆto bottomï¼‰</td></tr><tr><td>æ¸å˜è‰²</td><td style="text-align:center">è‡³å°‘ç”±ä¸¤ä¸ªé¢œè‰²ç»„æˆï¼Œæ¯ä¸ªé¢œè‰²åé¢è·Ÿç€å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä¸¤ä¸ªé¢œè‰²ä¹‹é—´æ¸å˜è‰²çš„èµ·ç‚¹ï¼Œå¦‚ï¼šlinear-gradient(red 10%, blue 90%)ï¼Œè¡¨ç¤ºä»èµ·ç‚¹åˆ°10%çš„è·ç¦»ä¸ºçº¢è‰²ï¼Œ10%-90%çš„è·ç¦»ä¸ºä»çº¢è‰²æ¸å˜åˆ°è“è‰²ï¼Œ90%-ç»ˆç‚¹ä¸ºè“è‰²ã€‚æ¯ä¸¤ä¸ªé¢œè‰²ä¸­é—´è¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä»£è¡¨ä¸¤ä¸ªé¢œè‰²è½¬æ¢çš„ä¸­ç‚¹ï¼Œé»˜è®¤50%ï¼Œå¦‚10% - 90% è¿™æ®µæ¸å˜è·ç¦»çš„ä¸­ç‚¹å°±æ˜¯ä¸¤ä¸ªé¢œè‰²çš„è½¬æ¢çš„ä¸­ç‚¹</td></tr></tbody></table><h3 id="Demo">Demo</h3><p>åˆ—ä¸¾è¯¥å‡½æ•°æ‰€æœ‰å¯èƒ½æ€§çš„ç”¨æ³•ï¼š</p><ol><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸å†™,é»˜è®¤180degï¼Œä»ä¸Šåˆ°ä¸‹æ¸å˜</li></ol><figure class="highlight processing"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><pre><code class="hljs processing"><span class="hljs-built_in">background</span>: linear-gradient(<span class="hljs-built_in">red</span>, <span class="hljs-built_in">blue</span>);<br><br><span class="hljs-comment">// ç­‰åŒäºï¼š</span><br><br><span class="hljs-built_in">background</span>: linear-gradient(<span class="hljs-number">180</span>deg, <span class="hljs-built_in">red</span>, <span class="hljs-built_in">blue</span>);<br><br><span class="hljs-built_in">background</span>: linear-gradient(to bottom, <span class="hljs-built_in">red</span>, <span class="hljs-built_in">blue</span>);<br></code></pre></td></tr></table></figure><p><img src="/img/linear-gradient/gradient-4.png" alt=""></p><p><strong><a href="https://codepen.io/yanglusen/pen/yLzRpNR">Demoä¼ é€é—¨</a></strong></p><ol start="2"><li>å¸¦ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ45åº¦æ¸å˜</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">45deg</span>, red, blue);<br></code></pre></td></tr></table></figure><p><img src="/img/linear-gradient/gradient-5.png" alt=""></p><p><strong><a href="https://codepen.io/yanglusen/pen/MWEPrgP">Demoä¼ é€é—¨</a></strong></p><ol start="3"><li>æ¸å˜è‰²åè·Ÿå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºæ¸å˜çš„è·ç¦»</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(red <span class="hljs-number">20%</span>, blue <span class="hljs-number">80%</span>);<br></code></pre></td></tr></table></figure><p><img src="/img/linear-gradient/gradient-6.png" alt=""></p><p><strong><a href="https://codepen.io/yanglusen/pen/eYGPymx">Demoä¼ é€é—¨</a></strong></p><ol start="4"><li>æ¯ä¸¤ä¸ªæ¸å˜è‰²ä¹‹é—´è·Ÿå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä¸¤ä¸ªé¢œè‰²é—´æ¸å˜çš„ä¸­å¿ƒç‚¹</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">background</span>: linear-gradient(red <span class="hljs-number">20</span>%, <span class="hljs-number">60</span>%, blue <span class="hljs-number">80</span>%);<br></code></pre></td></tr></table></figure><p><img src="/img/linear-gradient/gradient-7.png" alt=""></p><p><strong><a href="https://codepen.io/yanglusen/pen/MWEPOLB">Demoä¼ é€é—¨</a></strong></p><p>å†è§£é‡Šä¸€ä¸‹ï¼Œæ¸å˜ä¸­å¿ƒï¼šä»ä¸Šåˆ°ä¸‹ï¼Œ20%åˆ°80%ä¸ºå®¹å™¨çš„æ¸å˜è·ç¦»ï¼Œç„¶åå¦‚æœä¸è®¾ç½®æ¸å˜ä¸­å¿ƒï¼Œé»˜è®¤50%ï¼Œä¹Ÿå°±æ˜¯è¯´20%åˆ°80%ä¹‹é—´è·ç¦»çš„ä¸­å¿ƒä¹Ÿå°±æ˜¯ä¸¤ä¸ªé¢œè‰²æ­£å¼æ”¹å˜çš„ä½ç½®ï¼Œå¦‚ä¸Šï¼Œæˆ‘è®¾ç½®äº†æ¸å˜ä¸­å¿ƒä¸º60%çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´çº¢è‰²æ¸å˜çš„è·ç¦»é•¿ï¼Œé¢œè‰²æ”¹å˜çš„æ…¢ã€‚</p><p>ä»¥ä¸Šã€‚ç¬”è€…æ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰é”™è¯¯æ•¬è¯·æŒ‡æ­£ï¼Œä¸æ˜ç™½çš„åœ°æ–¹ä¹Ÿå¯è¯„è®ºåŒºç•™è¨€äº¤æµ~</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://www.w3cplus.com/css3/do-you-really-understand-css-linear-gradients.html">ä½ çœŸçš„ç†è§£CSSçš„linear-gradientï¼Ÿ</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/gradient/linear-gradient()">MDNâ€”CSS linear-gradient()å‡½æ•°</a></p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
      <tag>linear-gradient</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
